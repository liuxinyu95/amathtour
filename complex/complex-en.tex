\ifx\wholebook\relax \else

\documentclass[b5paper]{article}
\usepackage[nomarginpar
  %, margin=.5in
]{geometry}

\addtolength{\oddsidemargin}{-0.05in}
\addtolength{\evensidemargin}{-0.05in}
\addtolength{\textwidth}{0.1in}

\usepackage[en]{../prelude}

\setcounter{page}{1}

\begin{document}

\title{Complex numbers}

\author{Xinyu LIU
\thanks{{\bfseries Xinyu LIU} \newline
  Email: liuxinyu99@hotmail.com \newline}
  }

\maketitle
\fi

\markboth{Complex numbers}{A Tour of Numbers}

\ifx\wholebook\relax
\chapter{Complex numbers}
\fi

\epigraph{On earth there is nothing great but man; and in man there is nothing great but mind.}{William Hamilton}

At the night of February 13, 1535, Tartaglia was pacing back and forth in his house in Venice, pondering over the upcoming challenge. During the Renaissance period in Italy, scholars often engaged in public challenges that were knightly in nature. These challenges did not involve swords or guns but were mathematical contests where both parties would present a set of mathematical problems to each other and solve them within a specified time. The one who solved more correctly would win. The victor would earn honor or a certain amount of money. These 1:1 \enquote{duels} took place between well-known scholars, usually in public places like cathedrals, attracting crowds of onlookers. Sometimes even mayors or nobles would come to watch, making the outcome highly significant, affecting the social status, academic reputation, and even career development of both parties.

We mentioned in \cref{sec:fibonacci-Liber-Abaci}, that Fibonacci was invited to the court of Frederick II, the Holy Roman Emperor, in Sicily in 1225. The court scholars looked down on Fibonacci as a mathematician of merchant origin and challenged him with a series of problems. Fibonacci successfully solved all the problems, earning himself great honor. Among these problems was a cubic equation\footnote{At that time, there were no algebraic symbols; the problem was described in words, such as: Find a number such that its cube plus twice its square plus ten times itself equals twenty.}:\[x^3 + 2x^2 + 10x = 20\]

Fibonacci gave a numerical answer in Babylonian sexagesimal:

\[
1^022^{I}7^{II}42^{III}33^{IV}4^{V}40^{VI} = 1 + \frac{22}{60} + \frac{7}{60^2} + \frac{42}{60^3} + \dotsb
\]

It is approximately $1.3688081075$ in decimal, accurate to 9 decimal places. Such public challenge also created a peculiar phenomenon: scholars treated their research results as highly confidential. This was because it could give them an advantage in the challenge. Once leaked, the opponent could solve the problem they proposed. Scholars would not publish their results during their lifetime but would pass them on to trusted disciples before their death. This is hard to understand in today's world of \enquote{publish or perish} \cite{HanXueTao2012}.

The challenge Tartaglia faced was about cubic equations, and his opponent was Antonio Maria Fior. Although the Babylonians had already been able to solve quadratic equations around 2000 BC, there was no breakthrough in solving general cubic equations for the next 3500 years. People were not satisfied with the numerical solution (as what Fibonacci had done) but wanted a formula. The term \enquote{general} refers to cubic equations of the form $ax^3 + bx^2 + cx + d = 0$. Special cubic equations, such as $x^3 = a$, are trivial, yielding a root $x = \sqrt[3]{a}$\footnote{The other two roots are complex: $\dfrac{-1 \pm i\sqrt{3}}{2}\sqrt[3]{a}$}. Tartaglia independently discovered the solution to a special cubic equation of the form $x^3 + ax^2 = b$.

But Fior kept boasting about his ability to solve cubic equations, claiming to be the best mathematician in Italy, and challenged Tartaglia. Both parties agreed to present 30 problems each and determine who was superior in a cathedral. Tartaglia was anxious. It seemed that the type of cubic equations Fior could solve was not $x^3 + ax^2 = b$, but another form: $x^3 + ax = b$, such as: \enquote{Find a number such that when its cube is added to itself equals 6} (equivalent to $x^3 + x = 6$). Tartaglia did not know how to solve this type of equation\cite{MacTour-Tartaglia-Cardan}. He couldn't sleep at that night, many thoughts and scenes from his childhood kept flashing in his mind.

\index{Tartaglia}
Tartaglia's real name was Niccolò Fontana, born around 1500 in Brescia, Italy. His father, Michele Fontana, was a postman who delivered mail in the mountainous areas around Brescia. The family had three children, two boys and a girl, and lived in poverty. When Niccolò was six years old, his father was murdered while delivering mail. Losing the breadwinner, the family fell into extreme poverty. Worse disasters were yet to come. In 1512, the French army attacked Brescia\footnote{The Italian Wars broke out from 1494 to 1559. King Louis XII of France attempted to conquer Italy, which was opposed by European powers such as the Spanish Habsburgs, leading to war.}. To retaliate against the determined resistance of the people of Brescia, the French army killed 46,000 people after capturing the city. His mother tried to take Niccolò and his sister to hide in a church for safety, but Niccolò was still injured in the face by a French soldier during the chaos, leaving two shocking scars on his mouth. His mother found him barely alive but had no money to hire a doctor, so she had to literaly lick his wounds every day. Miraculously, Niccolò survived but developed a lifelong stutter due to the injury. He earned the nickname \enquote{Tartaglia}, which means \enquote{stutterer} in Italian. As he grew older, he kept a beard to cover the scars on his face (see \cref{fig:tartaglia}).

Despite the many misfortunes, Tartaglia showed a talent for learning. He was mostly self-taught, using tombstones as slates when he couldn't afford paper. Later, his mother finally found a kind person to sponsor him to study in Padua. After completing his studies, Tartaglia became a primary school mathematics teacher in Verona. In 1534, he moved to Venice and taught mathematics at the Church of San Zanipolo. He gained more and more fame by winning a series of public challenges\cite{MacTour-Tartaglia}. At the present, Tartaglia had to concentrate and quickly solve cubic equations without quadratic terms. That night, a miracle happened, and he finally found the solution. When both parties open the sealed problems, the outcome was already decided: Tartaglia's 30 problems included two types of special cubic equations, both without linear terms and without quadratic terms; while Fior's only had one type without quadratic terms. Tartaglia solved all the problems in just two hours, but Fior was stuck on the equations without linear terms.

\index{Cardano}
As the winner, Tartaglia refused the prize money and only accepted the honor. The news reaching Milan in Italy, where it caught the attention of a man named Girolamo Cardano\footnote{In Latin, Cardano, also translated as Cardan in English.} (1501–1576). He was an illegitimate child (see \cref{fig:cardano}). His father, Fazio Cardano, was a lawyer and mathematician who taught at the University of Pavia and the University of Milan. It is said that Leonardo da Vinci once consulted Fazio on geometric problems.

Due to his illegitimate status, Cardano lived in poverty and was in bad health. After some struggle, Fazio agreed to send him to study medicine at the University of Pavia. During the Italian Wars, the school was forced to close, and Cardano had to go to the University of Padua to complete his studies. His father also died soon after. In the chaotic times, Cardano quickly spent all of his father's meager inheritance and developed a gambling addiction. He had a mathematical mind and gradually realized the principles of probability (which were not formally established until a century later by Pascal and Fermat), thus often defeating other gamblers. Cardano was aggressive, and when he suspected others of cheating, he would not hesitate to draw a dagger and fight. This made him notorious, and in 1525, after obtaining his medical doctorate, the city of Milan refused to grant him a medical license. He had to practice medicine secretly while continuing gambling. Soon he lost all of his wife's dowry and family fortune, and the whole family had to move into a poorhouse in Milan. Cardano later obtained a mathematics teaching position from his father's former university. His medical talents gradually showed themselves, curing many famous people's diseases, and even the governor of Milan and local doctors privately sought his help. Finally, in 1539, he had a turning point in life: due to pressure from those famous patients cured by Cardano, the city of Milan granted him a medical license. Regarding Cardano's illegitimate status, the Milan Medical Association considered that Fazio eventually married his mother, thus making his birth \enquote{legitimate}. Cardano was elated; in that year he published two mathematical books. Besides that, he did one more thing: for the past four years, he had been trying to find the solution to cubic equations on his own but failed. He inquired about Tartaglia through a bookseller who traveled between Milan and Venice and promised to include Tartaglia's solution in his upcoming book if Tartaglia shared it with him. But what Cardano got was a cold refusal. Tartaglia said that he would publish the solution to cubic equations himself in the future. Cardano was not giving up; he asked again through someone if Tartaglia could tell him the specific solution and promised confidentiality but was still rejected.

So the old gambler Cardano wrote a letter to Tartaglia, with very high rhetorical skills. On the one hand, he blamed Tartaglia for being ungrateful and hinted at a public challenge; on the other hand, he said that he had discussed Tartaglia's talents with his patients—the Marquis Alfonso de Avalos Vasto, the governor of Milan... Tartaglia took the bait. He was of humble origin and yearned for higher social status. He replied to Cardano, asking if he could introduce him to the governor and personally demonstrate his talents to him. Cardano then invited Tartaglia to visit his residence in Milan and promised to arrange a meeting with Marquis de Avalos. In March 1539, Tartaglia walked through Cardano's door. The host was hospitable and accommodating. But there was a small regret: the Marquis had a sudden matter and couldn't attend the meeting. Under Cardano's skillful persuasion, Tartaglia finally agreed to reveal the solution to cubic equations. But he required Cardano to swear an oath: first, never to reveal it to anyone until death; second, only to record it in code to prevent others from deciphering it. Then he recited a poem\footnote{We omit the middle part. Tartaglia's poem contains three special types of cubic equations and points out that the third type can be transformed into the second type.}:

\begin{verse}
When the cube and things together \\
Are equal to some discreet number, \\
Find two other numbers differing in this one. \\
Then you will keep this as a habit \\
That their product should always be equal \\
Exactly to the cube of a third of the things. \\
The remainder then as a general rule \\
Of their cube roots subtracted \\
Will be equal to your principal thing \\
... \\
These things I found, and not with sluggish steps,
In the year one thousand five hundred, four and thirty.
With foundations strong and sturdy
In the city girdled by the sea.
\end{verse}

Nobody in the room when Tartaglia reciting the poem except Cardano and, an eighteen-year-old servant named Lodovico Ferrari. Tartaglia couldn't remember how he walked out of Cardano's house. He held a letter of introduction from Cardano to the Marquis. He didn't stay in Milan to meet the Marquis but hurried back to Venice. He regretted it. That year, Cardano published two books, which Tartaglia checked one by one, about calculating gambling probabilities and mathematical lectures. Cardano seemed to have kept his promise and did not reveal a word about the solution to cubic equations.

Cardano and Ferrari thoroughly studied Tartaglia's solution and continued to solve all forms of cubic equations. Essentially, they found a general solution to cubic equations. Ferrari, under Cardano's guidance, also solved quartic equations. But after all, they had sworn an oath, and they couldn't publish these results. They could only use this secret for challenges with others. The turning point came in 1543 when Cardano and Ferrari traveled to Bologna. They learned from a man named Della Nave that Scipione del Ferro (1465–1526) had solved cubic equations long ago. Ferro had been a mathematics professor since 1496, and Fior, who was defeated by Tartaglia in 1535, was Ferro's student! Cardano immediately realized that since the first person to solve cubic equations was Ferro, not Tartaglia, he could throw the oath to the wind. In 1545, Cardano published a book of great significance in the history of mathematics, \emph{Ars magna}, which publicly revealed the complete solutions to cubic and quartic equations. On page 8, he wrote:

\begin{quotation}
In our own days Scipione del Ferro of Bologna has solved the case of the cube and first power equal to a constant, a very el- egant and admirable accomplishment. Since this art surpasses all human subtlety and the perspicuity of mortal talent and is a truly celestial gift and a very clear test of the capacity of men’s minds, whoever applies himself to it will believe that there is nothing that he cannot understand. In emulation of him, my friend Niccolo` Tartaglia of Brescia, wanting not to be outdone, solved the same case when he got into a contest with his [Sci- pione’s] pupil, Antonio Maria Fior, and, moved by my many entreaties, gave it to me . . . having received Tartaglia’s solution and seeking a proof of it, I came to understand that there were a great many other things that could also be had. Pursuing this thought and with increased confidence, I discovered these others, partly by myself and partly through Lodovico Ferrari, formerly my pupil.
\end{quotation}

Ths book brought great fame to Cardano, but Tartaglia was furious. He felt that Cardano had betrayed the oath and revealed the secret. The following year, Tartaglia published a booklet \emph{New Problems and Inventions}, trying to give the true story and expose Cardano's treacherous act. But Cardano once again showed his old-school fighting strategy. He retreated to the background and kept silent while letting his servant Ferrari publicly engage in a war of words with Tartaglia. To outsiders, it seemed that primary school teacher Tartaglia could only argue with Cardano's servant, thus being on the same level as the servant and below the famous scholar, mathematician, and renowned doctor Cardano. Ferrari publicly challenged Tartaglia, but the person Tartaglia really wanted to challenge was Cardano, who always ignored him. After a year of mutual insults and attacks between Tartaglia and Ferrari, a dramatic scene occurred. The University of Brescia invited Tartaglia to teach in his hometown, but on the condition that he must go to Milan to participate in a \enquote{duel} with Ferrari. So on August 10, 1548, the second duel took place in Milan's Church of Santa Maria delle Grazie (see \cref{fig:church-Milan}). At sunset, Ferrari had all the advantages; he not only mastered the solution to cubic equations but also challenged his opponent with quartic equations. Tartaglia left without saying goodbye that night; he lost.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/churchmilan}
  \caption{Church of Santa Maria delle Grazie in Milan.}
 \label{fig:church-Milan}
\end{figure}

Tartaglia suffered as a result of the contest. After giving his lectures for a year in Brescia, he was informed that his stipend was not going to be honoured. Even after enumours lawsuit, he could not get any payment. He returned to his previous job in Venice, nursing a huge resentment of Cardan. It seemed that Cardano's oath was hovering over him. In 1560, Cardano's eldest son was accused of poisoning his unfaithful wife and sentenced to death. He was completely devastated by the loss of his son and moved from Milan to Brescia. In 1565, Cardano suffered another blow when his favorite pupil Ferrari was poisoned by his sister. Cardano indulged in gambling and astrology, and he was imprisoned in 1570 for casting the horoscope of Jesus Christ and writting a book in praise of Nero, which was considered heresy by the church. After being released from prison, he moved to Rome and published an autobiography in the last year of his life. In the autobiography, he repeatedly mentioned the pain of losing his son and boasted about his achievements but only briefly mentioned Tartaglia in one sentence. The story here mainly comes from Tartaglia's \emph{New Problems and Inventions} and the letters between him, the intermediary bookseller, Cardano, and Ferrari.

\begin{figure}[htbp]
 \centering
 \subcaptionbox{Tartaglia \label{fig:tartaglia}}{\includegraphics[scale=0.35]{img/tartaglia-coin}}
 \subcaptionbox{Cardano \label{fig:cardano}}{\includegraphics[scale=0.3]{img/Cardano}}
 \caption{Tartaglia and Cardano.}
\end{figure}

We call the formula to the cubic equation the Cardano-Tartaglia formula, or simply the Cardano formula. Besides that, Tartaglia also published a book on ballistics in 1546, which was the first to provide ballistic tables. In 1543, he was the first to translate Euclid's \emph{Elements} into Italian and publish it. He also translated some of Archimedes' works into Italian. Despite his obvious flaws, Cardano was an encyclopedic scholar. He was the first to give a clinical description of typhus, and his mathematical contributions covered algebra and probability theory. He also invented the universal joint, known as the Cardan shaft. Leibniz commented: \enquote{Despite his flaws, he is a great man; but if it were not for these flaws, he would be incomparable.}

\section{The solution of the cubic}

Different from the common understanding, complex numbers were not discovered in the process of solving quadratic equations but were unexpectedly found when solving cubic equations. In this section, we will derive the Cardano formula using both algebraic and geometric methods.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/plimpton322}
  \caption{Babylonian clay tablet, Plimpton 322, containing a table of Pythagorean triples, dating from around 2020 BC. It is housed at Columbia University. It was donated to Columbia University in the 1920s by George Arthur Plimpton.}
 \label{fig:plimpton322}
\end{figure}

\index{Babylonian table of Pythagorean triples}
%% https://personal.math.ubc.ca/~cass/courses/m446-03/pl322/pl322.html

We learned about the early history of quadratic equations from Babylonian clay tablets. As shown in \cref{fig:plimpton322}, this is a clay tablet housed at Columbia University, numbered Plimpton 322. The cuneiform text on this tablet is quite special. German historians of science Neugebauer and Sachs discovered that it is actually a table of Pythagorean triples. Based on the ancient Babylonian numeral system given in Chapter 1, we can easily see that the last column is numbered $1, 2, 3, \dotsc, 15$, with the numbers 5, 6, and 15 damaged. Similarly, the second column from the right is also numbered. The header of the second column from the left indicates the base of a right triangle, which converts to decimal as follows: $119, 3367, 4601, \dotsc, 1771, 56$, with the last number 56 damaged and two errors. The header of the third column from the left indicates the hypotenuse of a right triangle, which converts to decimal as follows: $169, 4825, 6649, \dotsc, 3229, 106$, with the last number also having an error and being damaged. The numbers in the first column from the left are the most difficult to decipher; at that time, ancient Babylonians had not yet used zero or decimal points. Scientists deciphered it and converted it to decimal numbers as follows: $1.9834\dotso, 1.94916\dotso, 1.9188\dotso$ until $1.43024\dotso, 1.38716\dotso$. Sexagesimal fractions converted to decimal usually do not terminate (see \cref{thm:finite-decimal}), hence the ellipsis. If we denote the base of a right triangle as $w$, the hypotenuse as $d$, and the height as $h$, scientists found that the numbers in the first column are $\dfrac{d^2}{h^2}$, which equals $\dfrac{d^2}{d^2 - w^2}$ according to the Pythagorean theorem. For example, for the first row: $d = 169$ and $w = 119$, we can calculate:

\[
\frac{d^2}{d^2 - w^2} = \frac{169^2}{169^2 - 119^2} = 1.9843\dotso
\]

%% https://engelsbergideas.com/notebook/the-brilliance-of-babylonian-mathematics/
Which is exactly the number in the first column. This table evidently shows that the Babylonians were aware of the Pythagorean theorem (although without a proof of the theorem) and applied it in calculations. As more cuneiform tablets were unearthed, scientists also found \enquote{practice problems} related to the Pythagorean theorem. One of the problems states: \enquote{Given the area and the diagonal of a rectangle, find the lengths of the two sides of the rectangle.} This typical land measurement problem is equivalent to solving the system of equations:

\[
\begin{cases}
  ab = s \\
  a^2 + b^2 = d^2
\end{cases}
\]

\index{geometric solution to the quadratic equations}
where $s$ is the area and $d$ is the diagonal. By substituting $b = \dfrac{s}{a}$ into the second equation, we get a quadratic equation in terms of $a^2$, which is $(a^2)^2 - d^2 a^2 + s^2 = 0$. At that time, there was no algebraic symbol system, and the Babylonians described the process of solving quadratic equations in words. Before learning the quadratic formula in middle school, we usually introduce the \enquote{completing the square} method, which is essentially an algebraic solution. The Arab mathematician Al-Khwarizmi, in his book \emph{Al-Kitab al-Mukhtasar fi Hisab al-Jabr wal-Muqabala}\footnote{This is the original Arabic title of \emph{The Compendious Book on Calculation by Completion and Balancing}, see \cref{sec:Khwarizmi}}, also followed the Greek tradition and provided a geometric explanation for quadratic equations. If $a \ne 0$, we can transform the general quadratic equation $ax^2 + bx + c = 0$ into a form where the coefficient of the quadratic term is 1, and move the constant term to the right side, obtaining $x^2 + \dfrac{b}{a}x = -\dfrac{c}{a}$. Let $p = \dfrac{b}{a}$ and $q = -\dfrac{c}{a}$, we shall solve the equation $x^2 + px = q$ using geometric methods. If $p > 0$, \cref{fig:quadratic1} illustrates the geometric meaning of the left side of the equation. The term $q$ corresponds to the area of a square with side length $x$ plus the area of a rectangle with length $p$ and width $x$.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.5]{img/quadratic1}
  \caption{geometric interpretation of $x^2 + px$: the sum of a square and a rectangle.}
 \label{fig:quadratic1}
\end{figure}

\index{completing the square}
The method of completing squares has a geometric interpretation: it involves cutting the rectangle into two smaller rectangles of equal length $\dfrac{p}{2}$ and width $x$ (see the left side of \cref{fig:quadratic2}), then moving one of them to the bottom of the square, and adding a small square with side length $\dfrac{p}{2}$ (see the black square on the right side of \cref{fig:quadratic2}) to form a larger square with side length $x + \dfrac{p}{2}$. The white areas in both diagrams are equal, which means:

\begin{align*}
 \left(x + \frac{p}{2}\right)^2 &= q + \left(\frac{p}{2}\right)^2 &&\text{the area of the large square equals the sum of white and black areas} \\
 x + \frac{p}{2} &= \pm \sqrt{q + \left(\frac{p}{2}\right)^2} &&\text{taking square root on both sides} \\
 x &= -\frac{p}{2} \pm \sqrt{q + \frac{p^2}{4}} \\
 x &= -\frac{b}{2a} \pm \sqrt{-\frac{c}{a} + \frac{b^2}{4a^2}} &&\text{substituting back } p = \frac{b}{a}, q= -\frac{c}{a} \\
 x &= \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}
\end{align*}

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.5]{img/quadratic2}
  \caption{geometric interpretation of $x^2 + px$: the sum of a square and a rectangle.}
 \label{fig:quadratic2}
\end{figure}

\index{Cardano formula}
This is the formula for solving quadratic equations. However, during the time of Al-Khwarizmi, negative numbers were not accepted, so when the linear term is negative, a geometric interpretation of $x^2 - px = q$ is needed; when the constant term is negative, a geometric interpretation of $x^2 - q = px$ is needed (see \cref{qn:geometric-quadratic}). Cardano followed this tradition in \emph{Ars magna}, providing both algebraic solutions and geometric interpretations for cubic equations. Let's first introduce the algebraic solution. For a general cubic equation $a_3x^3 + a_2x^2 + a_1x + a_0 = 0, a_3 \ne 0$, we first divide both sides by $a_3$ to make the coefficient of the cubic term equal to 1, obtaining $x^3 + \dfrac{a_2}{a_3} x^2 + \dfrac{a_1}{a_3} x + \dfrac{a_0}{a_3} = 0$. Renaming the coefficients as $x^3 + ax^2 + bx + c = 0$. Around the end of the 14th century, mathematicians in Florence discovered that by substituting $x = y - \dfrac{a}{3}$, the quadratic term can be eliminated:

\begin{align*}
(y - \frac{a}{3})^3 + a(y - \frac{a}{3})^2 + b(y - \frac{a}{3}) + c &= 0  \\
y^3 -\cancel{ay^2} + \frac{a^2}{3}y - \frac{a^3}{27} + \cancel{ay^2} - \frac{2a^2}{3}y + \frac{a^3}{9} + by - \frac{ab}{3} + c &= 0 && \text{binomial expansion} \\
y^3 + (b - \frac{a^2}{3})y + \frac{2a^3}{27} - \frac{ab}{3} + c &= 0 \\
y^3 + py + q &= 0
\end{align*}

where $p = b - \dfrac{a^2}{3}$ and $q = c + \dfrac{2a^2}{27} - \dfrac{ab}{3}$. As people rejected negative numbers at that time, there are three forms of cubic equations without the quadratic term depending on the signs of $p$ and $q$:

\begin{align}
y^3 + py &= q \label{eq:cubic-linear} \\
     y^3 &= py + q \label{eq:cubic-complex} \\
y^3 + q &= py
\end{align}

What Ferro discovered was the solution to \cref{eq:cubic-linear}, while the solution to \cref{eq:cubic-complex} directly led to the discovery of complex numbers. Let's take $y^3 = py + q$ as an example to derive the formula for solving cubic equations. Let $y = u + v$, then the left side of the equation becomes:

\begin{align*}
y^3 = (u + v)^3 &= u^3 + 3u^2v + 3uv^2 + v^3 && \text{binomial expansion} \\
  &= u^3 + v^3 + 3uv(u + v) \\
  &= u^3 + v^3 + 3uvy && \text{代入} y = u + v \\
  &= (3uv)y + (u^3 + v^3) = py + q 
\end{align*}

equating the coefficients of $y$ and the constant terms, we get:

\[
\begin{cases}
  3uv = p \\
  u^3 + v^3 = q
\end{cases}
\]

This is a system of two equations in terms of $u$ and $v$. From the first equation, we can express $v$ as $v = \dfrac{p}{3u}$, and substitute it into the second equation to get:

\[
u^3 + (\frac{p}{3u})^3 = q
\]

It is acutally a quadratic equation in terms of $u^3$, that is, $(u^3)^2 - qu^3 + (\dfrac{p}{3})^3 = 0$. Using the quadratic formula, we can solve for $u^3$:

\[
u^3 = \frac{q}{2} \pm \sqrt{\left(\frac{q}{2}\right)^2 - \left(\frac{p}{3}\right)^3}
\]

Since $u$ and $v$ are symmetric in the above system of equations, $v^3$ must have the same form. We can let them take these two roots respectively:

\[
\begin{dcases}
u^3 = \dfrac{q}{2} + \sqrt{\left(\dfrac{q}{2}\right)^2 - \left(\dfrac{p}{3}\right)^3} \\
v^3 = \dfrac{q}{2} - \sqrt{\left(\dfrac{q}{2}\right)^2 - \left(\dfrac{p}{3}\right)^3}
\end{dcases}
\]

\index{Cardano formula}
They satisfy $u^3 + v^3 = q$. Finally, since $y = u + v$, we can obtain the root of the equation: 

\be \label{eq:cardano}
y = u + v = \sqrt[3]{\frac{q}{2} + \sqrt{\left(\frac{q}{2}\right)^2 - \left(\frac{p}{3}\right)^3}} + \sqrt[3]{\frac{q}{2} - \sqrt{\left(\frac{q}{2}\right)^2 - \left(\frac{p}{3}\right)^3}}
\ee

\index{geometric solution to cubic equations} \label{sec:geometric-cubic-solution}
This is the Cardano formula for solving cubic equations. We can further find the unknown $x$ using $x = y - \dfrac{a}{3}$. We will next solve the cubic equation $y^3 + py = q$ using geometric methods. As shown in \cref{fig:cube-decompose}, we can cut a large cube with side length $r$ into 5 parts: a small cube with side length $r-s$ at the lower left front corner; a small cube with side length $s$ at the upper right back corner; and three rectangular prisms with length $r$, width $r-s$, and height $s$, located at the upper left, lower right front, and lower right back corners respectively. The volume of the large cube equals the sum of the volumes of these 5 parts, that is:

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.4]{img/cube-decompose}
  \caption{A cube with side length of $r$ consists of 5 parts.}
 \label{fig:cube-decompose}
\end{figure}

\begin{align*}
r^3 = (r-s)^3 + s^3 + 3rs(r-s)  &&\text{two cubes and three rectangular prisms} \\
(r-s)^3 + 3rs(r-s) = r^3 - s^3
\end{align*}

Let $p = 3rs, q = r^3 - s^3$ and substitute into the above equation: $(r-s)^3 + p(r-s) = q$. Obviously, $y = r - s$ is a solution to the equation $y^3 + py = q$. Therefore, as long as we can find suitable $r$ and $s$ based on $p$ and $q$, we can solve the cubic equation. From $p = 3rs$, we have $s = \dfrac{p}{3r}$, and substituting it into $q = r^3 - s^3$ gives us the equation:

\[
r^3 - (\frac{p}{3r})^3 = q
\]

This is actually a quadratic equation in terms of $r^3$, that is, $(r^3)^2 - qr^3 - (\dfrac{p}{3})^3 = 0$. Using the quadratic formula, we can solve for $r^3$:

\[
r^3 = \frac{q}{2} + \sqrt{\left(\frac{q}{2}\right)^2 + \left(\frac{p}{3}\right)^3}
\]

by $q = r^3 - s^3$, hence,

\[
s^3 = -\frac{q}{2} + \sqrt{\left(\dfrac{q}{2}\right)^2 + \left(\dfrac{p}{3}\right)^3}
\]

\index{Cardano formula}
And as $y = r - s$:

\[
y = r - s = \sqrt[3]{\frac{q}{2} + \sqrt{\left(\frac{q}{2}\right)^2 + \left(\frac{p}{3}\right)^3}} + \sqrt[3]{\frac{q}{2} - \sqrt{\left(\frac{q}{2}\right)^2 + \left(\frac{p}{3}\right)^3}}
\]

Comparing this with the Cardano formula derived from algebraic methods, \cref{eq:cardano}, we can see that the only difference is the sign of $p$. This is because in the equations $y^3 + py = q$ and $y^3 = py + q$, the sign of $p$ is opposite. Let's apply the Cardano formula to the equation $x^3 = 6x + 9$.

\begin{align*}
x &= \sqrt[3]{\frac{9}{2} + \sqrt{\left(\frac{9}{2}\right)^2 - \left(\frac{6}{3}\right)^3}} + \sqrt[3]{\frac{9}{2} - \sqrt{\left(\frac{9}{2}\right)^2 - \left(\frac{6}{3}\right)^3}} \\
  &= \sqrt[3]{\frac{9}{2} + \sqrt{\frac{81 - 32}{4}}} + \sqrt[3]{\frac{9}{2} - \sqrt{\frac{81 - 32}{4}}} \\
  &= \sqrt[3]{\frac{9}{2} + \frac{7}{2}} + \sqrt[3]{\frac{9}{2} - \frac{7}{2}} \\
  &= \sqrt[3]{8} + \sqrt[3]{1} = 2 + 1 = 3
\end{align*}

It's easy to verify that $3^3 = 27 = 6 \times 3 + 9$. Cardano's formula to the cubic equation is a significant breakthrough in mathematics, and people were eager to use it to solve various problems. However, some equations were perplexing, with the most famous example being $x^3 = 15x + 4$. By observation, $x = 4$ is a solution to the equation: $4^3 = 64 = 60 + 4 = 15 \times 4 + 4$. But the result given by the Cardano formula is:

\begin{align*}
x &= \sqrt[3]{2 + \sqrt{2^2 - 5^3}} + \sqrt[3]{2 - \sqrt{2^2 - 5^3}}  \\
  &= \sqrt[3]{2 + \sqrt{-121}} + \sqrt[3]{2 - \sqrt{-121}}
\end{align*}

\index{Bombelli}
surprisingly, a negative number appears under the square root. When solving quadratic equations, if the discriminant is negative, people can say \enquote{no solution}. But this equation clearly has a solution $x = 4$, which is not \enquote{no solution}. Cardano didn't know how to answer it, and he commented in \emph{Ars magna}: \enquote{These numbers are both subtle and useless.} The breakthrough on this issue was made by the Italian mathematician Rafael Bombelli (1526–1572). Bombelli imagined simplifying $\sqrt[3]{2 \pm \sqrt{-121}}$ into the form $a \pm b\sqrt{-1}$. Then the two terms in the Cardano formula would add up to:

\[
\sqrt[3]{2 + \sqrt{-121}} + \sqrt[3]{2 - \sqrt{-121}} = a + b\sqrt{-1} + a - b\sqrt{-1} = 2a = 4
\]

Hence, $a = 2$. Next is to determine $b$. Bombelli assumed that $(\sqrt{-1})^2 = -1$, cubing both sides:

\begin{align*}
2 + \sqrt{-121} &= (2 + b\sqrt{-1})^3 \\
  &= 8 + 12b\sqrt{-1} - 6b^2 - b^3\sqrt{-1} && \text{binomial expansion} \\
  &= (8 - 6b^2) + (12b - b^3)\sqrt{-1}
\end{align*}

From $2 = 8 - 6b^2$, it follows that $b = \pm 1$; substituting $1$ into $(12b - b^3)\sqrt{-1}$ gives $11\sqrt{-1}$. Squaring it verifies that $(11\sqrt{-1})^2 = -121$. Therefore, we have $\sqrt[3]{2 + \sqrt{-121}} = 2 + \sqrt{-1}$. For $b = -1$, Bombelli further verified by cubing both sides that $\sqrt[3]{2 - \sqrt{-121}} = 2 - \sqrt{-1}$ also holds. He was very pleased with this result and wrote in his book \emph{Algebra}, published in 1572: \enquote{At first, I felt that such treatment was more like sophistry than truth, but I kept searching until I found the proof.}\cite{OMerino-2006} Bombelli's mathematical perspective was far ahead of his time. When people had not yet accepted negative numbers, Bombelli not only correctly defined the rules of operations between positive and negative numbers in \emph{Algebra}, but also provided the calculation rules for complex numbers. He called $\sqrt{-n}$ the \enquote{plus of minus} and $-\sqrt{-n}$ the \enquote{minus of minus}, then wrote\cite{MacTour-Bombelli}:

\begin{quotation}
Plus of minus times plus of minus makes minus [$\sqrt{-n} \times \sqrt{-n} = -n$]

Plus of minus times minus of minus makes plus [$\sqrt{-n} \times -\sqrt{-n} = n$]

Minus of minus times plus of minus makes plus [$-\sqrt{-n} \times \sqrt{-n} = n$]

Minus of minus times minus of minus makes minus [$-\sqrt{-n} \times -\sqrt{-n} = -n$]
\end{quotation}

Bombelli had planned five books of \emph{Algebra}, sadly, he died in 1572 after publishing the first three books. The remaining two were not discovered until 1923 in a library in Bologna, Italy. At that time, people did not believe and accept Bombelli's views, and the mathematical community largely rejected $\sqrt{-1}$. In the following 200 years, even though a few scholars like Wallis attempted to give meaning to complex numbers, most people either doubted or ignored Bombelli's calculation rules. It wasn't until 1770 that Euler still \enquote{proved} in his work that $\sqrt{-2} \times \sqrt{-3} = \sqrt{6}$, which would surprise us today\footnote{Euler actually used the symbol $\sqrt{6}$ to represent the two square roots of 6, $\pm\sqrt{6}$; similarly, $\sqrt{-2}$ represents the two square roots of -2, $\pm\sqrt{-2}$; and $\sqrt{-3}$ represents the two square roots of -3, $\pm\sqrt{-3}$. Thus, Euler's original intention was to express all combinations of $\pm \sqrt{-2} \times \pm \sqrt{-3} = \pm \sqrt{6}$.}. Some people highly praised Bombelli's work; Leibniz said he was \enquote{a master of the art of analysis.} Today, Bombelli is known as \enquote{the father of imaginary numbers.}

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.4]{img/Bombelli}
  \caption{Rafael Bombelli (1526 - 1572)}
 \label{fig:Bombelli}
\end{figure}

Bombelli used the form $a + b\sqrt{-1}$. The first person to use this form was Cardano, but he immediately rejected it. In Chapter 37 of \emph{Ars magna}, Cardano presented a problem: divide 10 into two parts such that their product is 40. The system of equations is:

\[
\begin{cases}
x + y = 10 \\
xy = 40
\end{cases}
\]

Represent $y$ as $10 - x$, and substitute it into the second equation to get $x(10 - x) = 40$. Dividing 10 into two parts, the maximum product is $5 \times 5 = 25$, so 40 is impossible (we can also think of it as using a 20 $cm$ rope to form a rectangle, the square with side length 5 has the largest area of 25 $cm^2$). Cardano wrote:

\begin{quotation}
  This is clearly impossible. However, if we divide 10 into two parts of 5, the square is 25. Subtracting 40 from it, if you wish, gives $-15$. By adding and subtracting the square root of $-15$ to 5, we get two numbers whose product is 40. Therefore, these two numbers are $5 + \sqrt{-15}$ and $5 - \sqrt{-15}$. Although it may seem absurd, by cubing both sides of the equation

Dismissing mental tortures, and multiplying $5 + \sqrt{-15}$ by $5 - \sqrt{-15}$, we obtain $25 - (-15)$. Therefore the product is 40. .... and thus far does arithmetical subtlety go, of which this, the extreme, is, as I have said, so subtle that it is useless.
\end{quotation}

\index{imaginary number}
Cardano's method was to divide 10 into two parts, $5 + x$ and $5 - x$, such that their product is 40. Because $(5 + x)(5 - x) = 25 - x^2 = 40$, hence $x^2 = -15$. This leads to the solution $5 \pm \sqrt{-15}$. Due to the irrationality of negative squares, particularly in the application of quadratic equations, Cardano and most of his contemporaries abandoned complex solutions. However, Bombelli realized that in  cubic equations, such numbers as intermediate results make sense. The term \enquote{imaginary number} attributes to Descartes. When developing analytic geometry\footnote{Published in the appendix \emph{La Géométrie} of his book \emph{Discours de la méthode}.} in 1637, Descartes corresponded the roots of equations to the intersection points between curves or the zeros of curves with coordinate axes. Although people at that time did not recognize the fundamental theorem of algebra, Descartes had insights that the number of roots of an equation equals its degree. Curves may not intersect with each other, or intersect with the $x$-axis, Facing with such geometrically impossible constructions, Descartes considered their intersection points or zeros as imaginary. The term \enquote{imaginary} also has the meaning of being imagined in English. Descartes wrote \enquote{, For any equation, one can imagine as many roots as its degree, but in many cases, these roots correspond to values that do not exist.}

\index{i as imaginary unit}
We use the symbol $i$ as the imaginary unit today. This symbol was chosen by Euler. It is the first letter of \enquote{imaginary}. Descartes' opinion reflected the view of most people at that time. Mathematicians did not like the terms indicating fiction and imagination. One reason is that $\sqrt{-n}$ brought confusion and ambiguity. For example, does the common operation rule $\sqrt{ab} = \sqrt{a}\sqrt{b}$ still hold? Some pointed out such a problem:

\begin{align*}
70 &= \sqrt{4900} = \sqrt{(-100)\times(-49)} = \sqrt{-100}\sqrt{-49} \\
   &= (10i)(7i) = 70 \times (-1) = -70
\end{align*}

$70 = -70$ is absurd (see \cref{qn:sqrt-of-product}). Cauchy, known as the father of complex analysis,  suggested rejecting the symbol $\sqrt{-1}$, and Gauss was also dissatisfied with $i$, suggesting a new name. But his suggestion came too late, as $i$ had already been widely used and continues to be used today.  

\section{Geometric interpretation}

Nobody will accept complex numbers unless they have a clear meaning, that is natural, convincing, and able to solve real problems. In 1673, Wallis, a pioneer of calculus attempted to give a geometric interpretation of complex numbers. Wallis, who invented the number line, tried to use it to solve the equation $x^2 + 2bx + c^2 = 0$. The two roots are $x_{1,2} = -b \pm \sqrt{b^2 - c^2}$. As shown in \cref{fig:wallis1}, Wallis marked $-b$ on the number line and constructed two right triangles on either side with height $c$ and hypotenuse length $b$. By Pythagorean theorem, the length of other leg is $a = \sqrt{b^2 - c^2}$. Therefore, on either side of the point $-b$, at a distance of $a$, are the two roots $x_{1,2}$.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/wallis1}
  \caption{Roots $x_{1,2} = -b \pm \sqrt{b^2 - c^2}$ on the number line.}
 \label{fig:wallis1}
\end{figure}

Everything is fine so far. Then Wallis kept increasing the value of $c$, and the two roots $x_{1,2}$ got closer and closer to the point $-b$. When $c = b$, the two roots coincide. What if we keep increasing $c$? Wallis drew a picture as shown in \cref{fig:wallis2}.

\begin{figure}[htbp]
  \centering
  \subcaptionbox{Where Wallis marked $-b \pm i\sqrt{c^2-b^2}$. \label{fig:wallis2}}{\includegraphics[scale=0.33]{img/wallis2}}
  \subcaptionbox{The location of $-b \pm i\sqrt{c^2-b^2}$ in the complex plane. \label{fig:wallis3}}{\includegraphics[scale=0.33]{img/wallis3}}
  \caption{Roots of $x^2 + 2bx + c^2 = 0$ when $c > b$.}
\end{figure}

\index{Wessel}
It's almost correct. Wallis thought that at this point, $c$ becomes the hypotenuse, one leg is $b$, and the other leg is $\sqrt{c^2 - b^2}$, but they are still on either side of the point $-b$. In fact, if Wallis had just swapped the left and right sides to up and down, he could have touched the complex plane. It's really a pity. The first person in history who successfully gave the geometric interpretation to complex numbers was Danish-Norwegian mathematician Caspar Wessel (1745–1818). On March 10, 1797, Wessel submitted his work to the Royal Danish Academy of Sciences and Letters, titled \emph{On the Analytical Representation of Direction—An Attempt at Solving Problems in Geometry of Position}. He successfully represented a complex number $a + bi$ as a line segment (i.e., a vector) from the origin to the coordinate $(a, b)$ in a Cartesian coordinate system, and defined algebraic rules for calculations between vectors, including addition and multiplication. Geometrically, the addition rule corresponds to the \enquote{parallelogram} principle; multiplication corresponds to multiplying the lengths of the line segments and adding their  angles with respect to the horizontal axis. Wessel's paper was published two years later. Unfortunately, Wessel's was a surveyor rather than a well-known mathematician, and his paper was written in Danish, which did not attract enough attention at that time. Wessel's name was ignored by most people until about 100 years later in 1895 when his work was reappreciated. Norwegian mathematician Sophus Lie republished Wessel's paper. Even more surprisingly, in 1806, a young man independently rediscovered the complex plane and the geometric meaning of complex numbers, but no one knows his name.

\subsection{The mysterious young man}
\index{Argand}
In the autumn of 1806, a young man knocked on the door of Adrien-Marie Legendre, a member of the Paris Academy. He was very nervous. Legendre was considered one of the best mathematicians and the successor of Lagrange. After Napoleon rebuilt the Academy, he appointed Legendre as the head of the mathematics section and the chief examiner of France's highest institution, the École Polytechnique. The young man made a brief self-introduction, and due to his nervousness, he even forgot to mention his name. He respectfully handed Legendre a manuscript and asked him to review. The young man did not explain the purpose in detail, but when asked about the content of the paper, he immediately became excited. enquote{this is a treatise on imaginary numbers. I found them actually meaningful, as real as other numbers! As long as we treat them as line segments, we will find...} Legendre was skeptical about the young man's rambling. He had to interrupt: \enquote{I am very busy right now, but I promise to read your paper when I have time. Let's stop here for today.} Before the door closed, the young man pleaded again: \enquote{Sir, I am very much looking forward to your criticism and suggestions.}

Legendre soon forgot about this encounter. He was busy with his research and the affairs of the Academy. Until a few weeks later, Legendre happened to see a few sheets of paper on his desk, titled \emph{A Treatise on a Method of Representing Imaginary Numbers in Geometric Constructions}. Who sent this? Oh, I remember, what was that young man's name? I can't recall it, but anyway, Legendre read on. To his surprise, once started reading, he was immediately impressed by the innovative ideas, the smooth and flowing arguments, the solid calculations, and the precise conclusions that perfectly combined numbers, geometry, and trigonometry. Legendre decided to contact this young man immediately and have an in-depth discussion with him. However, he searched through the paper but could not find any name or address. How could this be? Maybe this young man will come again in a few days? Legendre decided to wait. Day after day, from late autumn to early winter, the first snow had already fallen in Paris. But the young man never showed up again. Will this young man publish his paper directly in a journal? Then I can find him for discussion. Legendre went to the library to check various mathematical journals from the past few months, but was disappointed again. Maybe the young man was discouraged by Legendre's response that day and gave up on this research. On November 2, Legendre sent this paper to his friend and collaborator François Français, with a brief comment praising the young man for his love of scholarship without seeking fame, and noting that although it was a draft, it was sufficiently innovative.

François Français mainly studied partial differential equations, and although his work was often praised by the French Academy, he rarely published during his lifetime. After François Français's death in 1810, his brother Jacques Français discovered this memoir on complex numbers while organizing his papers. He published it in September 1813 under the title \emph{New Principles of Geometry of Position and an Explanation of the Symbol of Imaginary Numbers}. Jacques Français showed true scholarly spirit; he did not claim this achievement as his own. At the end of the paper, he pointed out that these ideas came from an unknown mathematician and he asked that the mathematician should make himself known so that he might receive the credit for his ideas. Soon after the article by Jacques Français appeared in Gergonne's famous journal\emph{Annales de mathématiques}, a person named Argand responded that he was that unknown author and sent a slightly modified manuscript titled \emph{A Treatise on a Method of Representing Imaginary Numbers in Geometric Constructions}. Argand added new applications in it. This already dramatic event then attracted the attention of many mathematicians: Jacques Français, Argand, and Servois engaged in a heated discussion in \emph{Annales de mathématiques}. Servois believed that complex numbers must be treated with pure algebra, while Jacques Français and Argand advocated for the effectiveness of geometric representation. Argand then demonstrated the power of geometric representation of complex numbers - he proved the fundamental theorem of algebra. From today's perspective, although there are some flaws, it is one of the clearest and most elegant proofs. Argand's work was ahead of its time, but unfortunately, we do not know who he really is! He only signed as \enquote{Argand} in all his papers, but not the full name.Which one among many people named Argand is he? We only know that he appeared in Paris in 1806, and the paper published in 1813 was sent from Paris. Some speculate that he might be Jean Robert Argand, an accountant and amateur mathematician living in Paris, but the age does not match. In 1806, Legendre described him as a \emph{young} man, but Jean Robert Argand was already 38 years old at that time\cite{MacTour-Argand}.

\index{Argand diagram}
Our story mainly comes from the letters between Legendre and François Français, and the paper by Jacques Français. To commemorate Argand's achievements, today we call \cref{fig:Argand-diagram} the \enquote{Argand diagram}, which appears in classrooms around the world\cite{Weisstein-2025}.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/argand-diagram}
  \caption{Argand diagram}
 \label{fig:Argand-diagram}
\end{figure}

\subsection{The geometric interpretation of complex numbers}
\index{The geometric interpretation of complex numbers}
A picture is worth a thousand words. We can immediately see from the Argand diagram that a complex number $z$ consists of two parts: the real part $a$ and the imaginary part $bi$. The imaginary axis creatively extends vertically upwards, and the real axis and the imaginary axis are perpendicular to each other, forming the complex plane. A complex number is represented as a vector from the origin to the point with coordinates $(a, b)$ in the complex plane. Drawn as a line segment with an arrow, this vector is $a + bi$. The imaginary unit $i$ is not any real number because it is not on the real axis at all. If we say that any number $a$ on the real axis multiplied by $-1$ corresponds to a \enquote{turning back}, becoming a negative number $-a$ pointing to the other side, then multiplying $a$ by $i$ corresponds to \enquote{turning left by $90\degree$}, becoming $ai$ on the imaginary axis; multiplying by $i$ again corresponds to \enquote{turning left by another $90\degree$}, returning to the real axis pointing to the other side as $-a$. Two turns of $90\degree$ correspond to a turn of $180\degree$, which perfectly explains why $i^2 = -1$. We can immediately see from the Pythagorean theorem that the length of the line segment represented by the vector $a + bi$ is $r = \sqrt{a^2 + b^2}$, which is called the modulus of the complex number $z$, denoted as $|z|$. The angle between the vector and the real axis is called the argument of the complex number, denoted as $\arg(z)$. From the definition of trigonometric functions, we immediately know that the real part and imaginary part of a complex number can be expressed as: $a = r\cos\theta, b = r\sin\theta$, thus there are two equivalent representations for a complex number:

\[
a + bi = r\cos\theta + ir\sin\theta = r(\cos\theta + i\sin\theta)
\]

Argand diagram algo gives a clear interpretation to the multiplication of complex numbers: \index{complex number multiplication}

\begin{align*}
z_1z_2 &= r_1(\cos\theta_1 + i\sin\theta_1) \cdot r_2(\cos\theta_2 + i\sin\theta_2) \\
  &= r_1r_2[\cos\theta_1\cos\theta_2 - \sin\theta_1\sin\theta_2 + i(\sin\theta_1\cos\theta_2 + \cos\theta_1\sin\theta_2)] && \text{expanding }, i^2 = -1 \\
  &= r_1r_2[\cos(\theta_1 + \theta_2) + i\sin(\theta_1 + \theta_2)] && \text{sum of angles formulas}
\end{align*}

\label{sec:proof-to-machin}
Thus when multiplying two complex numbers, we multiply their moduli and add their arguments. The mathematician Abraham de Moivre (1667–1754) multiplied two complex numbers with modulus 1 and the same argument to get:

\[
(\cos \theta + i\sin \theta)^2 = \cos (\theta + \theta) + i\sin (\theta + \theta) = \cos 2\theta + i\sin 2\theta
\]

\index{de Moivre's formula}
Further, multiplying $n$ such complex numbers together gives the famous de Moivre's formula:

\be \label{eq:de-Moivre}
(\cos \theta + i\sin \theta)^n = \cos n\theta + i\sin n\theta
\ee

Argand's geometric interpretation of complex numbers is a perfect example of the integration of numbers, geometry, vectors, and trigonometry. To demonstrate the power of the combination of numbers and shapes that complex numbers possess, we will give an elegant proof of Machin's formula (see \cref{sec:machin-formula}). People found Leibniz's formula for $\pi$ converges very slow, they found below series converges much faster:

\[
\frac{\pi}{4} = \tan^{-1} \frac{1}{2} + \tan^{-1} \frac{1}{3}
\]

\begin{proof}
 The argument of a complex number $z = a + bi$ is given by $\arg(z) = \tan^{-1}\dfrac{b}{a}$. The right side of the above equation can be seen as the sum of two arguments, which correspond to the complex numbers $z_1 = 2 + i$ and $z_2 = 3 + i$. When multiplying two complex numbers, their arguments add up, that is, $\arg(z_1 z_2) = \arg(z_1) + \arg(z_2)$.

\begin{align*}
z_1 z_2 &= (2+i)(3+i) = (6 - 1) + (2 + 3)i = 5 + 5i \\
arg(5 + 5i) &= arg(2+i) + arg(3+i) && \text{add arguments when multiply complex numbers} \\
\frac{\pi}{4} &= \tan^{-1}\frac{5}{5} = \tan^{-1}\frac{1}{2} + \tan^{-1}\frac{1}{3} && \text{see \cref{fig:machin1}} \qedhere
\end{align*}
\end{proof}

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/machin1}
  \caption{$(2 + i)(3 + i) = 5 + 5i$}
 \label{fig:machin1}
\end{figure}

\index{Machin's formula}
We are going to prove Machin's formula:
\[
\frac{\pi}{4} = 4\tan^{-1} \frac{1}{5} - \tan^{-1} \frac{1}{239}
\]

\begin{proof}
Let $z_1 = 5 + i, z_2 = 239 - i$. The 4 times of the argument of $z_1$ on the right corresponds to the argument of $z_1^4$. We construct the product of,

\begin{align*}
z &= z_1^4z_2 = (5+i)^4(239-i) \\
  &= (25 - 1 + 10i)^2(239 - i) && \text{square of sum} \\
  &= (24^2 - 100 + 480i)(239 - i) && \text{square of sum again} \\
  &= 476 \times 239 + 480 + (480 \times 239 - 476)i && \text{expand} \\
  &= 114244 + 114244i
\end{align*}

The argument of $z$ is exactly $\dfrac{\pi}{4}$.
\end{proof}

\index{Conjugate complex numbers}
This is supposed to be the shortest and most elegant proof of Machin's formula. This proof reveals a geometric property of complex numbers: if a complex number $z = a + bi$ has an argument $\theta$, where $b \ne 0$, then the complex number $a - bi$ has an argument $\tan^{-1}\dfrac{-b}{a} = -\theta$. Let $\overline{z} = a - bi$ be the conjugate of $z$. Thus, dividing by $a + bi$ corresponds to multiplying by $a - bi$ in terms of the angle of rotation. We can conveniently convert division into multiplication using conjugate complex numbers. In particular, since $z\overline{z} = (a + bi)(a - bi) = a^2 + b^2 = |z|^2$, we have:

\[
\frac{1}{z} = \frac{\overline{z}}{z\overline{z}} = \frac{1}{|z|^2}\overline{z}
\]

When the modulus of $z$ is 1, we have $\dfrac{1}{z} = \overline{z}$. For example, for $z = \cos\theta + i\sin\theta$, we immediately know that:

\[
\frac{1}{\cos\theta + i\sin\theta} = \cos\theta - i\sin\theta
\]

All complex numbers on the unit circle satisfy this condition. \cref{qn:trigonometry-of-add} requires us to derive the sum of angles formulas for trigonometric functions using complex number operations.

\subsection{The foundamental theorem of algebra}

When accepting complex numbers, those quadratic equations couldn't be solved before suddenly have solutions. For example, the problem in Cardano's \emph{Ars magna}: two numbers add up to 10 and multiply to 40, that is, $(5 + x)(5 - x) = 40$. Expanding using the difference of squares formula gives $x^2 + 15 = 0$. It has no real solution, but it has two complex roots: $x_{1,2} = \pm i\sqrt{15}$; the polynomial $x^2 + 15$ cannot be factored using real numbers, but it can be factored using complex numbers as $(x + i\sqrt{15})(x - i\sqrt{15})$. Moreover, the three cases that were originally complicated: (1) two distinct real roots, (2) two identical real roots, (3) no real roots, become simple and consistent in complex numbers: any quadratic equation has two complex roots, counting repeated roots as two. Mathematicians are extreme minimalists and perfectionists; no one can resist such an elegant conclusion. What about cubic equations? Quartic equations? And higher degree equations? Descartes discovered a powerful weapon for conquering higher degree equations. He also introduced the notation $x^n$ casually. Before Descartes, people used special terms like \enquote{square} and \enquote{cube} to describe $xx$ and $xxx$, and even had special terms like quartic for \enquote{fourth power} and quintic for \enquote{fifth power}. However, symbols like $xxxx$ and $xxxxx$ were obviously too cumbersome. When Descartes established analytic geometry in 1637, he was the first to introduce notations like $x^3, x^4, x^5$. We see again how important good notation is! In history, the trend of development has been from \enquote{verbal description} $\to$ \enquote{abbreviation} $\to$ \enquote{symbol}, evolving in this direction. Many people are afraid of formulas filled with symbols; memorizing formulas during school is a terrifying memory for most adults. Some people therefore dislike mathematics for life; this is really a misunderstanding and a pity. In fact, mathematics is the least memorization-intensive subject because we can rely on intuition, reason, and aesthetics to derive almost all conclusions. Contrary to many people's feelings, symbols are simpler, easier to understand, and more precise than verbal descriptions. You can compare the verbal description \enquote{the area of the square constructed on one leg of a right triangle plus the area of the square constructed on the other leg equals the area of the square constructed on the hypotenuse} with the algebraic symbol $a^2 + b^2 = c^2$.

\index{Descartes's theorem}
\begin{theorem}[Descartes]
Let $p(x) = a_nx^n + \dotsb + a_1x + a_0$ be a polynomial with $a_n \ne 0$. Then $p(x) = 0$ has a root $x = b$ if and only if $p(x)$ has a factor $x - b$.
\end{theorem}

Descartes's theorem means that if $b$ is a root, then we can factorize the polynomial as $p(x) = (x - b)q(x)$ where the degree of $q(x)$ is less than that of $p(x)$. And this is a necessary and sufficient condition, so the converse is also true. We can conveniently use Descartes's theorem to factorize $x^3 - 1$: clearly, $1$ is a root of the equation $x^3 - 1 = 0$, so $x - 1$ is a factor. Then we use polynomial long division to find:

\[
\polylongdiv{x^3-1}{x-1}
\]

Alternatively, as the sum of the geometric series $1 + x + x^2 + \dotsb + x^{n-1} = \dfrac{x^n - 1}{x - 1}$, we can factorize $x^3 - 1$ as $(x - 1)(x^2 + x + 1)$ without performing polynomial long division.

\begin{proof}
If $x - b$ is a factor of $p(x)$, then $p(x) = (x - b)q(x)$. Substituting $x = b$ gives $p(b) = (b - b)q(b) = 0$, so $b$ is a root.

Conversely, if $x = b$ is a root of $p(x)$, that is, $p(b) = 0$. We can extend the division algorithm with remainder to polynomials. Dividing $p(x)$ by $x - b$, we have $p(x) = (x - b)q(x) + r(x)$, where $q(x)$ is the quotient and $r(x)$ is the remainder, which has a degree less than that of $x - b$. Thus, $r(x)$ can only be a constant term $c$. Substituting $x = b$ gives $0 = p(b) = (b - b)q(b) + c = c$. Therefore, the remainder $c = 0$, which means that $p(x)$ can be divided by $x - b$ without remainder, so $x - b$ is a factor of $p(x)$.
\end{proof}

Descartes's theorem lighted a path for solving polynomial equations: denote the equation by $p(x) = 0$, where $p(x)$ is a polynomial of degree $n$. \emph{if we can} find a root $a$, then factorize the polynomial as $p(x) = (x - a)q(x)$, and then we only need to solve the reduced degree equation $q(x) = 0$. \emph{if we can} keep finding roots and repeat this process, we can completely solve higher degree equations. In 1746, French mathematician d'Alembert noticed that if a complex number $z = a + bi$ is a root of the equation $p(z) = 0$, then its conjugate $\overline{z} = a - bi$ is also a root (see \cref{qn:conjugated-root}). This means that if an equation has one complex root, we can immediately reduce the degree by 2. You may have noticed that we emphasized \enquote{if we can}. Unfortunately, we cannot always find roots in real numbers, for example, $p(x) = x^2 + 15 = 0$. But what if allowing complex numbers? Mathematicians in the 18th century strongly felt that the answer should be \enquote{we always can!}

\index{the foundamental theorem of algebra}
\begin{theorem}[the foundamental theorem of algebra]
Any polynomial equation $p(x) = 0$ has at least one complex root.
\end{theorem}

This theorem has several variant versions, attracting many brilliant minds to prove it. Gauss proved the fundamental theorem of algebra four times in his lifetime using different methods. In 1799, at the age of 22, Gauss proved in his doctoral thesis that any polynomial equation with real coefficients has a complex root. Then he gave two more proofs in 1815 and 1816. In 1849, at the celebration of the 50th anniversary of obtaining his doctorate, Gauss published a fourth proof and extended the coefficients of polynomials to complex numbers. Once we prove that any polynomial equation has at least one complex root, we can use Descartes's theorem to conclude that an $n$-degree polynomial equation has $n$ complex roots (including repeated roots): first find a root $z = a$, then factorize as $q(z) = p(z)/(z - a)$ to get an $n-1$ degree equation, repeat this process to get $n$ roots. The fundamental theorem of algebra can also be stated in terms of factorization: any polynomial can be factored into a product of several linear or quadratic factors. Then using d'Alembert's conclusion, these quadratic factors can be further factored into $(z - a)(z - \overline{a})$, so we can equivalently say: any polynomial can be factored into a product of several linear factors in complex numbers. In undergraduate mathematics courses, you can see various methods for proving the fundamental theorem of algebra, some using Galois theory, some using topology, some using mathematical analysis. Here we give Argand's geometric proof, which is the simplest and most intuitive among all proofs. Before Argand, d'Alembert gave a proof of the fundamental theorem of algebra in 1746. But Gauss in 1799 criticized it had \enquote{serious flaws}, which used the following conclusion without proof:

\index{d'Alembert's lemma}
\begin{lemma}[d'Alembert]
If a non-constant polynomial $p(z)$ is not zero at a complex number $z_0$, then there exists a complex number $z_0'$ in a neighborhood of $z_0$ such that $|p(z_0')| < |p(z_0)|$.
\end{lemma}

Argand's geometric interpretation of complex numbers allowed him to successfully prove this lemma, thus fixing this flaw. The term \enquote{non-constant polynomial} excludes polynomials like $p(z) = 2$, which always takes a constant value. For the term \enquote{neighborhood}, we can intuitively imagine as the area covered by drawing a small circle centered at $z_0$. $|p(z_0)|$ represents the modulus of the complex value taken by the polynomial at the point $z_0$.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/dalambert-lemma}
  \caption{Find $p(z_0 + \Delta z)$ to be smaller than $p(z_0)$ by choosing $\Delta z$ appropriately.}
 \label{fig:dalambert-lemma}
\end{figure}

\begin{proof}
Let the polynomial be $p(z) = a_nz^n + \dotsb + a_1z + a_0$. The value of the polynomial at the complex number $z_0$ is $p(z_0)$, which is a vector with length $|p(z_0)|$. Argand aimed to find a complex number $z_0' = z_0 + \Delta z$ in the neighborhood of $z_0$ such that the value of the polynomial becomes:

\begin{align*}
p(z_0 + \Delta z) &= a_n (z_0 + \Delta z)^n + \dotsb + a_1 (z_0 + \Delta z) + a_0  \\
 & \text{binomial expand each one and collect terms} \\
 &= (a_n z_0^n + \dotsb + a_1 z_0 + a_0) + A_1 \Delta z + A_2 (\Delta z)^2 + \dotsb + A_n (\Delta z)^n \\
 &= p(z_0) + A \Delta z + \epsilon
\end{align*}

As $p(z)$ is not a constant, not all of $A_1, A_2, \dots A_n$ are zero. We find the first non-zero $A_i$, and define $A = A_i (\Delta z)^{i - 1}$, collecting the remaining terms into $\epsilon$. Since $\epsilon$ contains higher-order terms in $(\Delta z)^m$, when $|\Delta z|$ is small enough, we have $|\epsilon| < |A \Delta z|$. Next, Argand chooses a $\Delta z$ such that the vector $A \Delta z$ points in the opposite direction to $p(z_0)$, effectively canceling it out. This is shown in \cref{fig:dalambert-lemma}. Therefore, $|p(z_0 + \Delta z)| < |p(z_0)|$.
\end{proof}

However, Argand's proof of the fundamental theorem of algebra still has a flaw: it relies on the Extreme Value Theorem, which states that the modulus of a complex polynomial attains a minimum value. Argand considered this to be naturally true (treating it as an axiom), but this theorem was later first proven by Bolzano in 1830 for real numbers, and in 1874, Weierstrass proved that it also holds for complex numbers:

\index{extreme value theorem}
\begin{theorem}[Extreme Value Theorem]
A continuous function on a bounded closed set attains its maximum and minimum values.
\end{theorem}

With d'Alembert's lemma and the Extreme Value Theorem, we are going to reconstruct Argand's proof.

\begin{proof}
For any complex polynomial $p(z)$, consider the continuous function $|p(z)|$. When $|z|$ is large, $p(z) \approx a_n z^n$, and the leading term dominates the function value. As $|z|$ increases, the continuous function value $|p(z)|$ will exceed a sufficiently large circle $|z| = R$. Noting that $|z| \leq R$ is a bounded closed set, according to the Extreme Value Theorem, $|p(z)|$ attains its minimum value within it. By the definition of the modulus of a complex number (the length of a vector), this minimum value is $\geq 0$. But if the minimum value is $> 0$, it would contradict d'Alembert's lemma: we can always find a nearby point with a smaller modulus, thus smaller than the minimum value. Therefore, the minimum value can only be 0, which means there exists some $z_0$ such that $|p(z_0)| = 0$, so $p(z_0) = 0$.
\end{proof}

It proves the foundamental theorem of algebra, that is, any polynomial equation has at least one complex root. At this point, some friends may be eager to try solving quartic equations, quintic equations, or even higher degree equations by themselves. Hold on! There are indeed formulas for solving quartic equations, but there is \underdot{generally} no formula for solving equations of degree 5 or higher. Their solutions do exist, but they cannot be expressed using the operations of addition, subtraction, multiplication, division, and taking roots of the coefficients. After Cardano and Ferrari, it took mathematicians 300 years to finally uncover this secret. Italian mathematician Ruffini and Norwegian mathematician Abel successively proved this conclusion\footnote{Ruffini's proof in 1799 had flaws, and Abel first rigorously proved this conclusion in 1823. This theorem is now called the Abel-Ruffini theorem.}. Note that the term \enquote{generally} refers to equations of the form $ax^5 + bx^4 + cx^3 + dx^2 + ex + f = 0$. Special quintic equations do have formula solutions, such as $x^5 - 1 = 0$, and we can even find the method for ruler-and-compass construction of a regular pentagon by solving this equation (see \cref{sec:pentagon-equation}). The problem of which equations are solvable by radicals was completely solved by French mathematician Galois. This theory is called Galois theory.

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/d-alembert}
  \caption{Portrait of d'Alembert by Maurice Quentin de La Tour in 1753, housed in the Louvre Museum.}
 \label{fig:dalembert}
\end{figure}

\index{d'Alembert}
\begin{mdframed}
让・勒朗・达朗贝尔（1717～1783）是法国著名的数学家、物理学家、天文学家。他是一位被遗弃的私生子。这一身世影响了他的一生。达朗贝尔的生父是一位炮兵军官，生母是一位巴黎著名沙龙\footnotemark 的女主人。达朗贝尔是这位交际花诸多风流韵事之一的结果，但他一出生就被生母遗弃在巴黎圣·乐朗教堂的台阶上。他因此得名让·乐朗（以捡到的地方命名）。一家好心的玻璃匠夫妇收养了可怜的孩子，达朗贝尔终身视养母为自己的亲生母亲。

达朗贝尔的生父后来返回巴黎，暗中资助他接受教育。但1726年孩子9岁的时候，他的生父死了。他被送入一所詹森教派的学校。在入学时他的姓氏是达朗伯格（Daremberg），不久后他改名为让·达朗贝尔（Jean dA'lembert）。詹森派学校主要培养神学人才以宣扬教义，但达朗贝尔只对数学感兴趣而不喜欢神学。他接触了笛卡尔的学术思想，虽大开眼界但并不以为然。1735年毕业后，达朗贝尔决心学习法律。他于1738年拿到了律师证书，但接着又改学医学。达朗贝尔不久再次改变了想法，他觉得医学还不如神学，自己的真爱还是数学。达朗贝尔基本上是自学数学，并且从未间断，即使是在准备律师考试期间。

长期的自学既造就了出众的独立思考能力和创造力，也限制了达朗贝尔。他一生不断提出新思想，开拓新方向，却不擅长深入推进、清晰阐述，很快被别人超越。这些新想法的支持者最终变成了达朗贝尔的竞争者。这使得他与其他学者争吵不断，抱怨别人抄袭窃取他的成果。尽管如此，达朗贝尔在数学、物理、天文学上做出了非常杰出的贡献。1739年，22岁的达朗贝尔在巴黎科学院暂露头角，1741年成为科学院正式成员。1743年，他发表了著作《动力学》，其中包括牛顿运动定律新的表述，并提出了今天以他命名的“达朗贝尔原理”。这一原理可以把动力学问题转化为静力学问题处理，为分析力学的创立打下了基础。次年，他成功应用这一原理研究了流体静力学和动力学，并由此开拓了偏微分方程这一数学分支。这使他获得了1747年柏林科学院大奖。达朗贝尔接着把偏微分方程应用到弦振动上，首次给出了波动方程。这一工作引起了欧拉的注意和支持。欧拉很快在偏微分方程上展开研究，超越并取得了硕果。两人的关系逐渐恶化，达朗贝尔忿忿不平，认为欧拉窃取了他的想法。但达朗贝尔的原文混乱不清，难以理解，欧拉干脆另起炉灶，从头推导出了更丰富的结果。达朗贝尔严格对待极限概念，是当时极少数把微分看成是函数极限的数学家，并区分了收敛与发散级数。他还提出了一种判别级数绝对收敛的方法——达朗贝尔判别法，即今天的比值判别法。另外，达朗贝尔在复数的性质、概率论等方面也都有所研究，很早就证明了代数基本定理。1764年，普鲁士大帝腓特烈二世想任命达朗贝尔为柏林科学院院长，但他拒绝了。俄罗斯女皇叶卡捷琳娜二世邀请达朗贝尔教授皇子保罗大公（Grand duke Paul），也被他拒绝了。

达朗贝尔生活的时代正值启蒙运动风起云涌。狄德罗、伏尔泰、卢梭的思想冲击着旧有的神权观念。达朗贝尔也投身到这场轰轰烈烈的变革中。受狄德罗邀请，达朗贝尔参与编写了法国《百科全书》。尽管合同上他只负责数学与天文学，但达朗贝尔热情地编写了广泛的内容，包括哲学、文学、音乐。达朗贝尔的后半生基本终止了数学研究，他把主要精力用来编写百科全书，从事社会活动。1772年，他当选了法兰西科学院终身秘书。但他对自己精力衰退，无法从事数学研究充满了遗憾。1777年，他写信给拉格朗日说\cite{MacTour-dAlembert}：“最遗憾的是，我无力研究我的真爱——数学了。我在文学上的工作——尽管在科学院备受赞扬——只能用来打发无聊的时间。”

特殊的身世冥冥之中影响着他。达朗贝尔终身未婚，他结识了巴黎著名沙龙的女主人勒皮纳斯（Julie de Lespinasse，1732～1776），并坠入爱河。达朗贝尔与养父母感情一直很好，直到1765年他47岁时才因病离开养父母，住到了勒皮纳斯家里。勒皮纳斯小姐于1776年去世后，达朗贝尔发现她还热烈地爱着其他男人。他伤心地搬到了卢浮宫的科学院公寓里\cite{Ronald-2024}。1783，达朗贝尔卒于巴黎。尽管达朗贝尔毕业于教会学校，尽管他在书中公开相信上帝的存在，但在狄德罗的影响下他转向了唯物论的观点。由于生前反对宗教，巴黎市政府拒绝为他举行葬礼。这位科学巨匠孤独地离开了人世。
\end{mdframed}
\footnotetext{法语Salon的音译，原指会客厅。从17世纪起，巴黎的名人（多半是名媛贵妇）常把客厅变成社交场所，组织谈论文化时事。沙龙渐成文艺集会的专称，风靡欧美各国文化界，十九世纪是它的鼎盛时期。}

\index{复数的代数意义}
复数的几何意义给出了直观解释，赋予了复数合法地位。但是另一些数学家坚持认为数作为数学抽象的典范，其形式本身就有意义。还记得范·德·瓦尔登用数偶$(a, b)$来形式化负数么（见第\ref{sec:z-as-pair}节）？数学家哈密尔顿（William Hamilton，1805～1865年）同样用数偶形式化了复数。1831年，哈密尔顿定义复数为一对值$(a, b)$，其运算规则如下：

\begin{itemize}
\item 复数加法：$(a, b) + (c, d) = (a + c, b + d)$
\item 复数乘法：$(a, b) (c, d) = (ac - bd, bc + ad)$
\end{itemize}

这个定义中，完全看不到声名狼藉的$\sqrt{-1}$。普通的实数表示为$(a, 0)$的形式，例如$-1$表示为$(-1, 0)$。虚数$i$表示为$(0, 1)$，我们可以验证$i^2 = -1$：

\[(0, 1)(0, 1) = (0 \times 1 - 1 \times 1, 1 \times 0 + 0 \times 1) = (-1, 0)\]

\cref{qn:pair-arithmetic-rules}要求验证五大定律（加法、乘法交换律、结合律、分配律）对复数都成立。这一定义明确强调了复数是由一对值复合而成的，复数的符号是$\mathbb{C}$，是Complex numbers的首字母。复数$z$的实部记做$Re(z)$，是Real的前两个字母；虚部记做$Im(z)$，是Imaginary的前两个字母。

%% 哈密尔顿简介

\section{$e$的诞生}

\index{复利} \index{数学家!雅各布·伯努利}
%% 英文版以莎士比亚《威尼斯商人》中安东尼奥向夏洛克借钱为例。
尽管阿尔冈图把复数、几何、三角函数联系在了一起，但这还不足以展示复数有多么神奇。真正让复数登堂入室、大放异彩的是另一个传奇常数$e$。但是$e$不像$\pi$那样在古代就被各个文明发现，它隐藏在大自然的背后，支配着生命的繁衍、财富的积累、时间的流逝……直到微积分的风帆乘风破浪开始远航的时候，人们才终于认识了e的庐山真面目。1683年，瑞士数学家雅各布·伯努利（Jacob Bernoulli, 1655～1705）思考了财务上的“复利”问题。所谓复利，又叫做“利滚利”，常见于可怕的高利贷中。比如安东尼奥向夏洛克借了100杜卡特\footnote{安东尼奥和夏洛克是莎士比亚《威尼斯商人》中的人物，杜卡特是威尼斯当时的金币单位。}，每月利息为5\%（俗称五分利，是古代典型的高利贷）。一个月后安东尼奥本息合计要还$100 \times (1 + 5\%) = 105$杜卡特。如果安东尼奥没有还上，到了两个月的时候，此时要还的钱是$100 \times (1 + 5\%) \times (1 + 5\%) = 100 \times (1 + 5\%)^2 = 110.25$杜卡特。注意到第一个月后的利息被加到了本金中，用来计算第二个月应还的钱。因此叫做“利上加利”或“利滚利”。复利是指数增加的，也就是俗称的“指数爆炸”。如果安东尼奥从年初一直到借到年底，那么要还的钱是$100 \times (1 + 5\%)^{12} = 179.59 \approx 180$杜卡特；两年的话就欠下$322.5$杜卡特的债务，已经是原来本金的三倍多了。雅各布·伯努利思考的问题是关于储蓄的，如果存入银行100元，年利是100\%，那么年底时本息合计就得到$200$元。如果每6个月时取出所有本息，然后再次存入银行。假设银行连续计息，6个月时的利息不到100\%，只有50\%。但到年底时共计息两次，所以本息合计$100 \times (1 + \frac{1}{2}\times 100\%)^2 = 225$元。这样比一次性到年底取钱能得到更多。假设每个季度取出所有本息再次存入，那么共计息4次，每次$25\%$，年底获得$100 \times (1 + \frac{1}{4} \times 100\%)^4 \approx 244.14$元。假如每个月都取出再存入银行，到年底获得$100 \times (1 + \frac{1}{12} \times 100\%)^{12} \approx 261.3$元。据此，把年底所得除以本金100元就可以推出\underdot{实际年化}利率\footnote{在银行业，年化利率（Annual Percentage Rate, APR）和\underdot{实际}年化利率（Internal Rate of Return, IRR）是不同的概念。前者是单利计算，后者是复利（利滚利）。}和存取次数$n$之间关系：

\be
(1 + \frac{1}{n})^n
\ee

雅各布·伯努利发现尽管增加存取次数（频率）会增加收入，但并非无限增加。增加的速度越来越缓慢，渐渐趋于一个定值，如\cref{tab:compound-interest}所示。他于是定义了一个常数，它的值是$n$趋向于无穷时的极限：

\begin{table}[ht]
  \caption{复利与存取次数的关系}
  \centering
  \begin{tabular}{|l|l|l|}
    \hline
    间隔 & 次数$n$ & 实际年化利率 \\
    \hline
    年 & 1 & 2 \\
    半年 & 2 & 2.25 \\
    季度 & 4 & 2.4414 \\
    月 & 12 & 2.6130 \\
    天 & 365 & 2.7146 \\
    小时 & 8760 & 2.7181 \\
    \hline
  \end{tabular}
  \label{tab:compound-interest}
\end{table}

\index{e} \index{e的极限定义}
\be
e = \lim_{n \to \infty} (1 + \frac{1}{n})^n
\ee

这就是高中数学课上定义的常数$e$。它是数学史上第一个\underdot{用极限定义}的常数。但是雅各布·伯努利既没有给这个常数起名字，也没有耐心地计算出它的值。他只是利用二项式定理估计了这个常数的范围\cite{MacTour-e}：

\begin{proposition}[雅各布·伯努利]
常数$e$的范围是：\[2 < e < 3\]
\end{proposition}

\begin{proof}
\begin{align*}
e &= \lim_{n \to \infty} (1 + \frac{1}{n})^n \\
  &= 1 + \binom{n}{1}\frac{1}{n} + \binom{n}{2}\frac{1}{n^2} + \dotsb && \text{二项式展开} \\
  &= 1 + \cancel{n}\frac{1}{\cancel{n}} + \frac{n(n-1)}{2!n^2} + \frac{n(n-1)(n-2)}{3!n^3} + \dotsb \\
  &> 1 + 1 = 2
\end{align*}

另一方面
\begin{align*}
e &= 2 + \frac{1}{2!}\frac{n-1}{n} + \frac{1}{3!}\frac{n-1}{n}\frac{n-2}{n} + \dotsb \\
  &\leq 2 + \frac{1}{2} + \frac{1}{2 \cdot 3} + \frac{1}{2 \cdot 3 \cdot 4} + \dotsb && \text{每个}\frac{n-k}{n} < 1 \\
  &< 2 + \frac{1}{2} + \frac{1}{2 \cdot 2} + \frac{1}{2 \cdot 2 \cdot 2} + \dotsb && \text{不等式缩放} \\
  &= 2 + (\frac{1}{2} + \frac{1}{2^2} + \frac{1}{2^3} + \dotsb) \\
  &= 2 + 1 = 3 && \text{等比数列和} \qedhere
\end{align*}
\end{proof}

\index{数学家!约翰·伯努利}
读者朋友也许会问：(1) 以往只说数学家的姓就足够了，为什么这里既有名（雅各布）也有姓（伯努利）？(2) 我记得高中课堂上说$e$是自然对数的底，它和复利有什么关系？这两个问题其实是相关的。雅各布还有一个弟弟名叫约翰·伯努利（见\cref{fig:Bernoulli-brothers}）。后者从1697年开始研究了各种各样的指数函数。在此之前，人们仅仅把对数看成纯粹的数，而不是函数，甚至印刷出版了长长的对数表方便计算。约翰·伯努利从函数的角度把对数和指数联系了起来。

\index{指数函数} \index{对数函数}
\begin{align*}
  y = a^x && x = \log_a y
\end{align*}

这是一对函数与反函数。当$a = e$时，就变成了：

\begin{align*}
  y = e^x && x = \ln y
\end{align*}

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/Bernoulli-brothers}
 \caption{法国画家夏尔・约瑟夫・特拉韦尔创作的《伯努利兄弟讨论数学问题》}
 %% （Charles Joseph Traviers）
 \label{fig:Bernoulli-brothers}
\end{figure}

\index{数学家!纳皮尔} \index{对数}
这样就把$e$的历史一下子向前推进到了1618年，苏格兰数学家约翰·纳皮尔发明了对数（见\cref{fig:napier}），并印出了第一张对数表。巧合的是最早的对数表的底不是10，而是自然对数$e$。当然纳皮尔并没有意识到常数$e$的存在，他只是想解决复杂的乘法计算问题。当时的天文观测和航海经常涉及巨大数字的乘法计算。我们今天知道，在计算$Z = XY$时，如果令$X = a^x, Y = a^y$，那么$Z = a^{x + y}$。所以我们只要在对数表中查到$X$和$Y$分别对应的对数$x$和$y$，把它们相加得$z = x + y$，然后在表中反查到对数$z$对应的数$Z$就可以了。后来英国数学家亨利・布里格斯提醒纳皮尔，改成以10为底的对数会更加方便实用。但当时纳皮尔已经垂垂老矣，无力再次进行巨大的计算以做出这个更改。淡泊名利的布里格斯于是亲自动手制作了以10为底的对数表，并以纳皮尔的名义发表\cite{Amerson-2021}。

\index{墨卡托地图}
从计算效率上来说，对数是一个化时代的发明，是大航海时代的产物。大家一定见过印在纸上的世界地图。把地球的球面不失真地映射到矩形纸上是一个困难的问题，这个问题在数学上是无解的。我们常见的世界地图叫做“墨卡托地图”，是用地理学家杰拉杜斯·墨卡托\footnote{Gerardus Mercator, 1512～1594，佛兰德斯（今比利时）地图绘制者和地理学家。}的名字命名的。墨卡托投影法想象把一张长方形的纸卷成圆筒，然后把透明的地球仪装入这个圆筒，使得赤道刚好和圆柱面相切（见\cref{fig:mercator}）。此时在地球仪球心放一盏灯，在纸上就出现了地图的影子。把这个影子用笔描下来，再把纸展开就得到了墨卡托地图。墨卡托地图能很好地保持方向和形状，但是面积、距离越靠近两极越失真。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/mercator-map}
 \caption{墨卡托映射}
 \label{fig:mercator}
\end{figure}

\index{自然对数}
无独有偶，和杰拉杜斯·墨卡托相同姓氏的德国数学家尼古劳斯·墨卡托于1688年的著作中把以$e$为底的对数命名为“自然对数”。尽管这项工作在雅各布·伯努利之后，但他并不知道$e$的存在和名字。我们要等欧拉来给这个传奇的常数命名。

\subsection{最美公式}

欧拉是约翰·伯努利的学生。当他沿着指数函数——对数函数的方向思考时，发现了一个惊人而又美丽的结果：$e^x$的导数是它本身。

\be
(e^x)' = e^x
\ee

\begin{proof}
根据导数的定义：

\be \label{eq:derive-of-e}
(e^x)' = \lim_{\Delta x \to 0} \frac{e^{x + \Delta x} - e^x}{\Delta x} = \lim_{\Delta x \to 0} \frac{e^xe^{\Delta x} - e^x}{\Delta x} = e^x\lim_{\Delta x \to 0} \frac{e^{\Delta x} - 1}{\Delta x}
\ee

欧拉把雅各布·伯努利对$e$的定义中的$n$取倒数，令$t = \frac{1}{n}$，得：

\be \label{eq:def2-of-e}
e = \lim_{n \to \infty} (1 + \frac{1}{n})^n = \lim_{t \to 0} (1 + t)^{\frac{1}{t}}
\ee

令$u = e^{\Delta x} - 1$，然后利用约翰·伯努利指出的对数函数与指数函数的反函数关系：$\Delta x = \ln (1 + u)$。代入上面的极限中：

\begin{align*}
\lim_{\Delta x \to 0} \frac{e^{\Delta x} - 1}{\Delta x} &= \lim_{u \to 0} \frac{u}{\ln (1 + u)} = \lim_{u \to 0} \frac{1}{\frac{1}{u}\ln (1 + u)} && \text{由} b \ln a = \ln a^b \\
  &= \lim_{u \to 0} \frac{1}{\ln (1 + u)^{\frac{1}{u}}} && \text{使用\cref{eq:def2-of-e}} \\
  &= \lim_{u \to 0} \frac{1}{\ln e} = 1 && \text{由} \ln e = 1
\end{align*}
将此结果带回\cref{eq:derive-of-e}就证明了$(e^x)' = e^x$
\end{proof}

这意味着二阶导数也是它本身，因为：$(e^x)'' = ((e^x)')' = (e^x)' = e^x$。不论对$e^x$求多少阶导数，得到的结果总是$e^x$。欧拉马上把这个结果代入麦克劳林公式（见\cref{eq:maclaurin}）得到了著名的级数展开式：

\begin{align*}
e^x &= f(0) + \frac{f'(0)}{1!}x + \frac{f''(0)}{2!}x^2 + \dotsb + \frac{f^{(n)}(0)}{n!}x^n + \dotsb \\
  &= e^0 + \frac{e^0}{1!}x + \frac{e^{0}}{2!}x^2 + \dotsb + \frac{e^0}{n!}x^n + \dotsb && \text{各阶导数}f^{(n)}(x) = e^x \\
  &= 1 + \frac{x}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \dotsb
\end{align*}

\index{e的级数定义}
有了展开式，欧拉就可以做出雅各布·伯努利不曾做到的东西了，求$e$的近似值。欧拉把$x = 1$代入展开式得到了著名的$e$的级数定义：

\be
e = 1 + \frac{1}{1!} + \frac{1}{2!} + \frac{1}{3!} + \dotsb
\ee

欧拉一口气算出了18位小数：$e = 2.718281828459045235$。这意味着他把级数的前20项计算出来，加到了一起。这一年是1731年，欧拉非常高兴地写信给好朋友哥德巴赫分享了这些成果。在信中，他给这个常数起了名字：“$e$”。很多人以为这是欧拉名字Euler的首字母，也有人说这是指数exponential的首字母，其实都不是。欧拉习惯使用元音字母a、e、i、o、u命名常量，碰巧a在之前已经被用过了，所以欧拉使用了第二个元音字母e。
%% 但这一巧合使得今天人们把$e$叫做“欧拉常数”以纪念他。This is incorrect. Euler's constant is \gamma in the sum of harmonic series:
%% \( \sum_{n \leq x} \frac{1}{n} = \ln x + \gamma + O(\frac{1}{x}) \)

欧拉在信中明确指出了$e$是$n$趋近无穷时$(1 + \dfrac{1}{n})^n$的极限，并且等于1加上所有阶乘的倒数。他继续研究并于1748年发表了更加神奇优美的结果。欧拉把$e^x$级数展开中的奇数项和偶数项分开，并联想到著名的三角函数级数展开：

\begin{align*}
\sin x &= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \dotsb \\
\cos x &= 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \dotsb
\end{align*}

欧拉发现了复数和$e$的关系，把自变量$ix$代入到级数展开中：

\begin{align*}
e^{ix} &= 1 + (ix) + \frac{(ix)^2}{2!} + \frac{(ix)^3}{3!} + \frac{(ix)^4}{4!} + \dotsb \\
  &= 1 + ix - \frac{x^2}{2!} - i\frac{x^3}{3!} + \frac{x^4}{4!} + \dotsb && i^2 = -1\\
  &= (1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \dotsb) + i(x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \dotsb ) \\
  &= \cos x + i\sin x
\end{align*}

\index{欧拉公式}
这就是高中数学课上的公式$e^{i\theta} = \cos \theta + i\sin \theta$。它右侧的几何意义极为明显：就是阿尔冈图上的模为1、幅角为$\theta$的复数。这样就赋予了$re^{i\theta}$几何意义，它是模为$r$、幅角为$\theta$的复数。进一步结合棣莫弗公式（见\cref{eq:de-Moivre}）得：

\[
e^{in\theta} = \cos n\theta + i\sin n\theta = (\cos \theta + i\sin \theta)^n = (e^{i\theta})^n
\]

单位圆上幅角为$\theta$的向量的$n$次方相当于把向量旋转$n\theta$角。欧拉把特殊值$\theta = \pi$代入，得到了一个迷人的结果：

\be \label{eq:euler}
e^{i\pi} = \cos \pi + i\sin \pi = -1
\ee

人们把$e^{i\pi} + 1 = 0$叫做欧拉公式。许多人认为这是宇宙间最美的公式，它把两个著名的无理数$e, \pi$，虚数单位$i$，加法单位元0，乘法单位元1神奇地联系在了一起。

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.45]{img/Euler}
  \caption{莱昂哈德·欧拉}
 \label{fig:Euler}
\end{figure}

\index{数学家!欧拉}
\begin{mdframed}
我们对欧拉的介绍主要来自大数学家安德烈·韦依的名著《数论：从汉谟拉比到勒让德的历史导引》。

莱昂哈德·欧拉生于1707年。那一年著名数学家雅各布·伯努利去世了，他的弟弟约翰·伯努利成为了瑞士巴塞尔大学的继任者。欧拉的父亲名叫保罗·欧拉，是巴塞尔附近的教区神父。他在巴塞尔大学学习神学的时候旁听过雅各布·伯努利的课程。他本来希望儿子也从事神职。小欧拉13岁进入巴塞尔大学神学院，主修哲学和法律，但很快就展现出在数学方面的天赋。每周六下午他都和约翰·伯努利学习数学。约翰·伯努利有两个孩子，尼古拉和丹尼尔。欧拉和他们成了好朋友，他也是约翰最得意的弟子。欧拉晚年时经常会想起他在星期六向伯努利学习数学时的情景。

三位君主在欧拉的一生中起到了决定性作用：彼得大帝、腓特烈大帝、叶卡捷琳娜大帝。彼得大帝年轻时去欧洲游历，回国后他决定兴建圣彼得堡，并仿照西方的样子建立科学院。1725年他去世后，科学院的计划得以继续。尼古拉和丹尼尔都被邀请加盟。遗憾的是，尼古拉于次年死于急性阑尾炎。于是，欧拉收到了圣彼得堡科学院的邀请。这一年他还不满20岁，刚刚凭借一篇关于造船的论文获奖，可他这辈子从未见过远洋轮船。他想离开家乡见见世面，于是欣然接受了。

欧拉从巴塞尔出发，顺莱茵河而下到达美因茨，然后步行前往吕贝克。在途中，他拜访了哲学家克里斯蒂安·沃尔夫。沃尔夫告诉欧拉，他被一位完全不懂哲学的国王赶出了柏林，流落至此。沃尔夫是莱布尼茨哲学的追随者，一心痴迷于莱布尼茨的单子论，而欧拉显然对此不以为然。离开吕贝克后，欧拉坐船到达圣彼得堡。

遵照彼得大帝的遗愿，科学院资金雄厚，拥有一流的图书馆。成员享有相当大的学术自由，主要目标就是开展一流的研究，发表高质量的论文，维护圣彼得堡科学院在国际学术上的崇高声誉。同时科学院向君主和政府提供顾问。尽管有些任务让学者们不快，不过毕竟国家出了巨资养活研究院，欧拉对此也完全理解。1727年欧拉到达圣彼得堡的时候，时局发生了变化。新沙皇中止了所有新任命。由于欧拉的获奖论文是关于造船的，他暂时被安排到俄罗斯海军部门。不久他获得了科学院的职位，头衔是“副教授”。1733年，丹尼尔·伯努利返回了瑞士巴塞尔，欧拉成了他的继任者，薪资大为改善。他开始安家置业，和一位瑞士侨民画家格赛尔的女儿结婚。次年大儿子约翰·阿尔伯特·欧拉出生了，他后来成了父亲的学术合作者、科学院的核心成员。欧拉和妻子一共生了13个孩子，但只有三个男孩活了下来。在俄国的14年中，他在分析学、数论和力学方面作了大量出色的工作。

欧拉在圣彼得堡安顿下来后，立即展现出超人的创造力，让所有人大吃一惊。另一方面，丹尼尔·伯努利的离去又让他倍感孤独。1735年，欧拉生了一场重病，以至右眼失明。后世我们看到的欧拉肖像，要么是侧面像（例如\cref{fig:Euler}），要么右眼部分被阴影遮住。毫无疑问，他已成为科学院最宝贵的成员，声誉如日中天。然而，欧洲政坛高层发生的两件大事，彻底打破了他平静的生活。1740年，沙皇皇后叶卡捷琳娜去世，随后摄政时期来临，政局动荡不安，科学院的存续似乎岌岌可危。恰逢此时，腓特烈二世从父亲（就是那位赶走哲学家沃尔夫的国王）那里继承了普鲁士王权\footnotemark。他雄心勃勃地着手建立柏林科学院，网罗全欧洲顶级的科学家。自然，欧拉在腓特烈大帝的名单上。欧拉收到了来自普鲁士国王的慷慨邀请，柏林优厚的待遇对比圣彼得堡混乱的时局，欧拉动心了。欧拉一家经过三周漫长的波罗的海航行，他自称是全家唯一没有晕船的人。终于1741年7月，他来到了腓特烈大帝面前。欧拉在这里愉快地渡过了25年。在柏林期间他的研究内容更加广泛，涉及行星运动、刚体运动、热力学、弹道学、人口学，这些工作和他的数学研究相互推动。欧拉这个时期在微分方程、曲面微分几何以及其它数学领域的研究都是开创性的。

搬到柏林丝毫没有减少欧拉在圣彼得堡科学院发表论文的数量。圣彼得堡不仅保留了他的科学院会员身份，还照常为他保留退休金。欧拉当然要让他的前同事觉得这笔钱花得值。在“惊人的25年”（欧拉曾孙语）中，欧拉寄给圣彼得堡超过100篇论文，在柏林发表了127篇论文，涵盖数学的方方面面，包括数学分析、造船、天文等等，他在巴黎科学院的论文获得大奖。随着时光流逝，腓特烈大帝和欧拉相互间的光环逐渐退去了。比起欧拉给科学院带来的巨大荣耀，腓特烈更钟情于法国文艺。他试图邀请达朗贝尔来柏林出任科学院院长，欧拉的自尊心受到了伤害。尽管达朗贝尔后来拒绝了国王的邀请，但欧拉在1763年起就考虑再次返回俄罗斯了。

此时的俄罗斯时局又发生了动荡。1762年，沙皇的德国妻子夺取政权，成为了叶卡捷琳娜二世。她决定重振圣彼得堡科学院，于是为欧拉打开了大门。对顶级人才的争抢持续了三年。终于，1766年，俄罗斯驻柏林大使受命让欧拉自己按照意愿撰写聘任合同（想怎么写就怎么写）。腓特烈大帝意识到问题的严重，想方设法阻挠。但太晚了，他不敢得罪这位女皇。欧拉被迎回圣彼得堡。途径波兰时，女王昔日的情人斯坦尼斯劳斯国王几乎按照君主的礼仪接待了欧拉。但不幸的是，欧拉左眼的视力也开始下降了。在1770年写给数学家拉格朗日的信中，他抱歉自己不能阅读，只能靠别人代为朗读，然后自己心算验证结果。1771年欧拉接受了眼科手术，起初效果很好，但很快感染了。欧拉不幸完全失明\cite{Weil-1983}。正如失聪没有阻止贝多芬的音乐创作一样，失明也同样没有阻止欧拉的数学探索\cite{HanXueTao2009}。在书记员的帮助下，欧拉在多个领域的研究其实变得更加高产了。在1775年，他平均每周就完成一篇数学论文。欧拉一生中有一半著作都是在双目完全失明后口述完成的。

欧拉渊博的知识，无穷无尽的创作精力和空前丰富的著作，都是令人惊叹不已的。他从19岁开始发表论文，直到76岁，半个多世纪写下了浩如烟海的书籍和论文。几乎每一个数学领域都可以看到欧拉的名字。欧拉是科学史上最多产的一位数学家，一生发表论文共计856篇，专著31部。这还不包括1771年圣彼得堡火灾中失去的一部分。这一记录直到20世纪才由匈牙利数学家保罗·埃尔德什打破（见第\ref{sec:Erdos}节）。欧拉的多产并不是偶然的，他有着惊人的记忆力，还可以进行复杂的心算。法国物理学家阿拉戈说“欧拉计算时就像人在呼吸、鹰在翱翔一样轻松”。欧拉可以在任何不良的环境中工作，他常常抱着孩子在膝上完成论文，也不顾孩子在旁边喧哗。

欧拉的著作中既有难度很高的专著，也有专为普通大众所写的读物。他还特意为青少年写过一本书——《给德国公主的信》。并为非数学专业的读者写了一本初等代数教程，这本书至今仍在印刷。欧拉特别重视表达的清晰易懂。我们今天很多熟知的数学符号，都是欧拉精心选用的，例如$\pi$（1736年），虚数单位$i$（1777年），$e$（1748年），三角函数$\sin$和$\cos$（1748年），$tg$（1753年），$\Delta x$（1755年），求和$\sum$（1755年），表示函数的$f(x)$（1734年）等\cite{HanXueTao2009}。

1783年9月18日，欧拉与朋友们吃饭。那天天王星刚发现不久，欧拉列出计算天王星轨道的要领。晚餐后，欧拉一边喝着茶，一边和小孙女玩耍，突然之间，烟斗从他手中掉了下来。他说了一声：“我的烟斗”，并弯腰去捡，结果再也没有站起来，他喃喃地说了一句：“我死了……”就这样“停止了计算和生命”（法国数学家孔多塞语）。
\end{mdframed}
\footnotetext{需要区分两种称号：腓特烈二世（大帝）、神圣罗马帝国腓特烈二世（大帝）。后者为十二世纪皇帝（1194～1250年），而前者是普鲁士国王（1740～1786年），腓特烈二世是其正式名号，而“腓特烈大帝”是后世对其历史地位的尊称。}

\subsection{我依故我}

\index{等角螺线} \index{对数螺线}
尽管没能看到欧拉的成果，但雅各布·伯努利在生前预见了$e^x$的诞生。1638年笛卡尔发现了一种神奇的螺线，名叫“等角螺线”，也叫做“对数螺线”（见\cref{fig:decartes-equiangular-spiral}）。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.5]{img/descartesspiral}
 \caption{笛卡尔发现等角螺线}
 \label{fig:decartes-equiangular-spiral}
\end{figure}

顾名思义，笛卡尔发现螺线上任何一点的切线，与切点到原点连线的夹角是固定不变的，如\cref{fig:equiangular}所示\cite{Descartes-1638}。托里拆利\footnote{意大利数学家、物理学家。他首次通过实验测量了大气压。}对等角螺线进行了独立研究，他发现如果令$r$是原点$O$到螺线上一点$P$的距离，$\theta$是$OP$与横轴的夹角，如\cref{fig:decartes-equiangular-spiral}左侧。则随着$\theta$的增加$r$按照几何级数（即等比数列的方式）增加。这种定义是典型的极坐标定义，如果令曲线上一点为$(r, \theta)$，则托里拆利的定义相当于：

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.4]{img/equiangular}
 \caption{“等角”的含义}
 \label{fig:equiangular}
\end{figure}

\[
r = ka^\theta
\]

\index{神奇螺线}
其中$k$和$a$是常数。这样$\theta$增加2倍，$r$就增加到$r^2$；$\theta$增加3倍，$r$就增加到$r^3$……\cref{qn:equiangular}要求证明托里拆利的定义和笛卡尔的定义是等价的。雅各布·伯努利对这种螺线进行了深入的研究，他发现了很多极有趣的性质。最令人震惊的是，不管怎么变化，缩放、求渐屈线、渐伸线、垂足线，结果总是不变——又得到了同一形状的螺线。1692年，他把这种迷人的螺线命名为“神奇螺线”（spiral mirabilis），并决定死后在墓碑上刻下这个螺线，如\cref{fig:bernoulli-tomb}所示\cite{MacTour-Equiangular}。他留下了著名的拉丁文墓志铭：Eadem mutata resurgo，中文译作“虽经沧海，我依故我”\cite{Maor-2010}。碑铭内容为：

\begin{figure}[htbp]
 \centering
 \subcaptionbox{雅各布·伯努利的墓碑\label{fig:bernoulli-tomb}}{\includegraphics[scale=0.4]{img/bernoulli-tomb}}
 \subcaptionbox{墓碑下方的螺线\label{fig:bernoulli-epitaph}}{\includegraphics[scale=0.4]{img/bernoulli-epitaph}}
 \caption{雅各布·伯努利的墓志铭：Eadem mutata resurgo\cite{MacTour-Bernoulli-tomb}}
\end{figure}

\begin{mdframed}
\begin{verse}
雅各布·伯努利（1654-1705）\\
‌无与伦比的数学家‌\\
巴塞尔大学教授（18年）\\
巴黎科学院与柏林科学院院士\\
以学术著作闻名于世\\
虽罹患慢性疾病，却始终神志清明\\
于主历1705年8月16日安息，享年50岁又7个月\\
静候复活之日‌纪念者‌\\
朱迪丝·斯图潘努斯（20年结发之妻）\\
及其二子\\
为深切怀念的丈夫与父亲，立此碑铭
\end{verse}
\end{mdframed}

\index{阿基米德螺线}
但遗憾的是，石匠错误地把等角螺线刻成了“阿基米德螺线”，如\cref{fig:bernoulli-epitaph}所示。这两个螺线有什么区别呢？阿基米德螺线每圈间的间距是相等的，而等角螺线的间距是等比数列（见\cref{fig:equiangular-spiral}）。如果用极坐标表示，阿基米德螺线的方程是$r = a\theta$。匀速转动阿基米德螺线，则它与坐标轴的交点将匀速平移。那么为什么这种螺线又叫做“对数螺线”呢？从反函数的角度看：

\begin{figure}[htbp]
 \centering
  \begin{tikzpicture}[scale=0.1]
      % 定义对数螺线参数：r = a*e^(b*θ)
      \def\a{0.1}   % 控制螺线起点大小
      \def\b{0.2}   % 控制螺线旋紧程度（值越小越疏松）
      \def\turns{5} % 螺线旋转圈数

      % 绘制对数螺线
      \draw[
          line width=1pt,
          blue!80!black,
          domain=0:{2*pi*\turns},  % 角度范围（从0到指定圈数）
          samples=360,             % 采样点数（越多越平滑）
          variable=\t
      ] plot (
          {exp(\b*\t)*\a*cos(\t r)},  % x坐标（极坐标转直角坐标）
          {exp(\b*\t)*\a*sin(\t r)}   % y坐标（r表示弧度）
      );

      % 可选项：添加原点标记
      \fill[red] (0,0) circle (2pt) node[below right] {O};
  \end{tikzpicture}
  \caption{等角螺线也叫对数螺线}
  \label{fig:equiangular-spiral}
\end{figure}

\begin{align*}
r = ka^\theta && \theta = \log_{a} \frac{r}{k}
\end{align*}

\index{换底公式} \index{极角} \index{极径}
螺线上一点的极角与极径成对数关系。因此法国数学家瓦里尼翁\footnote{Pierre Varignon，1654～1722年。曾系统整理和传播牛顿、莱布尼茨的微积分思想，并在力学中引入 “力矩”等重要概念。}把这种螺线叫做对数螺线。我们在高中学习过换底公式：$\log_a x = \dfrac{\ln x}{\ln a}$（\cref{qn:change-base}要求证明此公式），于是：

\begin{align*}
\theta &= \log_a \frac{r}{k} = \frac{\ln \frac{r}{k}}{\ln a} && \text{换底公式}\\
\ln \frac{r}{k} &= \theta(\ln a) && \text{两边同乘以}\ln a \\
\frac{r}{k} &= e^{\theta \ln a} = e^{b\theta} && \text{两边取}e\text{的指数，令}b = \ln a \\
r &= k e^{b\theta}
\end{align*}

这样就得到了以$e$为底的等角螺线极坐标方程。这个公式是雅各布·伯努利不曾想象到的，但它可以轻松揭示为何“我依故我”。

\begin{proposition}[雅各布·伯努利]
等角螺线缩放后形状不变。
\end{proposition}

\begin{proof}
利用等角螺线极坐标方程$r = ke^{b\theta}$，把极径缩放$a$倍得：

\begin{align*}
r' &= (ak)e^{b\theta} = e^{\ln a} k e^{b\theta} \\
   &= ke^{b\theta}e^{\ln a} = k e^{b\theta + \ln a} \\
   &= ke^{b(\theta + \theta_0)} && \text{令} \theta_0 = \frac{\ln a}{b}
\end{align*}

这相当于把极角旋转了$\theta_0$，而螺线旋转后的形状是不变的。
\end{proof}

\cref{qn:exp-from-fixed-point}要求利用“我依故我”的性质找出$e^x$的展开式。等角螺线还经由$e$和复数产生了联系。

\begin{proposition}
任何复数$z = a + bi, b \ne 0$构成的等比数列$z, z^2, z^3, \dotsc$都分布在等角螺线上。
\end{proposition}

\begin{proof}
用欧拉公式把$z$化成$z = c(\cos\theta_0 + i\sin\theta_0)$的形式，其中$c = \sqrt{a^2 + b^2}, \theta_0 = \tan^{-1} \dfrac{b}{a}$。因为$b \ne 0$，所以$\theta_0 \ne 0$。利用棣莫弗公式，等比数列的第$n$项为：

\[
z^n = c^n(\cos\theta_0 + i\sin\theta_0)^n = c^n(\cos n\theta + i\sin n\theta)
\]

我们接下来把$z^n$用极坐标表示，它的极角是$\theta = n\theta_0$，极径是：

\begin{align*}
r &= c^n = e^{\ln(c^n)} && \text{换底} \\
  &= e^{n\ln c} && \text{对数计算规则} \\
  &= e^{\frac{\theta}{\theta_0}\ln c} = ke^{b\theta} && \text{其中}k=1, b = \frac{\ln c}{\theta_0} \text{，满足等角螺线极坐标方程} \qedhere
\end{align*}
\end{proof}

等角螺线出现在自然界的各个角落，这并非偶然。棣莫弗利用待定系数法找出了斐波那契数列的通项公式，它在$n$很大时满足等角螺线方程（见附录\ref{app:fibonacci-formula}）。而我们知道自然界很多生长现象满足斐波那契公式，例如鹦鹉螺的螺壳生长（见\cref{fig:nautilus}），西兰花、向日葵花絮的生长，因此呈现出等角螺线的形状。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.4]{img/nautilus}
 \caption{鹦鹉螺壳呈等角螺线}
 \label{fig:nautilus}
\end{figure}

复数和此前人们认识的数大相径庭。不管是自然数、有理数、无理数，它们都在数轴上有确定的位置。复数却跳出了数轴，来到了复平面。此前的数都是一元的，大小确定，在数轴上的位置确定。复数却是二元的，无论使用实部、虚部表示，模、幅角表示，都需要两个量来确定一个复数。两个复数通常没法比较大小，我们只能比较它们的模的大小。尽管这样奇特，复数彼此之间，复数与实数之间仍然可以计算，并且满足此前的运算定律，包括加法、乘法的交换律，结合率，乘法对加法的分配律。数轴上两个实数$a, b$间的距离是$|a - b|$，复平面上两个复数$z_1 = x_1 + y_1i, z_2 = x_2 + y_2i$间的距离是$|z_1 - z_2|$。这是因为：

\[
|z_1 - z_2| = |(x_1 - x_2) + (y_1 - y_2)i| = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2}
\]

\index{复数模的可乘性}
这的确是对应的笛卡尔平面上两点$(x_1, y_1)$与$(x_2, y_2)$间的距离。实数的绝对值满足可乘性，即：$|ab| = |a||b|$；复数的模也满足可乘性$|z_1z_2| = |z_1||z_2|$，这是因为（也可用欧拉公式证明）：

\begin{align*}
|z_1z_2|^2 &= |(x_1 + y_1i)(x_2 + y_2i)|^2 = |(x_1x_2 - y_1y_2) + (x_1y_2 + y_1x_2)i|^2 \\
  &= (x_1x_2 - y_1y_2)^2 + (x_1y_2 + y_1x_2)^2 = (x_1^2 + y_1^2)(x_2^2 + y_2^2) && (*) \\
  &= |z_1|^2|z_2|^2
\end{align*}

其中(*)是古希腊数学家丢番图最早在研究数论中的平方和时发现的\footnote{丢番图《算术》，卷三，问题19写道：65可以用两种方法分解为平方和$7^2 + 4^2$与$8^2 + 1^2$，这是因为65是13与5的乘积，而它们也都是平方和（$13 = 3^2 + 2^2, 5 = 2^2 + 1^2$）。}。复数打开了一个新世界的大门。它威力无穷，不仅解决了以前的难题，也提出了人们意想不到的问题。

\section{正五边形}
\label{sec:pentagon-equation} \index{正五边形尺规作图}

复数是解方程的利器。我们这里展示如何用复数解决正五边形尺规作图的问题。欧拉公式与棣莫弗公式结合赋予了方程$x^n = 1$以新的几何意义。若复数$z = re^{i\theta}$是方程的一个根，即：

\[
1 = z^n = (re^{i\theta})^n = r^ne^{in\theta} = r^n(\cos n\theta + i\sin n\theta)
\]

我们由此得出模$r = 1$，幅角$n\theta = 2k\pi$，其中$k$是整数（这是由于$\sin 2k\pi = 0, \cos 2k\pi = 1$），这样$z$的幅角$\theta = \dfrac{2k\pi}{n}$。于是根可以表示为：$z = 1e^{\frac{2k\pi}{n}i} = e^{\frac{2k\pi}{n}i}$。这在几何上表示复平面单位圆上的$n$个点，如\cref{fig:heptagon-z}所示。

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.33]{img/heptagon-z}
  \caption{$x^n = 1$的解在复平面上是正$n$边形的$n$个顶点。}
 \label{fig:heptagon-z}
\end{figure}

圆是周期性的，$e^{\frac{2k\pi}{n}}$转动整数圈后与自己重合。$k = 0, 1, 2, \dotsc, n-1$时，$e^{\frac{2k\pi}{n}i}$是$n$个不同的根。它们的幅角依此是$0, \theta, 2\theta, \dotsc, (n-1)\theta$，把单位圆平均分成了$n$等份。因此方程$x^n = 1$叫做“分圆方程”（cyclotomic equation）。把复平面上这个$n$个根连接起来就构成了正$n$边形。

例如最简单的正多边形是正三角形$n = 3$。$x^3 = 1$有三个复根$1, e^{\frac{2\pi}{3}i}, e^{\frac{4\pi}{3}i} = e^{-\frac{2\pi}{3}i}$。其中：

\[
e^{\pm \frac{2\pi}{3}i} = \cos (\pm \frac{2\pi}{3}) + i \sin (\pm \frac{2\pi}{3}) = -\frac{1}{2} \pm \frac{\sqrt{3}}{2}i
\]

我们可以验证$x^3 - 1 = (x - 1)(x^2 + x + 1)$，二次方程$x^2 + x + 1$的两个根的确是$\dfrac{-1 \pm i\sqrt{3}}{2}$。我们也可以用二项式展开直接验证：

\[
\left(-\frac{1}{2} \pm \frac{\sqrt{3}}{2}i\right)^3 = -\frac{1}{8} \pm \frac{3\sqrt{3}}{8}i + \frac{9}{8} \mp \frac{3\sqrt{3}}{8}i = \frac{9-1}{8} = 1
\]

这三个根构成了单位圆内接正三角形，如\cref{fig:3rd-root-of-1}所示。

\begin{figure}[htbp]
\centering
\begin{tikzpicture}[scale=2.5]
 \draw[step=.5cm, gray, very thin] (-1.2,-1.2) grid (1.2,1.2);
 \draw[->] (-1.25,0) -- (1.25,0) coordinate (x axis)
   (0,-1.25) -- (0,1.25) coordinate (y axis);
 \draw (0,0) circle (1cm);
 \draw[->, very thick] (0, 0) edge node[below=2pt] {$e^0 = 1$} (1, 0)
   (0, 0) edge node[above] {$e^{\frac{2\pi}{3}i} = \dfrac{-1 + i\sqrt{3}}{2}$} (120:1cm)
   (0, 0) edge node[below] {$e^{\frac{4\pi}{3}i} = \dfrac{-1 - i\sqrt{3}}{2}$} (-120:1cm);
\end{tikzpicture}
\caption{$x^3 = 1$的三个复数根}
\label{fig:3rd-root-of-1}
\end{figure}

类似地，五次分圆方程$x^5 = 1$的五个根均匀分布在复平面的单位圆上，从而构成一个正五边形，如\cref{fig:pentagon-z}所示。只要求出图中的根$x$，则复平面上$x$到1的距离$|x-1|$就是正五边形的边长。五次方程$x^5 - 1 = 0$显然有一个根是$x = 1$。根据笛卡尔定理，$x-1$是多项式$x^5 - 1$的一个因式。利用多项式长除法（或逆向用等比数列求和）可以进行因式分解：

\[
x^5 - 1 = (x - 1)(x^4 + x^3 + x^2 + x + 1)
\]

接下来解四次方程$x^4 + x^3 + x^2 + x + 1 = 0$就可以找出\cref{fig:pentagon-z}中的剩余4个顶点。这个四次方程很有特点，只要除以$x^2$就变成一个对称的形式（0不是方程的解，因此$x \ne 0$）：

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.3]{img/pentagon-z}
  \caption{$x^5 = 1$的根在复平面上是正五边形的顶点。}
 \label{fig:pentagon-z}
\end{figure}

\[
x^2 + x + 1 + \frac{1}{x} + \frac{1}{x^2} = 0
\]

把$x + \dfrac{1}{x}$看成一个整体，并注意到：$(x + \dfrac{1}{x})^2 = x^2 + \dfrac{1}{x^2} + 2$。上面的方程可以化为：

\[
(x + \frac{1}{x})^2 + (x + \frac{1}{x}) - 1 = 0
\]

令$y = x + \dfrac{1}{x}$，上述方程就是$y^2 + y - 1 = 0$。解此二次方程得到$y_{1,2} = \dfrac{-1 \pm \sqrt{5}}{2}$。利用欧拉公式，若$x = e^{i\theta}$，则$\dfrac{1}{x} = x^{-1} = e^{-i\theta}$，所以$x, \dfrac{1}{x}$是共轭复数（见\cref{fig:pentagon-z}中的$x$与$x^4 = x^{-1}$）。若$x = a + bi$，则$\dfrac{1}{x} = a - bi$，所以$x + \dfrac{1}{x} = 2a$。同理\cref{fig:pentagon-z}中的$x^2, x^3$也是一对共轭复数，分别对应$e^{\frac{4\pi}{5}i}, e^{\frac{6\pi}{5}i} = e^{-\frac{4\pi}{5}i}$。这样我们就判断出：

\begin{align*}
x + \dfrac{1}{x} &= \dfrac{-1 + \sqrt{5}}{2} \\
x^2 + x^3 &= \dfrac{-1 - \sqrt{5}}{2}
\end{align*}

其中第一个方程本质上是二次方程$x^2 - \dfrac{\sqrt{5} - 1}{2}x + 1 = 0$，利用求根公式得：

\[x_{1, 2} = \dfrac{\frac{\sqrt{5} - 1}{2} \pm i\sqrt{\frac{5 + \sqrt{5}}{2}}}{2}
\]

它们是一对共轭复数，分别对应\cref{fig:pentagon-z}中的$x, x^4 = x^{-1}$。接下来计算\cref{fig:pentagon-z}中的模$|x - 1|$就知道正五边形的边长了。

\[
x - 1 = \frac{\frac{\sqrt{5} - 1}{2} + i\sqrt{\frac{5 + \sqrt{5}}{2}}}{2} - 1 = \frac{\sqrt{5} - 5}{4} + i\frac{\sqrt{\frac{5 + \sqrt{5}}{2}}}{2}
\]

因此：

\[
|x - 1| = \sqrt{\left(\frac{\sqrt{5} - 5}{4}\right)^2 + \left(\frac{\sqrt{\frac{5 + \sqrt{5}}{2}}}{2}\right)^2} = \frac{\sqrt{10 - 2\sqrt{5}}}{2}
\]

于是作正五边形的问题就转化为：任给长度为1的线段，如何做出长度为$s = \dfrac{\sqrt{10 - 2\sqrt{5}}}{2}$的线段。为了简化问题，我们先求线段$2s$。我们的思路是作一个直角三角形，使其斜边为$2s$。这个三角形的两个直角边不可能都是有理数，否则根据勾股定理，斜边不可能是$\sqrt{10 - 2\sqrt{5}}$这种根号下还有根号的形式。设两个直角边分别是$\sqrt{5} - a$和$b$，然后用勾股定理：

\[
(\sqrt{5} - a)^2 + b^2 = 5 + a^2 + b^2 - 2a\sqrt{5} = 10 - 2\sqrt{5}
\]

利用待定系数法，$2a = 2$，所以$a = 1$；代入$5 + a^2 + b^2 = 6 + b^2 = 10$，所以$b = 2$。这样直角边为$\sqrt{5} - 1, 2$的直角三角形的斜边是$2s$。将三角形缩小一半，直角边为$\dfrac{\sqrt{5} - 1}{2}, 1$的直角三角形的斜边就是$s$。另一方面，由于$5 = 4 + 1 = 2^2 + 1^2$，这样就可以用1，2为直角边，作出斜边长$\sqrt{5}$的直角三角形。缩小一半的直角三角形其斜边就是$\dfrac{\sqrt{5}}{2}$，然后再截去$\dfrac{1}{2}$就得到了$\dfrac{\sqrt{5} - 1}{2}$。\cref{fig:pentagon-cons}展示了尺规作正五边形的步骤。最后用求得的边长依次截单位圆五次就得到了正五边形。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/pentagon-cons}
 \caption{作正五边形}
 \label{fig:pentagon-cons}
\end{figure}

\begin{Exercise}[label={ex:complex}]
\Question{给出解二次方程$x^2 - px = q$的几何解释。\label{qn:geometric-quadratic}}

\Question{根据代数基本定理，三次方程有三个复数根，卡尔达诺公式给出了方程$x^3 = 6x + 9$的一个根$x_1 = 3$，试求出方程的另外两个根。}

\Question{利用邦贝利的方法和卡尔达诺公式，可求出三次方程$x^3 = 15x + 4$的一个根$x_1 = 4$，试求出方程的另外两个根。}

\Question{计算规则$\sqrt{ab} = \sqrt{a}\sqrt{b}$在复数下是否成立？如果成立请证明之，如果不成立应怎样挽救？\label{qn:sqrt-of-product}}

\Question{证明任何复数代表的向量乘以$i$相当于向左转$90\degree$。\label{qn:mul-i}}

\Question{验证复数的共轭满足这样的运算规则：$\overline{a + b} = \overline{a} + \overline{b}$，$\overline{ab} = \overline{a} \cdot \overline{b}$, $\overline{z^n} = (\overline{z})^n$，并据此证明达朗贝尔的发现：若$z$是方程$p(z) = 0$的根，其共轭$\overline{z}$也是方程的根。\label{qn:conjugated-root}}

\Question{验证哈密尔顿的复数数偶表示满足五大运算定律。\label{qn:pair-arithmetic-rules}}

\Question{利用对数函数与指数函数的反函数关系证明换底公式$\log_a x = \dfrac{\log_b x}{\log_b a}$。\label{qn:change-base}}

\Question{*利用等角螺线的极坐标方程$r = ke^{b\theta}$证明笛卡尔指出的等角性质：螺线的切线和极径夹角$\Psi$不变（见\cref{fig:equiangular}）提示：如\cref{fig:tagent-to-r}所示，极径$r$旋转过一个小角度$\Delta \theta$，极径增加了$\Delta r$。小圆弧$AC$长$r\Delta \theta$，它与割线$AB$，极径的增量近似组成一个直角三角形$ACB$。当$\Delta \theta \to 0$时，点$A, B$趋向重合，割线$AB$趋近于切线。\label{qn:equiangular}

  \begin{center}
    \includegraphics[scale=0.33]{img/tagent-to-r}
    \captionof{figure}{极径旋转小角度$\Delta \theta$}
    \label{fig:tagent-to-r}
  \end{center}
}

\Question{*雅各布·伯努利赞美的“虽经沧海，我依故我”也形象地描绘了求导不变$(e^x)' = e^x$的性质，现代数学家这样定义函数$f(x) = e^x$：(1) 导数不变$f'(x) = f(x)$，(2) 函数值$f(0) = 1$。试利用这个定义导出$e^x$的展开式。提示：待定系数法及$(x^n)' = nx^{n-1}$（见命题\ref{thm:derivation-of-power-of-x}）。\label{qn:exp-from-fixed-point}}

\Question{*雅各布·伯努利距离发现$e^x$几乎只差一步。在计算复利时，如果年利率不是100\%，而是$x$，当$n \to \infty$时的实际年化收益率是什么？它的级数展开是什么？}

\Question{利用复数推导三角函数的和角公式：$\tan(\theta_1 + \theta_2), \sin(\theta_1 + \theta_2), \cos(\theta_1 + \theta_2)$，提示：复数乘法。\label{qn:trigonometry-of-add}}

\end{Exercise}

\begin{Answer}[ref={ex:complex}]
\Question{给出解二次方程$x^2 - px = q$的几何解释。

\vspace{2mm}
\begin{center}
 \includegraphics[scale=0.5]{img/quadratic3}
 \captionof{figure}{左侧：从正方形$x^2$中切去矩形$px$；右侧：白色面积相等，$q = (x - \dfrac{p}{2})^2 - (\dfrac{p}{2})^2$。}
\end{center}
}

\Question{根据代数基本定理，三次方程有三个复数根，卡尔达诺公式给出了方程$x^3 = 6x + 9$的一个根$x_1 = 3$，试求出方程的另外两个根。

\vspace{2mm}
对多项式$x^3 - 6x - 9$因式分解。由笛卡尔定理，$x - 3$是一个因子。方法一，用多项式长除法求

\[
\polylongdiv{x^3-6x-9}{x-3}
\]

得$x^2 + 3x + 3$。

方法二，用待定系数法

\begin{align*}
x^3 - 6x - 9 &= (x - 3)(x^2 + ax + b) \\
  &= x^3 + ax^2 + bx - 3x^2 - 3ax - 3b \\
  &= x^3 + (a - 3)x^2 + (b - 3a)x - 3b
\end{align*}

得$a = 3, b = 3$。接下来解二次方程$x^2 + 3x + 3$得另外两个根$x_{2, 3} = \dfrac{-3 \pm i\sqrt{3}}{2}$
}

\Question{利用邦贝利的方法和卡尔达诺公式，可求出三次方程$x^3 = 15x + 4$的一个根$x_1 = 4$，试求出方程的另外两个根。

\vspace{2mm}
如上题，对多项式$x^3 - 15x - 4$因式分解。由笛卡尔定理，$x - 4$是一个因子。用多项式长除法求

\[
\polylongdiv{x^3-15x-4}{x-4}
\]

或用待定系数法

\begin{align*}
x^3 - 15x - 4 &= (x - 4)(x^2 + ax + b) \\
  &= x^3 + ax^2 + bx - 4x^2 - 4ax - 4b \\
  &= x^3 + (a - 4)x^2 + (b - 4a)x - 4b
\end{align*}

得$a = 4, b = 1$。解二次方程$x^2 + 4x + 1$得另外两个根$x_{2, 3} = -2 \pm \sqrt{3}$
}

\Question{计算规则$\sqrt{ab} = \sqrt{a}\sqrt{b}$在复数下是否成立？如果成立请证明之，如果不成立应怎样挽救？

\vspace{2mm}
不成立，否则就会出现
\[
ab = \sqrt{a^2b^2} = \sqrt{(-a^2)(-b^2)} = \sqrt{-a^2}\sqrt{-b^2} = (ai)(bi)=-ab
\]
当$ab \ne 0$时就会出现矛盾。在复数下，我们要么像欧拉那样，认为$\sqrt{a}$表示$b^2 = a$，即$\pm\sqrt{a}$。要么令$z^2 = ab, x^2 = a, y^2=b$，使得$z^2 = x^2y^2 = (xy)^2$。例如:

\[
36 = 4 \times 9 = (-4)\times(-9) = (2i)^2(3i)^2 = (2i \times 3i)^2 = (-6)^2 = 36
\]
}

\Question{证明任何复数代表的向量乘以$i$相当于向左转$90\degree$。

\begin{proof}
考虑复数$z = a + bi$。若$a = 0, b \ne 0$，则$z = bi$, $zi = -b$。若$b > 0$则向量从虚轴正方向转向实轴负方向，即左转90度；若$b < 0$，则向量从虚轴负方向转向实轴正方向，也是左转90度。

若$a \ne 0, b = 0$，则$z = a, zi = ai$。若$a > 0$则向量从实轴正方向转向虚轴正方向，左转90度；若$a < 0$，则向量从实轴负方向转向虚轴负方向，也是左转90度。

若$ab \ne 0$，$zi = (a + bi)i = ai - b$，令$\theta = arg(z)，\psi = arg(zi)$，有：

\[
\tan \theta \tan \psi = (b/a)(-a/b) = -1
\]

故$\psi = \theta + \dfrac{\pi}{2}$，左转了90度。
\end{proof}
}

\Question{验证复数的共轭满足这样的运算规则：$\overline{a + b} = \overline{a} + \overline{b}$，$\overline{ab} = \overline{a} \cdot \overline{b}$, $\overline{z^n} = (\overline{z})^n$，并据此证明达朗贝尔的发现：若$z$是方程$p(z) = 0$的根，其共轭$\overline{z}$也是方程的根。

\begin{proof}
和的共轭：
    \begin{align*}
    \overline{a + b} &= \overline{p + qi + r + si} && \text{令}a = p + qi, b = r + si \\
      &= \overline{p + r + (q + s)i} = p + r - (q + s)i &&\text{共轭的定义} \\
      &= p - qi + r - si = \overline{a} + \overline{b}
    \end{align*}
积的共轭：
    \begin{align*}
    \overline{ab} &= \overline{(p + qi)(r + si)} \\
      &= \overline{pr - qs + (ps + qr)i} = pr - qs - (ps + qr)i
    \end{align*}
共轭的积：
    \begin{align*}
    \overline{a} \cdot \overline{b} &= (p - qi)(r - si) = pr - qs - (ps + qr)i \\
      &= \overline{ab}
    \end{align*}
令$b = a$带入积的共轭，并重复$n$次即得到$\overline{a^n} = (\overline{a})^n$。

若$z$是方程$p(x) = a_nx^n + \dotsb + a_1 x + a_0 = 0$的根，带入$z$有：

\begin{align*}
0 &= a_nz^n + \dotsb + a_1 z + a_0 \\
\overline{0}  &= \overline{a_nz^n + \dotsb + a_1 z + a_0} && \text{取共轭}\\
0 &= \overline{a_nz^n} + \dotsb + \overline{a_1 z} + \overline{a_0} && \text{和的共轭}\\
  &= \overline{a_n}\overline{z^n} + \dotsb + \overline{a_1}\overline{z} + \overline{a_0} && \text{积的共轭}\\
  &= \overline{a_n}(\overline{z})^n + \dotsb + \overline{a_1}\overline{z} + \overline{a_0} && \text{幂的共轭}\\
  &= a_n(\overline{z})^n + \dotsb + a_1\overline{z} + a_0 && \text{实数的共轭是本身} \\
  &= p(\overline{z}) && \qedhere
\end{align*}
\end{proof}
}

\Question{验证哈密尔顿的复数数偶表示满足五大运算定律。

\begin{proof}
加法交换律：
\begin{align*}
(a, b) + (c, d) &= (a + c, b + d) && \text{数偶加法} \\
  &= (c + a, d + b) && \text{通常的加法交换律} \\
  &= (c, d) + (a, b) && \text{反向用数偶加法}
\end{align*}

乘法交换律：
\begin{align*}
(a, b)(c, d) &= (ac - bd, bc + ad) && \text{数偶乘法} \\
  &= (ca - db, cb + da) && \text{通常的乘法交换律} \\
  &= (c, d)(a, b) && \text{反向用数偶乘法}
\end{align*}

加法结合律：
\begin{align*}
(a, b) + (c, d) + (e, f) &= (a + c, b + d) + (e, f) \\
  &= (a + c + e, b + d + f) \\
  &= (a + (c + e), b + (d + f)) && \text{通常的加法结合律} \\
  &= (a, b), (c + e, d + f) \\
  &= (a, b) + [(c, d) + (e, f)] && \text{反向用数偶加法}
\end{align*}

乘法结合律：
\begin{align*}
(a, b)(c, d)(e, f) &= (ac - bd, ad + bc)(e, f) \\
  &= ((ac - bd)e - (ad + bc)f, (ac - bd)f + (ad + bc)e) \\
  &= (ace - bde - adf - bcf, acf - bdf + ade + bce) \\
\text{另一方面} \\
(a, b)[(c, d)(e, f)] &= (a, b)(ce - df, cf + de)) \\
  &= (a(ce - df) - b(cf + de), a(cf + de) + b(ce - df)) \\
  &= (ace - adf - bcf - bde, acf + ade + bce - bdf) \\
  &= (ace - bde - adf - bcf, acf - bdf + ade + bce) \\
  &= (a, b)(c, d)(e, f)
\end{align*}

（左侧）分配律：
\begin{align*}
(a, b)[(c, d) + (e, f)] &= (a, b)(c + e, d + f) \\
  &= (a(c + e) - b(d + f), a(d + f) + b(c + e)) \\
  &= (ac + ae - bd - bf, ad + af + bc + be) \\
  &= (ac - bd + (ae - bf), ad + bc + (af + be)) \\
  &= (ac - bd, ad + bc) + (ae - bf, af + be) \\
  &= (a, b)(c, d) + (a, b)(e, f)
\end{align*}
再由乘法交换律可证明右侧分配律。
\end{proof}
}

\Question{利用对数函数与指数函数的反函数关系证明换底公式。

  \begin{proof}
    \begin{align*}
      y &= \log_a x && a \ne 1 \\
      a^y &= x && \text{指数与对数的反函数关系} \\
      log_b (a^y) &= log_b x && \text{两边取以}b\text{为底的对数} \\
      y log_b a &= log_b x && \text{对数运算法则} \\
      y &= \frac{log_b x}{log_b a} && a \ne 1\text{故分母非0} \qedhere
    \end{align*}
  \end{proof}
}

\Question{*利用等角螺线的极坐标方程$r = ke^{b\theta}$证明笛卡尔指出的等角性质：螺线的切线和极径夹角$\Psi$不变（见\cref{fig:equiangular}）

  \begin{center}
    \includegraphics[scale=0.33]{img/tagent-to-r}
    \captionof{figure}{极径旋转小角度$\Delta \theta$}
    \label{fig:tagent-to-ra}
  \end{center}

  \begin{proof}
如\cref{fig:tagent-to-ra}所示，极径$r$旋转过一个小角度$\Delta \theta$，极径增加了$\Delta r$。小圆弧$AC$长$r\Delta \theta$，它与割线$AB$，极径的增量近似组成一个直角三角形$ACB$。当$\Delta \theta \to 0$时，点$A, B$趋向重合，割线$AB$趋近于切线。角$ABC = \Psi - \Delta \theta$

\begin{align*}
  \tan \Psi &= \lim_{\Delta \theta \to 0} \tan (\Psi - \Delta \theta) = \lim_{\Delta \theta \to 0} \tan \angle ABC \\
  &= \lim_{\Delta \theta \to 0} \frac{r\Delta \theta}{\Delta r} = \lim_{\Delta \theta \to 0} \frac{r}{\frac{\Delta r}{\Delta \theta}} \\
  &= \frac{r}{\lim_{\Delta \theta \to 0} \dfrac{\Delta r}{\Delta \theta}} = \frac{r}{r'} = \frac{ke^{b\theta}}{(ke^{b\theta})'} && \text{代入}r = ke^{b\theta} \\
  &= \frac{ke^{b\theta}}{kbe^{b\theta}} = \frac{1}{b} && (e^{bx})' = be^{bx}
\end{align*}
是一个不依赖于$\theta$的常量，这就证明了螺线的等角性质。
  \end{proof}
}

\Question{*雅各布·伯努利赞美的“虽经沧海，我依故我”也形象地描绘了求导不变$(e^x)' = e^x$的性质，现代数学家这样定义函数$f(x) = e^x$：(1) 导数不变$f'(x) = f(x)$，(2) 函数值$f(0) = 1$。试利用这个定义导出$e^x$的展开式。

\vspace{2mm}
设展开式为$f(x) = a_0 + a_1 x + a_2 x^2 + \dotsb$。由$f(0) = 1$推出：$f(0) = a_0 = 1$。求导并利用$f'(x) = f(x)$有：
\begin{align*}
f'(x) &= a_1 + 2a_2x + 3a_3x^2 + \dotsb + na_nx^{n-1} + \dotsb = f(x) \\
      &= 1 + a_1x + a_2x^2 + \dotsb + a_{n-1}x^{n-1} + \dotsb
\end{align*}
由待定系数法得：
\begin{align*}
a_1 &= 1\\
a_2 &= \frac{a_1}{2} = \frac{1}{2}\\
a_3 &= \frac{a_2}{3} = \frac{a_1}{3 \cdot 2} = \frac{1}{3!}\\
\dotso\\
a_n &= \frac{a_{n-1}}{n} = \frac{a_{n-2}}{n(n-1)} = \dotsb = \frac{1}{n!} \\
\dotso
\end{align*}

故展开式为：
\begin{align*}
e^x &= f(x) = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \dotsb + \frac{x^n}{n!} + \dotsb
\end{align*}
}

\Question{*雅各布·伯努利距离发现$e^x$几乎只差一步。在计算复利时，如果年利率不是100\%，而是$x$，当$n \to \infty$时的实际年化收益率是什么？它的级数展开是什么？

\vspace{2mm}
\begin{align*}
\lim_{n \to \infty} (1 + \frac{x}{n})^n &= \lim_{n \to \infty} (1 + \frac{x}{n})^{\frac{n}{x}x} && \text{其中} x \ne 0 \\
  &= [\lim_{n' \to \infty} (1 + \frac{1}{n'})^{n'}]^x && \text{令} n' = \frac{n}{x} \\
  &= e^x
\end{align*}

利用广义二项式展开：
\begin{align*}
e^x &= \lim_{n \to \infty} (1 + \frac{x}{n})^n \\
  &= \lim_{n \to \infty} (1 + \binom{n}{1}\frac{x}{n} + \binom{n}{2}\frac{x^2}{n^2} + \dotsb \\
  &= \lim_{n \to \infty} (1 + x + \frac{n(n-1)}{2!}\frac{x^2}{n^2} + \dotsb \\
  &= \lim_{n \to \infty} (1 + x + \frac{x^2}{2!}(1-\frac{1}{n}) + \frac{x^3}{3!}(1 - \frac{1}{n})(1 - \frac{2}{n}) + \dotsb \\
  &= 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \dotsb
\end{align*}
}

\Question{利用复数推导三角函数的和角公式：$\tan(\theta_1 + \theta_2), \sin(\theta_1 + \theta_2), \cos(\theta_1 + \theta_2)$。

\vspace{2mm}

考虑两个复数$z_1 = a_1 + b_1i, z_2 = a_2 + b_2i$，它们的幅角分别为：$\theta_1 = \tan^{-1} \dfrac{b_1}{a_1}, \theta_2 = \tan^{-1} \dfrac{b_2}{a_2}$（忽略实部为0的情况），模为$r_1 = \sqrt{a_1^2 + b_1^2}, r_2 = \sqrt{a_2^2 + b_2^2}$。这两个复数的乘积是：

\[
z_1z_2 = (a_1 + b_1i)(a_2 + b_2i) = a_1a_2 - b_1b_2 + (a_1b_2 + b_1a_2)i
\]

根据复数的几何意义，幅角$arg(z_1z_2) = \theta_1 + \theta_2$, 模$|z_1z_2|= r_1r_2$。

\begin{align*}
\tan(\theta_1 + \theta_2) &= \tan(arg(z_1z_2)) = \frac{a_1b_2 + b_1a_2}{a_1a_2 - b_1b_2} && \text{忽略分母为0的情况} \\
  &= \dfrac{\dfrac{b_2}{a_2} + \dfrac{b_1}{a_1}}{1 - \dfrac{b_1}{a_1}\dfrac{b_2}{a_2}} && \text{上下同除以}a_1a_2 \\
  &= \frac{\tan\theta_2 + \tan\theta_1}{1 - \tan\theta_1 \tan\theta_2}
\end{align*}

类似地，通过$\sin(\theta_1 + \theta_2) = \dfrac{a_1b_2 + b_1a_2}{r_1r_2}$可以推出正弦、余弦的和角公式。

\begin{align*}
\sin(\theta_1 + \theta_2) &= \sin(arg(z_1z_2)) = \frac{a_1b_2 + b_1a_2}{r_1r_2} && \text{忽略分母为0的情况} \\
  &= \frac{a_1}{r_1}\frac{b_2}{r_2} + \frac{b_1}{r_1}\frac{a_2}{r_2} \\
  &= \cos\theta_1 \sin\theta_2 + \sin\theta_1 \cos\theta_2
\end{align*}

\begin{align*}
\cos(\theta_1 + \theta_2) &= \cos(arg(z_1z_2)) = \frac{a_1a_2 - b_1b_2}{r_1r_2} && \text{忽略分母为0的情况} \\
  &= \frac{a_1}{r_1}\frac{a_2}{r_2} - \frac{b_1}{r_1}\frac{b_2}{r_2} \\
  &= \cos\theta_1 \cos\theta_2 - \sin\theta_1 \sin\theta_2
\end{align*}
}

\end{Answer}

\ifx\wholebook\relax
\chapter{Algebraic numbers}
\else
\section{Algebraic numbers}
\fi

%% For English version, use Kronecker's saying ``God made the natural numbers, the rest is the work of man.''
\epigraph{Mathematics constructs an ideal world where everything is perfect and yet true.}{Bertrand Russell}
%% "The meaning of the world is the separation of wish and fact. Wish is a force as applied to thinking beings, to realize something. A fulfilled wish is a union of wish and fact. The meaning of the whole world is the separation and the union of fact and wish". [9.4.3]
%%  Hao Wang’s supplemental biography of Gödel, A Logical Journey, MIT Press, 1996.

\label{sec:FLT-4} \index{费马大定理!n=4}
著名的费马大定理断言当$n \geq 3$时，$x^n + y^n = z^n$没有正整数解。尽管费马“抱怨”页边太窄，写不下他的证明，但他的确后来给出了$n=4$时$x^4 + y^4 = z^4$无解的证明。并且他还在这个过程中发展出了自己非常自豪的“无穷递降法”（infinite descent）。在此后的200年间，数学家们一直沿着这条路摸索费马大定理的证明\citepage[40-42页]{Edward-1977}。当$n = 4$时，费马发现他只需要证明如下结论就足够了\citepage[247页]{Hardy2009}。

\begin{lemma}
方程$x^4 + y^4 = z^2$没有正整数解。
\end{lemma}

的确，如果$x^4 + y^4 = u^4$有解，那么令$z = u^2$，则$x^4 + y^4 = z^2$也有解。这个引理是费马大定理$n = 4$时的充分条件。

\begin{proof}
用反证法，假设$x^4 + y^4 = z^2$有正整数解。费马进一步假设，$x, y, z$彼此互素。否则，若任何两个含有公约数$d \ne 1$，则第三个也含有这个因子（见\cref{qn:xyz-coprime}），可以从方程中约去$d$。$x^2, y^2, z$是一组勾股数，根据欧几里得引理\ref{thm:pythagoras-triples}，它们可以表示为：

\begin{align*}
x^2 &= 2mn \\
y^2 &= m^2 - n^2 \\
z &= m^2 + n^2
\end{align*}

其中$m > n$，互素且奇偶不同。上面的第二个等式可以变形为：$y^2 + n^2 = m^2$。由于$m, n$互素，所以$y, n, m$也是一组勾股数。其中$m$是奇数，$y$是奇数，$n$是偶数。再次用欧几里得引理：

\begin{align*}
n &= 2ab \\
y &= a^2 - b^2 \\
m &= a^2 + b^2
\end{align*}

其中$a > b$，互素且奇偶不同。代入$x^2 = 2mn = 4ab(a^2 + b^2)$，这说明$ab(a^2 + b^2)$是一个平方数。但$ab$与$a^2 + b^2$互素（任何素数$p$如果整除$ab$，则要么$p$整除$a$，要么整除$b$。但因为$a, b$互素，所以$p$不同时整除$a, b$，因此$p$不整除$a^2 + b^2$），所以它们也都是平方数(见\cref{qn:coprime-product-as-square})。令$a^2 + b^2 = Z^2$。因为$a, b$互素，若$ab$是平方数，则$a, b$也都是平方数。令$a = X^2, b= Y^2$，则$X^4 + Y^4 = a^2 + b^2 = Z^2$。

现在比较$X^4 + Y^4 = Z^2$与原方程$x^4 + y^4 = z^2$。它们形式一样，但：
\[
Z < Z^2 = a^2 + b^2 = m < m^2 + n^2 = z
\]

这样就能不断获得越来越小的正整数$z$，但这是不可能的。
\end{proof}

\index{无穷递降法}
这就是无穷递降法的思路，它是一种反证法。从原来的形式$f(x)$推出同样的形式$f(X)$，但正整数$x > X > 0$。由于从任何有限的正整数开始，都不可能产生无穷递降的正整数序列，这样就可以推翻假设。\cref{fig:infinite-descent}形象地描述了无穷递降法。螺丝还有$x$圈没有拧进地面，用螺丝刀拧一阵后，还有$X$圈没有拧进地面。圈数$x > X > 0$是正整数，但螺纹的圈数有限，不可能无限拧下去。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/infinite-descent}
 \caption{无穷递降法的比喻}
 \label{fig:infinite-descent}
\end{figure}

\section{费马大定理与复数}
\index{费马大定理!n=3}
费马之后大约一个世纪，欧拉在1755年写给哥德巴赫的信中，给出了$n = 3$时$x^3 + y^3 = z^3$没有正整数解的证明\citepage[239页]{Weil-1983}。尽管这个证明有缺陷，但欧拉本质上使用了复数攻克问题。欧拉的证明有2页，读者朋友们只要集中精神就能跟上思路，看懂并欣赏这个证明。

\begin{proof}
欧拉也使用了无穷递降法，假设$x^3 + y^3 = z^3$有解。和费马一样，他假设$x, y, z$彼此互素，并且其中有且仅有一个是偶数。首先是$x, y$是奇数，$z$是偶数的情况。此时$x \pm y$都是偶数，设$x + y = 2p, x - y = 2q$，解此二元一次方程组得：$x = p + q, y = p - q$。因为$x, y$都是奇数，所以$p, q$奇偶不同。并且因为$x, y$互素，所以$p, q$也互素（因为$p, q$的公约数$d$也整除$p \pm q$，所以也是$x, y$的公约数）。进一步，可以认为$p, q > 0$（否则交换$x, y$），这样：

\begin{align*}
z^3 &= x^3 + y^3 = (x + y)(x^2 - xy + y^2) && \text{因式分解} \\
  &= 2p[(p + q)^2 - (p + q)(p - q) + (p - q)^2] && \text{代入}x, y = p \pm q \\
  &= 2p(p^2 + q^2 + \cancel{2pq} - p^2 + q^2 + p^2 + q^2 - \cancel{2pq}) \\
  &= 2p(p^2 + 3q^2) && \text{(*)}
\end{align*}

当$z$是奇数，$x, y$一奇一偶时，欧拉也得到了同样的结果。不妨设$x$是偶数，首先移项：

\begin{align*}
x^3 &= z^3 - y^3 = (z - y)(z^2 + zy + y^2) && \text{因式分解} \\
  &= 2p[(q + p)^2 + (q + p)(q - p) + (q - p)^2] && \text{令}z \pm y = 2p, 2q \text{则}z, y = q \pm p \\
  &= 2p(p^2 + 3q^2) && \text{(**)}
\end{align*}

同样这里$p, q$是互素的正整数且奇偶不同\footnote{明显$x = -y$，是方程$x^3+ y^3 = 0$的一个解，所以$x + y$是一个因式。通过多项式长除可完成$x^3 + y^3$的因式分解。同样$z = y$，是方程$z^3 - y^3 = 0$的一个解，所以$z - y$是一个因式。通过多项式长除可完成$z^3 - y^3$的因式分解。}。接下来欧拉的思路是要证明$2p$和$p^2 + 3q^2$互素，因此它们各自是一个立方数（与费马证明$n = 4$时的思路相似）。但很可惜，它们\underdot{可能}有公因子3。例如3整除$p$，但不整除$q$，仍然满足$p, q$互素，但3此时会整除$p^2 + 3q^2$。于是欧拉分两种情况进行证明：(a) 3不能整除$p$；(b) 3整除$p$。其中(b)经过处理后可以变成(a)。接下来欧拉考虑(a)，因为互素，所以$2p$和$p^2 + 3q^2$都是立方数。

现在轮到复数登场了。$i$能帮助我们把熟悉的平方差公式扩展到平方和：$a^2 + b^2 = a^2 - (-b^2) = (a + ib)(a - ib)$。这样就可以对$p^2 + 3q^2$因式分解了：

\[
p^2 + 3q^2 = (p + i\sqrt{3}q)(p - i\sqrt{3}q) = \text{立方数}
\]

接下来的做法和邦贝利类似，$p \pm i\sqrt{3}q$的乘积是立方数，它们各自是一个立方数，形如$a \pm i\sqrt{3}b$：

\begin{align*}
p + i\sqrt{3}q &= (a + i\sqrt{3}b)^3 \\
  &= a^3 + 3a^2bi\sqrt{3} + 3ab^2(-3) + b^3(-3)i\sqrt{3} && \text{二项式展开} \\
  &= a^3 - 9ab^2 + (3a^2b - 3b^3)i\sqrt{3}
\end{align*}

用待定系数法有：

\begin{align} \label{eq:Euler-gap}
p &= a^3 - 9ab^2       & q &= 3a^2b - 3b^3 \\
  &= a(a - 3b)(a + 3b) &   &= 3b(a - b)(a + b)
\end{align}

由于$p, q$互素，所以$a, b$也互素（因为任何$a, b$的公因子也是$p, q$的公因子）并且奇偶相反（否则$p, q$将都是偶数）。由于$2p$也是立方数，所以：

\[
2p = 2a(a - 3b)(a + 3b) = \text{立方数}
\]

注意到$2a, a \pm 3b$的公因子也必然是$a$和$3b$的公因子，但$a, b$互素，所以这个公因子只可能是3。但如果3整除$a$，则3也整除$p$，这与情况(a)的预设不符。这样分析下来，$2a, a \pm 3b$是彼此互素的，它们也必然都是立方数。令$2a = Z^3, a - 3b = X^3, a+ 3b = Y^3$，于是：

\[
X^3 + Y^3 = a - \cancel{3b} + a + \cancel{3b} = 2a = Z^3
\]

这样欧拉就从最初的方程$x^3 + y^3 = z^3$得到了同一形式的方程$X^3 + Y^3 = Z^3$。接下来比较$z, Z$之间的大小。$X^3Y^3Z^3 = 2a(a - 3b)(a + 3b) = 2p$，由式(*)和(**)，如果$z$是偶数，则$X^3Y^3Z^3$整除$z^3$；如果$x$是偶数，则它整除$x^3$。两种情况下都有$X^3Y^3Z^3 < z^3$。如果$Z > 0$则$Z < z$；如果$Z < 0$，可以通过移项把它交换到左边，例如$X^3 + (-Z)^3 = (-Y)^3$，使得$-Y > 0$，然后把$-Y$重新命名为$Z$。经过这样的处理就得到正整数$Z < z$。使用无穷递降法就证明了情况(a)。

最后证明情况(b)。若3整除$p$，设$p = 3s$，因为$p, q$互素，所以3不能整除$q$。这样
\[
2p(p^2 + 3q^2) = 2(3s)[(3s)^2 + 3q^2] = 3^2\cdot 2s(3s^2 + q^2) = \text{立方数}
\]

容易看出$3^2\cdot 2s$和$(3s^2 + q^2)$互素，所以它们各自是一个立方数。复用(a)中的结论\cref{eq:Euler-gap}，有：

\begin{align*}
q &= a(a - 3b)(a + 3b)  &  s = 3b(a - b)(a + b)
\end{align*}

其中$a, b$互素且奇偶相反。因为$3^2\cdot 2s$是立方数，而$3^2\cdot 2 \cdot 3b(a - b)(a + b) = 3^3 \cdot 2b(a - b)(a + b)$，所以$2b(a - b)(a + b)$是立方数。又由于$a, b$互素且奇偶相反，所以$2b, a \pm b$彼此互素，它们每一个都是立方数。令$2b = X^3, a - b = Y^3, a + b = Z^3$，有：

\[
X^3 + Y^3 = 2b + a - b = a + b = Z^3
\]

后面的证明就和(a)一样了：通过正整数$Z < z$得到无穷递降，导出矛盾。
\end{proof}

但欧拉的证明有一处缺陷，问题出现在\cref{eq:Euler-gap}这一步。我们屡次说因为$p, q$互素，它们的乘积$pq$是一个平方数，所以它们每个都是平方数；它们的乘积$pq$是立方数，所以每个都是立方数；它们的乘积$pq$是$n$次方数，所以每个都是$n$次方数。这个结论对于整数没有问题，因为算术基本定理保证了\underdot{唯一分解}（见\cref{qn:coprime-product-as-square}）。但是欧拉一旦把它推广到复数：$(p + i\sqrt{3}q)(p - i\sqrt{3}q)$是立方数，则$p \pm i\sqrt{3}q$一定是立方数么？这个立方数会不会有别的分解方式？这个问题本质上是问：算术基本定理（唯一分解）对复数成立么？有一个坏消息和一个好消息。好消息是，欧拉证明中的特殊情形是正确的，有办法补救；坏消息是，算术基本定理在复数上一般不成立，例如这两个反例：

\begin{align*}
4 &= 2 \times 2 = (1 + i\sqrt{3})(1 - i\sqrt{3}) & 6 &= 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})
\end{align*}

其中2, 3是素数，我们后面会证明$1 \pm i\sqrt{3}, 1 \pm i\sqrt{5}$也是“素数”!以事后诸葛亮的角度看，欧拉在1755年写信给哥德巴赫的时候并没有意识到这个问题，但使用他在1747年给出的一个方法可以证明如下结论：

\begin{lemma}[欧拉]
如果$a^2 + 3b^2$是一个立方数，其中$a, b$互素，则存在整数$p, q$使得$a + b\sqrt{-3} = (p + q\sqrt{-3})^3$。
\end{lemma}

\section{理想数}

1847年，在费马大定理的历史上出现了戏剧性的一幕。3月1日，数学家拉梅（Lamé，他在1839年证明了费马大定理$n = 7$时成立，见\cref{fig:Lame}）在法国科学院兴奋地宣布，他找到了证明费马大定理的方法！他雄心勃勃准备近期发表完整的证明，从而终结这个困扰了数学家200多年的难题。拉梅在科学院透露了他的证明概要。像欧拉一样，他大胆地使用复数作为武器来对$x^n + y^n$进行因式分解。对于分圆方程$z^n = 1$，如果$r$是一个复数根，则：

\be \label{eq:Lame-decomposition}
x^n + y^n = (x + y)(x + ry)(x + r^2y)\dotsm(x + r^{n-1}y)
\ee

其中$n$是奇数。拉梅也许是这样推理的：根据欧拉公式和棣莫弗公式，令$r = \cos \dfrac{2\pi}{n} + i\sin \dfrac{2\pi}{n}$，则方程$X^n - 1 = 0$有$n$个不同的复数根$1, r, r^2, \dotsc, r^{n-1}$，因而多项式$X^n - 1$可因式分解为$X^n - 1 = (X - 1)(X - r)(X - r^2)\dotsm(X - r^{n-1})$。令$X = -\dfrac{x}{y}$，然后两边同乘以$-y^n$就得到了\cref{eq:Lame-decomposition}。接下来拉梅打算证明，如果$x, y$互素，则所有因子$x + y, x + ry, \dotsc, x + r^{n-1}y$彼此互素。而如果$x^n + y^n = z^n$，即这些互素因子的乘积是一个$n$次方数，则每个因子也必然是$n$次方数。由此可以构造出无穷递降的正整数，从而推翻假设，完成证明。

\begin{figure}[htbp]
 \centering
 \subcaptionbox{拉梅\label{fig:Lame}}{\includegraphics[scale=0.4]{img/lame}}
 \subcaptionbox{柯西\label{fig:Cauchy}}{\includegraphics[scale=0.4]{img/Cauchy}}
 \caption{拉梅与柯西}
\end{figure}

在科学院成员狐疑与惊讶的眼神中，拉梅看了一眼台下的数学家刘维尔（见\cref{fig:Liouville}）说，我不能独占这个荣誉。在几个月前的一次闲谈中，刘维尔提出了这个绝妙的想法。拉梅结束了他的发言后，在一片掌声与悄悄议论中，刘维尔走上讲台。他并没有表现出拉梅那样的热情，谦虚地说使用复数来解决数论问题并不是他的原创——欧拉、拉格朗日、高斯、柯西、雅可比都曾这样使用复数。他给拉梅泼了冷水，指出很多数学家刚开始都会这么想。这个想法的关键在于，一个整数是否可以\underdot{唯一}分解为素因子的积。尽管对于普通的整数成立，但没有充分证据表明可以把这个方法推广到复数上去。

接下来轮到柯西（见\cref{fig:Cauchy}）发言了。他表示拉梅有可能成功，但接着话锋一转，指出他自己早在1846年10月就向科学院提交了证明费马大定理的想法，只是他还没有来得及把证明细化。这相当于公开向拉梅挑战，看看谁能先完成费马大定理的证明。拉梅一点也不含糊，接下来的数周，他和柯西唇枪舌剑展开竞争。拉梅承认刘维尔的批评有道理，但他坚信自己的结论是正确的。他展示了迄今为止试过的所有例子都支持复数上的唯一分解，并准备证明这一“引理”。在法国科学院3月15日的会议上，数学家旺策尔\footnote{旺策尔证明了高斯——旺策尔定理，彻底解决了正多边形作图问题、三分角和倍立方问题。}宣布他“证明”了唯一分解定理在复数上的有效性，而事实上他只覆盖了$n \leq 4$的情形，接着就说“显而易见”我们可以用类似的方法证明$n > 4$的情形。但大家包括柯西并不觉得“显而易见”。柯西于是发表了一系列论文，试图证明复数上带余数的除法，并由此证明唯一分解定理。

3月22日，柯西和拉梅的竞争达到了白热化。双方各自向科学院提交了“时间胶囊”——这是法国科学院建立的一种制度，可能是吸取了当年牛顿与莱布尼茨争夺微积分优先权的教训。双方可以把自己的想法密封后提交给科学院保存。科学院确保这些内容不会泄漏，同时学者们可以继续完善研究，并在未来产生优先权争议时进行仲裁。此后柯西和拉梅就不时在科学院公布自己的进展，似乎总是“几乎”要解决了，但还有一个“小”问题。转折发生在5月24日。刘维尔在科学院宣读了来自德国布雷斯劳的数学家库默尔（见\cref{fig:Kummer}）的信。库默尔肯定了刘维尔对唯一分解定理的质疑，并附上了一份他三年前发表的论文，文中推翻了复数上的唯一分解定理。这冰冷的事实终结了拉梅与柯西的竞争。

\begin{figure}[htbp]
 \centering
 \subcaptionbox{库默尔\label{fig:Kummer}}{\includegraphics[scale=0.4]{img/Kummer}}
 \subcaptionbox{刘维尔\label{fig:Liouville}}{\includegraphics[scale=0.4]{img/liouville}}
 \caption{库默尔与刘维尔}
\end{figure}

\index{理想数} \index{伯努利数} \index{正则素数}
但是——戏剧性的事件总有但是，库默尔说他有办法“挽救”唯一分解定理，他引入了一种称为“理想复数”（简称理想数）的新概念，可以通过理想数的唯一分解证明费马大定理。但是——又是但是，对某些特别奇怪的素数$p$，例如37，理想数也不存在。他已经找到了判断奇特素数的方法，这些成果已于一年前发表于柏林科学院。库默尔接着一举证明了费马大定理对100以内所有的素数$p$，除了37, 59, 69之外，都成立，即$x^p + y^p = z^p$无正整数解\footnote{确切地说，库默尔证明了对于所有奇素数$p$，如果$p$不整除任何伯努利数$B_2, B_4, \dotsc, B_{p-3}$的分子，则费马大定理对指数$p$成立。这样的素数叫做“正则”素数。其中伯努利数的递归定义为：$B_0 = 1$，对任意正整数$n$满足$\displaystyle \sum_{k = 0}^{n}\binom{n + 1}{k} B_k = 0$}。这不但是怀尔斯之前的最好结果，而且还开辟了一个数学新领域——代数数论。

\index{数学家!库默尔}
\begin{mdframed}
恩斯特·爱德华·库默尔（1810～1893）的父亲物理学家卡尔·戈特黑尔夫・库默尔在他三岁时就去世了。他和哥哥由母亲抚养大。1828年，库默尔考入哈雷大学学习新教神学。幸运的是，为了打下坚实的哲学基础，他认真学习了数学。老师舍克激发了他的兴趣，库默尔越来越喜爱数学。1831年，库默尔在老师的指导下发表数学论文并一举获奖，他因此获得了博士学位和教师资格。库默尔先在他曾就读过的索劳（Sarau）文科中学担任见习教师。一年之后，他正式在利格尼察（Liegnitz，即今天波兰的莱格尼察）文科中学当了十多年的教师。库默尔在中学教数学和物理，学生们也因为有了他这样的优秀教师获益匪浅。他最著名的两位弟子是克罗内克和约阿希姆斯塔尔。库默尔一边教学一边研究。他于1836年在著名的学术期刊克莱尔杂志上发表了超几何级数的论文，并转发了一份给著名数学家雅可比。通过往来通信，雅可比和狄利克雷很快发现了库默尔的天赋和潜力。1839年，在狄利克雷的推荐下，中学教师库默尔破天荒地入选了柏林科学院。雅可比还打算为库默尔在大学中寻找一个相称的职位。

1840年，30岁的库默尔与狄利克雷夫人的侄女结婚，但妻子不幸于1848年去世了。在这段时期，库默尔取得了学术上的巨大成就。在雅可比和狄利克雷的支持下，他成为布雷斯劳（今属波兰弗罗茨瓦夫）大学的全职教授。库默尔很快就成了大学里的优秀数学教师，此时他开始研究数论。1855年狄利克雷离开柏林去哥廷根大学接替高斯的职位，他临行前推荐库默尔接替自己。库默尔希望和魏尔斯特拉斯合作，但后者很可能会接替他在布雷斯劳的空缺。于是库默尔机智地推荐他的学生约阿希姆斯塔尔接任。1856年，魏尔斯特拉斯成功来到了柏林，他与库默尔，以及一年前加入柏林大学的克罗内克一起工作，把柏林变成了当时世界著名的数学研究中心。库默尔与魏尔斯特拉斯于1861年在德国创立了第一个纯数学讨论班。他再次成为备受学生欢迎的教师。不仅讲课清晰、风趣幽默，而且还关心、资助有困难的学生。
%% 尽管库默尔出版过讲义和论文，但他从未撰写过任何教材。

库默尔早年研究函数理论和微分方程。1843年他在研究费马大定理时发现了唯一分解定理在复数上不成立，并由此发展出了“理想数”。他的工作奠定了费马大定理多年的研究方向，极大地推动了环论和抽象代数的发展。巴黎科学院于1857年授予库默尔科学院大奖。有趣的是，科学院本来悬赏3000法郎以奖励解决费马大定理的学者。但这要等到138年后，所以即使一再延期也没人能获奖。最终科学院决定把大奖颁发给库默尔，并吸收他为外籍院士。接着1863年英国皇家科学院也邀请他成为外籍院士。

库默尔从一名中学教师做起，后来成为了柏林科学院数学和物理学部的秘书。他于1857～1858年及1865～1866年两度出任柏林大学教务长，1868～1869年担任校长。他培养了大批优秀博士生，包括巴赫曼、康托尔、杜布瓦 - 雷蒙、戈丹、舍恩弗利斯、施瓦茨。其中施瓦茨还与库默尔的女儿结婚。库默尔1883年退休时，他的学生富克斯（Fuchs）接过了他的接力棒。
\end{mdframed}

\section{高斯整数}

\index{代数数}
要想把整除、素数等概念扩展到复数，首先必须定义什么是“复整数”。最直观的一个想法是扩展成$a + bi$，其中$a, b$是整数。但这还不够，我们看到欧拉似乎把$a + i\sqrt{3}b$看成整数。从历史经验看，方程是发现探索“未知数”的有力武器。通过解一次方程$ax = b$，我们认识到有理数$x = \dfrac{b}{a}$；通过解二次方程，我们认识到无理数；通过解三次方程，我们认识到复数；通过解高次方程，我们认识到有无法用根式表示的数。通过代数基本定理，我们认识到那些无法用根式表示的数也都是复数，它们可以用代数方程定义：

\[
a_n x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0 = 0
\]

\index{超越数}
其中$a_n, a_{n-1}, ..., a_1, a_0$是整数。为什么系数不是有理数呢？假设它们是有理数$a_i = \dfrac{b_i}{c_i}$，两边乘以分母的最小公倍数，我们就把系数变回了整数。所以系数是整数就足够了。厄米特于1873年，林德曼于1882年分别证明了$e, \pi$不是这样的代数方程的解。为了加以区分，我们把满足代数方程的数叫做代数数（algebraic number），否则叫做超越数（transcendent number），$\pi, e$都是超越数。代数数的定义是抽象的、间接的。和$1 + i\sqrt{2}$不同，我们没有给出代数数的表达式，它们是代数方程的解，存在那里，但可能没法用根式表达。按照这个定义，当$n = 1$时，方程是一次方程$ax + b = 0$，解$x = \dfrac{b}{a}$。如果系数$a = 1$，则$x$是整数；受此启发，我们定义$a_n = 1$时，代数方程：

\index{代数整数}
\[
x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0 = 0
\]

\index{首一方程} \index{高斯整数} \index{有理整数}
的解叫做代数整数（algebraic integer），这样的方程叫做“首一方程”（monic equation）。代数整数既包括普通的整数（又叫有理整数rational integer，见\cref{qn:rational-solution-is-integral}），也包括了更复杂的整数。为了避免胡子眉毛一把抓，我们从最简单的二次首一方程开始探索代数整数。当一次项是偶数时，方程$x^2 - 2ax + a^2 + b^2 = 0$的解是$a \pm bi$。高斯最早对这种形式的数进行研究，今天我们把这种数叫做“高斯整数”，用记号$\mathbb{Z}[i]$表示，这个记号暗示了我们把虚数单位$i$加入到整数$\mathbb{Z}$中\footnote{符号$\mathbb{Z}[x]$叫做整数环$\mathbb{Z}$上的一元多项式，它由形如$a_n x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0$的元素组成，其中$a_0, a_1, \dotsc, a_n \in \mathbb{Z}$是整数。}。

为了区分代数整数和普通有理整数，我们用希腊字母$\alpha, \beta, \gamma, \dotsc$表示代数整数（附录\ref{ch:greek-letters}有希腊字母的读音），用英文字母$a, b, c, \dotsc$表示有理整数。和普通整数类似，我们很容易验证高斯整数之间的$+, -, \times$运算结果仍然是高斯整数，但除法不一定（正如同普通有理整数之间的除法结果不一定是有理整数）。利用这一点就能定义整除了。如果高斯整数$\alpha = \beta\gamma$是另外两个高斯整数的积，我们称$\beta$整除$\alpha$。接下来的问题有些棘手：(1) 怎样定义带余数的除法？(2) 怎样定义高斯整数中的素数？

\index{范数}
带余数的除法需要“更小”这一概念，普通有理整数带余数的除法是$a = bq + r$，其中$r < b$，即余数比除数“更小”。但是复数本质上是向量，不能直接比较大小。例如我们不能说$1 + i$“小于”2。只有复数的模是可以比较大小的，例如$|1 + i| = \sqrt{1^2 + 1^2} = \sqrt{2} < 2 = |2|$。为了解决什么是“更小”的问题，高斯于1832年定义了一个重要的概念：范数（Norm），复数$z = a + bi$的范数为：

\[
N(z) = a^2 + b^2
\]

它实际是模的平方，因而总是$\geq 0$，并且和共轭复数有不解之缘：

\[
N(z) = a^2 + b^2 = z\overline{z} = N(\overline{z})
\]

范数和模一样，是可乘的（见\cref{qn:norm-is-multiplicative}）：

\[
N(\alpha\beta) = N(\alpha)N(\beta)
\]

\index{高斯整数!单位元} \index{高斯整数!相伴}
利用范数，高斯扩展了1的概念。在普通有理整数中，$3 = 3 \times 1$。一旦考虑负整数，情况就丰富起来：$-3 = 3 \times (-1) = -3 \times 1$。但取绝对值的话，情况就统一到：$|3| = |(\pm 3) \times (\pm 1)| = 3 \times 1$。高斯定义范数$N(\mu) = 1$的数是单位元（unit），若$\alpha = \mu \alpha'$，称$\alpha'$是$\alpha$的“相伴元”（associate，英文关联的意思）。这样在上述有理整数的例子中，$-1, 1$都是单位元，而$-3$和3是相伴的。扩展到高斯整数，单位元有4个：
%% 由$N(\mu) = a^2 + b^2 = 1$，其中$a, b \in \mathbb{Z}$是整数，要么$a^2 = 1, b^2 = 0$，要么$a^2 = 0, b^2 = 1$。分别对应$a = \pm 1, b = 0$和$a = 0, b = \pm 1$，
$\pm 1, \pm i$。例如$1 + i = (1 - i)i$，因为$|i| = 1$是单位元，所以$1 + i$和$1 - i$是相伴的，如同普通有理整数中相伴的$\pm 3$。单位元还有一个等价的定义：凡是整除1的数叫做单位元。这样$\mu^n = 1$，有趣的是，有理整数的两个单位元分别是$(-1)^0, (-1)^1$；而高斯整数的4个单位元分别是$i^{0, 1, 2, 3}$次幂。读者朋友们，你是否想到了分圆方程？
%% 分圆方程的根是单位元吗？

范数一举扫清了带余数除法的障碍：一个直观的想法是用高斯整数的$N(\gamma) < N(\beta)$来代替有理整数的$r < b$。这样高斯整数带余数的除法就可定义为：

\begin{align*}
\alpha &= \rho \beta + \gamma & \text{其中} \beta &\ne 0, N(\gamma) < N(\beta)
\end{align*}

但是且慢，给定被除数$\alpha$和除数$\beta$，商$\rho$和余数$\gamma$一定存在么？如果不存在，这个定义就站不住脚了。于是高斯接下来证明了：

\index{高斯整数!带余数除法}
\begin{theorem}
给定高斯整数$\alpha$和$\beta \ne 0$，存在高斯整数$\rho, \gamma$使得$\alpha = \rho \beta + \gamma$，其中$N(\gamma) < N(\beta)$。
\end{theorem}

\begin{proof}
令$\rho = m + ni$，其中$m, n$是有理整数，所有$\rho \beta$都可写为：

\[
\rho \beta = (m + ni)\beta = m\beta + ni\beta
\]

即复数$\beta$的倍数和$i\beta$的倍数的和。在几何上$i\beta$相当于向量$\beta$旋转90度（见\cref{qn:mul-i}）。如\cref{fig:zi}所示，$i\beta$与$\beta$垂直。因此所有的$\rho \beta$分布在边长为$|\beta|$的方格子的交点上。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/zi}
 \caption{高斯整数$\rho \beta$的所有值构成一个网格，$\alpha$落在某个格子中。}
 \label{fig:zi}
\end{figure}

被除数$\alpha$所代表的向量必然落在某个格子中（包括边）。它到最近的两个边的距离都$\leq \frac{|\beta|}{2}$（如\cref{fig:zi}中$a, b \leq \frac{|\beta|}{2}$）。由三角形两边和大于第三边，有：

\[
|\gamma| = |c| < |a| + |b| \leq \frac{|\beta|}{2} + \frac{|\beta|}{2} = |\beta|
\]
两边平方得$N(\gamma) < N(\beta)$。
\end{proof}

\index{高斯整数!欧几里得算法}
有了带余数除法，就意味着可以使用欧几里得算法了（见第\ref{sec:Euclidean-algorithm}节）。高斯把欧几里得算法扩展到高斯整数。

\begin{align*}
\alpha   &= \rho_1 \beta + \gamma_1    & N(\gamma_1) &< N(\beta) \\
\beta    &= \rho_2 \gamma_1 + \gamma_2 & N(\gamma_2) &< N(\gamma_1) \\
\gamma_1 &= \rho_3 \gamma_2 + \gamma_3 & N(\gamma_3) &< N(\gamma_2) \\
         & \dotso
\end{align*}

但这个过程不会永远进行下去，因为范数是普通的非负整数，所以必然存在某个$n$使得$N(\beta) > N(\gamma_1) > N(\gamma_2) > \dotsb > N(\gamma_n) > N(\gamma_{n+1})= 0$。即：

\begin{align*}
\gamma_{n-2} &= \rho_n \gamma_{n-1} + \gamma_n & N(\gamma_n) &< N(\gamma_{n-1}) \\
\gamma_{n-1} &= \rho_{n+1} \gamma_n && \text{除尽}
\end{align*}

这样$\gamma_n$整除$\gamma_{n-1} \to$整除$\gamma_{n-2} \to \dotsb \to$整除$\beta \to$整除$\alpha$。所以$\gamma_n$是$\alpha, \beta$的公约数。反之，任何$\alpha, \beta$的公约数$\psi$必然整除$\alpha \to$整除$\beta \to$整除$\gamma_1 \to$整除$\gamma_2 \to \dotsb \to$整除$\gamma_n$。因此$\gamma_n = (\alpha, \beta)$是\underdot{最大}公约数\footnote{这里对应的英文是highest common divisor而不是greatest common divisor，因为复数不能直接比较大小。}。我们给最大两个字加了点是因为：(1) 复数不能直接比较大小，这里“最大”的涵义是任何公约数$\psi$都整除$\gamma_n$。(2) 高斯整数的最大公约数不唯一。如果一个数乘以单位元$\mu\phi = \gamma_n$，则$\phi$也是最大公约数。例如$3 + i$与$1 + 3i$的最大公约数是$-1 + i$，它乘以$-1, \pm i$得到的相伴元$1 - i, i(-1 + i) = -1 - i, -i(-1 + i) = 1 + i$也都是最大公约数。

接下来高斯要回答什么才是素数。一旦引入复数，普通的素数$2, 3, 5, 7, \dotsc$中，有些竟然可以分解，如：$2 = (1 + i)(1 - i), 5 = (2 + i)(2 - i)$。而素数的直观涵义是“基础砖石”，它们能构成其它整数而自己不能被进一步分解。可是究竟什么是“进一步”呢？例如$1 + i = (1 - i)i$，我们此时立即看出高斯定义单位元和相伴元的意义了。如果一个数只能分解为相伴元和单位元的乘积，这不是“进一步”，而是“原地踏步”。于是高斯给出了素数的扩展定义：

\index{高斯整数!素数}
\begin{definition}
一个高斯整数是素数如果它不等于0或任何单位元，并且只能被和它相伴的数与单位元整除。
\end{definition}

\index{高斯素数} \index{有理素数}
为了区分，我们把普通整数中的素数叫做“有理素数”，把高斯整数中的素数叫做“高斯素数”。通常用字母$p$表示有理素数，用希腊字母$\pi$来表示代数整数中的素数。注意不要和圆周率混淆。在高斯整数中，一个素数$\pi$有8个因子：$\pm 1, \pm i, \pm \pi, \pm i\pi$。接下来的问题是如何找到这些素数？

\begin{proposition}\label{thm:prime-norm}
如果一个高斯整数$\psi$的范数是有理素数$p$，则$\psi$是高斯素数。
\end{proposition}

\begin{proof}
假设$\psi = \alpha\beta$是两个高斯整数的积，两边取范数：

\begin{align*}
p &= N(\psi) = N(\alpha\beta) = N(\alpha)N(\beta)  && \text{范数可乘}
\end{align*}

有理素数的因子只有$1, p$。所以$N(\alpha)$和$N(\beta)$中必然有一个是1，因而是单位元。另外一个必然和$\psi$相伴，由定义知$\psi$是高斯素数。
\end{proof}

根据这个结论，我们马上可以判断$1 \pm i, 2 \pm i, 1 \pm 2i$都是素数（它们的范数$N(1 \pm i) = 1^2 + 1^2 = 2, N(2 \pm i) = N(1 \pm 2i) = 1^2 + 2^2 = 5$都是有理素数）。但这个命题的逆命题不成立，高斯素数的范数并不一定是有理素数。例如$N(3) = 9$，不是有理素数，假设3可以分成两个高斯整数的积$3 = (a + bi)(c + di)$。两边取范数：

\[
9 = N(3) = N(a + bi)N(c + di) = (a^2 + b^2)(c^2 + d^2)
\]

很容易验证3不是两个正整数的平方和（3只有一种正整数分解：3 = 2 + 1，其中2不是平方数），因此$a^2 + b^2 = c^2 + d^2 = 3$是不可能的。这样$a^2 + b^2$和$c^2 + d^2$只能是1和9。不管哪个是1，其对应的高斯整数是一个单位元。因此根据定义，3是高斯素数。这提示我们，如果一个有理素数$p$能表示为两个正整数的平方和$p = a^2 + b^2$，则它可分解为$p = (a + bi)(a - bi)$因而不是素数；反之，如果$p$不能表示为平方和，使用类似的推理，假设$p = (a + bi)(c + di)$，取范数：

\[
p^2 = N(p) = N(a + bi)N(c + di) = (a^2 + b^2)(c^2 + d^2)
\]

因为$p$不是平方和，所以不可$a^2 + b^2 = c^2 + d^2 = p$；故$a^2 + b^2$和$c^2 + d^2$只能是1和$p^2$。不管哪个是1，其对应的高斯整数是单位元，所以$p$是高斯素数。有理素数中只有2是偶数。因为$2 = 1^2 + 1^2$，所以$2 = (1 + i)(1 - i)$不是高斯素数。我们此前已经判断出$1 \pm i$及其相伴元都是素数。剩下的所有奇素数可分为两类：形如$4n + 3$的和形如$4n + 1$的。例如3就是前一类，我们怀疑$4n + 3$形的素数不能拆成平方和，幸运地是我们猜对了。

\index{平方和}
\begin{proposition}
形如$4n + 3$的奇素数不能表示成正整数的平方和。
\end{proposition}

\begin{proof}
用反证法，假设$a^2 + b^2 = 4n + 3$。$a, b$的奇偶必然不同，否则它们的平方和是偶数。不妨令$a = 2k + 1, b = 2m$，有：

\[
a^2 + b^2 = (2k + 1)^2 + (2m)^2 = 4k^2 + 4k + 1 + 4m^2 = 4(k^2 + k + m^2) + 1
\]

是$4n + 1$的形式而不是$4n + 3$的形式，矛盾。
\end{proof}

这样，所有$3, 7, 11, \dotsc$都是高斯素数了。为了处理$4n + 1$形的素数，我们需要一个重要的武器：高斯整数上的算术基本定理。我们的思路和第\ref{sec:fundamental-theorem-of-arithmetic}节一样：通过高斯整数上的欧几里得算法推出算术基本定理。

\begin{proposition}
如果高斯整数$\alpha, \beta$互素，即$(\alpha, \beta) = 1$，并且$\alpha$整除乘积$\beta \psi$，则$\alpha$整除$\psi$。
\end{proposition}

\begin{proof}
把欧几里得算法中的数都放大$\psi$倍，最后得：

\begin{align*}
(\alpha \psi, \beta \psi) &= \gamma_n \psi = \psi  && \text{由} 1 = (\alpha, \beta) = \gamma_n
\end{align*}

即最大公约数是$\psi$。如果$\alpha$整除$\beta \psi$，由于$\alpha$也整除$\alpha \psi$，因此$\alpha$是公约数，它必然整除最大公约数$\psi$。
\end{proof}

\begin{corollary}\label{thm:Gaussian-primary}
如果高斯素数$\pi$整除乘积$\alpha \beta$，则$\pi$整除$\alpha$或$\pi$整除$\beta$。
\end{corollary}

\begin{proof}
如果素数$\pi$不整除$\alpha$，则$(\pi, \alpha) = 1$。若$\pi$整除$\alpha \beta$，据上面的命题，$\pi$整除$\beta$。
\end{proof}

利用这个推论就可以证明高斯整数上的算术基本定理了。

\index{高斯整数!算术基本定理}
\begin{theorem}[高斯整数上的算术基本定理]
高斯整数可以唯一分解为高斯素数的乘积，如果不考虑这些素数的顺序、相伴元、有否单位元的话。
\end{theorem}

\begin{proof}
用反证法，假设某一高斯整数有两种高斯素数分解：
\[
\pi_1 \pi_2 \dotsm \pi_j = \psi_1 \psi_2 \dotsm \psi_k
\]
其中某个素因子$\pi_i$既不是单位元，也不与右侧任何素因子相伴。根据上述推论，因为素数$\pi_i$整除彼此互素数的积$\psi_1 \psi_2 \dotsm \psi_k$，所以$\pi_i$要么整除$\psi_1$，要么整除$\psi_2, \dotsc, $要么整除$\psi_k$。但这是不可能的，因为每个素数$\psi_1, \psi_2, \dotsc, \psi_k$都不可能被不相伴的数整除。因此假设不成立，任何高斯整数只有一种高斯素数分解。
\end{proof}

\index{威尔逊定理}
现在我们可以调转枪头，分拆$4n + 1$形的有理素数，从而彻底解决高斯素数问题。我们需要用到初等数论中的威尔逊定理（见附录\ref{app:wilsons-theorem}）：如果$p$是素数，则阶乘$(p - 1)! \equiv -1 \pmod p$。

\begin{lemma}
存在某个平方和$x^2 + 1$能被形如$p = 4n + 1$的有理素数整除。
\end{lemma}

\begin{proof}
$p = 4n + 1$，阶乘$(p - 1)!$包含$4n = 2n + 2n$项：
\begin{align*}
(p - 1)! &= 1 \cdot 2  \dotsm  2n \cdot (2n + 1)  \dotsm  4n \\
  &= (1 \cdot 2  \dotsm  2n)[(p - 1) \cdot (p - 2)  \dotsm  (p - 2n)] && \text{反转后半段} \\
  &\equiv (1 \cdot 2  \dotsm 2n)(-1 \cdot -2 \dotsm -2n) \pmod p && \text{由} p - k \equiv k \pmod p \\
  &\equiv (2n)!(-1)^{2n}(2n)! = [(2n)!]^2 = x^2 \pmod p && \text{令} x = (2n)!
\end{align*}
另一方面，由威尔逊定理有$(p - 1)! \equiv -1 \pmod p$。所以$x^2 \equiv -1 \pmod p$，即$p$整除某个$x^2 + 1$。
\end{proof}

现在$p = 4n + 1$整除某个$x^2 + 1 = (x + i)(x - i)$。如果$p$也是高斯素数，则$p$整除$x + i$或$x - i$（据推论\ref{thm:Gaussian-primary}）。但是$\dfrac{x}{p} \pm \dfrac{1}{p}i$不可能是高斯整数。这个矛盾说明$p$不是高斯素数，因而必然能分解为乘积：$p = (a + bi)(c + di)$，其中$a + bi$和$c + di$都不是单位元（$a^2 + b^2 \ne 1 \ne c^2 + d^2$）。两边取范数：

\[
p^2 = N(p) = N(a+bi)N(c+di) = (a^2 + b^2)(c^2 + d^2)
\]

因此只能是$a^2 + b^2 = c^2 + d^2 = p$。另一方面如果$p = a^2 + b^2 = (a + bi)(a - bi)$。由于$N(a \pm bi) = p$，根据命题\ref{thm:prime-norm}，它们都是高斯素数。接着根据高斯整数的算术基本定理，这种分解是\underdot{唯一}的。所以必然有$a^2 = c^2, b^2 = d^2$。这样我们就解决了$4n + 1$形的素数，并且利用高斯整数证明了如下结论\footnote{1640年12月25日，费马在给梅森的信中提出了这一命题。费马曾多次告诉友人，他用无穷递降法证明了这个猜想，但一直未发现相关的文献资料。一个多世纪后，欧拉在1754年首次给出了该命题的证明。}：

\index{费马平方和定理}
\begin{theorem}[费马平方和定理]
有理素数$p = 4n + 1$一定可以分解为两个平方和$a^2 + b^2$。
\end{theorem}

我们用下面的定理总结上述三种情况：(1) 唯一的偶素数$p = 2$；(2) 形如$4n + 3$的奇素数；(3) 形如$4n + 1$的即素数。

\begin{theorem}
高斯素数包括三种：(1) $1 + i$及其相伴元；(2) 有理素数$4n + 3$及其相伴元；(3) 有理素数$4n + 1$的因子$a + bi$。
\end{theorem}

\index{数学家!高斯}
\begin{mdframed}
我们之前介绍过高斯攻克了正17边形作图的问题（见\ref{sec:Gauss-17-gon}节）。1799年，高斯从哥廷根大学回到家乡。他向黑尔姆施泰特大学提交了关于代数基本定理的论文并取得了博士学位。布伦瑞克公爵答应继续资助他，高斯得以心无旁骛地投身于研究之中。1801年夏，他出版了化时代的数论名著《算术研究》。1801年元旦，意大利天文学家皮亚齐（Giuseppe Piazzi，1746～1826）发现了一颗新的小行星“谷神星”（Ceres），但皮亚齐仅观测到了很少的数据，谷神星就转到太阳后面看不到了。高斯的朋友，德国天文学家扎赫（Franz Xaver von Zach，1754–1832）把这个情况告诉了高斯。高斯经过计算（很可能是使用最小二乘法）于6月份推测出了谷神星的轨道。但他的预测和其他学者的大相径庭。到了年底12月7日，扎赫再次观测到了转到太阳前面的谷神星，其轨道和高斯的预测毫无二致。高斯一夜之间在欧洲学术界名声大噪。哥廷根大学的天文学家奥伯斯（Heinrich Wilhelm Olbers，1758–1840）邀请高斯出任新落成的天文台台长。

%% https://www.liquisearch.com/carl_friedrich_gauss/family
高斯在学术上突飞猛进，但个人生活却屡遭不幸。他于1805年与约翰娜・奥斯特霍夫（Johanna Osthoff）结婚。第二年，高斯的资助人布伦瑞克公爵作为反法同盟的军事统帅，率领普鲁士布伦瑞克联军对抗拿破仑。但在耶拿战役中战败受伤，同年去世。其领地随后被法国占领（1813 年拿破仑战败后复国）。这对高斯是一个巨大的打击，他多次表示 “没有公爵的支持，我的学术生涯将无从谈起”。1808年高斯的父亲病故。不幸接连而至，妻子约翰娜生育第三个孩子后不久去世。接着高斯的一个孩子路易也夭折了。高斯长久没有从这次打击中恢复过来。他后来和明娜・瓦尔德克再婚并育有另外三个孩子。但第二任妻子长期被肺结核困扰。高斯的家庭气氛并不和睦，多病的妻子让他心烦意乱，有时拿孩子撒气\citepage[357页]{Stillwell-2010}。儿子欧根于1830年负气出走，移民美国。第二年妻子病故。此后高斯的小女儿特蕾泽一直照顾他直到去世。

%% https://www.britannica.com/biography/Carl-Friedrich-Gauss
尽管如此，高斯的学术成就是无与伦比的。除了天文学外，他还投入了大量时间和精力于1818到1825年对汉诺威进行大地测量。高斯发明了日光反射仪（一种能将太阳光汇聚成光束反射出去、在数英里外仍可观测到的仪器）显著提高了观测的精确度。并在测地的实践中发展出了曲面曲率的概念。为微分几何这一分支奠定了理论基础。从高斯生前未发表的文献看，他还清楚地意识到了非欧几何理论。1830年后，年轻的物理学家威廉·韦伯（Wilhelm Eduard Weber，1804～1891）来到了哥廷根大学，高斯的激情又被点燃了。他和韦伯一起合作研究地磁和电磁学，并参与了首次全球范围的地球磁场调查（为了测量地球磁场，高斯发明了磁力计）。他和韦伯制造出了第一台电报机，能从哥廷根天文台发报到韦伯的办公室（尽管未能继续推进这项发明）。高斯从中发展出了位势理论，成为数学物理的一个重要分支。但好景不长，1837年，韦伯因拒绝向汉诺威新国王宣誓效忠而被解雇。

高斯晚年的最大成就是培养了顶级的人才。他最后的学生包括爱森斯坦、戴德金、黎曼。高斯也许是孤独的，他的思想和天赋超越了身边的人，但他也许看到了这些年轻的数学家将会接过火炬并发扬光大。
\end{mdframed}

\section{二次整数}
\index{二次整数}
高斯整数是二次首一代数方程中最简单的情况。稍微改变一下方程，$x^2 - 2ax + (a^2 + mb^2) = 0$的解是$a \pm b\sqrt{-m}$，其中$m$不含任何平方因子。这种形式的代数整数，是二次方程的解，叫做“二次整数”，用$\mathbb{Z}[\sqrt{-m}]$表示。例如$\mathbb{Z}[\sqrt{-2}], \mathbb{Z}[\sqrt{-3}]$等。我们由此看出欧拉在证明费马大定理$n=3$时的分解：

\[
p^2 + 3q^2 = (p + q\sqrt{-3})(q - q\sqrt{-3})
\]

是关于二次整数$\mathbb{Z}[\sqrt{-3}]$的。高斯对$\mathbb{Z}[i]$的处理为我们树立了样板：(a) 先定义范数，(b) 然后扩展欧几里得算法，(c) 找出素数。我们先从$\mathbb{Z}[\sqrt{-2}]$开始热身一下。受共轭复数的启发，我们扩展范数的定义如下：

\index{二次整数!范数}
\begin{definition}
二次整数$\xi = a + b\sqrt{-m}$的范数定义为$N(\xi) = \xi\overline{\xi} = (a + b\sqrt{-m})(a - b\sqrt{-m}) = a^2 + mb^2$
\end{definition}

注意到这恰好是二次方程的常数项，这并非巧合（见\cref{qn:quadratic-norm}）。对于$\mathbb{Z}[\sqrt{-2}]$，范数为$a^2 + 2b^2$。单位元是
%% 的范数为1，只可能是$a^2 = 1, b = 0$，即
$\mu = \pm 1$。接下来我们判断$\mathbb{Z}[\sqrt{-2}]$上是否有欧几里得算法。也就是说，任给整数$\alpha, \beta \ne 0$，是否存在整数$\rho, \gamma$使得$\alpha = \rho \beta + \gamma$，并且$N(\gamma) < N(\beta)$。令$\rho = m + n\sqrt{-2}$，则$\rho \beta = m\beta + n\sqrt{-2}\beta$，它是由向量$\beta$和$i\sqrt{2}\beta$张成的矩形网格，如\cref{fig:Z-sqrt-2}所示。因为$i\sqrt{2}\beta$把$\beta$旋转90度后放大$\sqrt{2}$倍，所以矩形的宽是$|\beta|$长是$\sqrt{2}|\beta|$。任何整数$\alpha$都落在某个矩形中，它距离最近的顶点距离的平方可由勾股定理得到：

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/z-sqrt-2}
 \caption{$\mathbb{Z}[\sqrt{-2}]$中的整数构成浅灰色网格，积$\rho \beta$构成黑色网格，$\alpha$落在某个格子中。}
 \label{fig:Z-sqrt-2}
\end{figure}

\begin{align*}
N(\alpha - \rho\beta) & = c^2 = a^2 + b^2  && \text{勾股定理} \\
  &\leq (\frac{\sqrt{2}}{2}|\beta|)^2 + (\frac{1}{2}|\beta|)^2 && a, b\text{都不大于矩形边长的一半} \\
  &= \frac{3}{4}|\beta|^2 < |\beta|^2 = N(\beta)
\end{align*}

令$\gamma = \alpha - \rho \beta$即可。这样欧几里得算法在$\mathbb{Z}[\sqrt{-2}]$上也成立，从而算术基本定理也成立。但接下来的$\mathbb{Z}[\sqrt{-3}]$却让人失望了。因为存在这样的反例：

\[
4 = 2 \times 2 = (1 + i\sqrt{3})(1 - i\sqrt{3})
\]

其中2不能被进一步分解，否则假设$2 = (a + b\sqrt{-3})(c + d\sqrt{-3})$，两边取范数：

\[
4 = N(2) = N(a+b\sqrt{-3})N(c + d\sqrt{-3}) = (a^2 + 3b^2)(c^2 + 3d^2)
\]

不可能$a^2 + 3b^2 = c^2 + 3d^2 = 2$，这个方程没有整数解。所以$a^2 + 3b^2$或$c^2 + 3d^2$是1，其对应的是单位元，另一个是2的相伴元。这就证明了2不能被分解。$1 \pm i\sqrt{3}$的范数都是4，通过同样的分析，我们知道它们也不能被分解。这样4就有两种分解方式。这是为什么呢？如\ref{fig:Z-sqrt-3}所示，所有$\rho \beta$是由$\beta$和$i\sqrt{3}\beta$张成的矩形网格。任何$\alpha$落在某个矩形中，它距离最近的顶点距离的平方是：

\begin{align*}
N(\alpha - \rho \beta) &= c^2 = a^2 + b^2  && \text{勾股定理} \\
  &\leq (\frac{\sqrt{3}}{2}|\beta|)^2 + (\frac{1}{2}|\beta|)^2 = |\beta|^2 && a, b \leq \text{长宽的一半}
\end{align*}

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/z-sqrt-3}
 \caption{$\mathbb{Z}[\sqrt{-3}]$中的整数构成浅灰色网格，积$\rho \beta$构成黑色网格，$\alpha$落在某个格子中。}
 \label{fig:Z-sqrt-3}
\end{figure}

并不一定是$<$。如图中所示，当$\alpha$落在矩形中心时，不存在$\gamma$使得$N(\gamma) < N(\beta)$。因此欧几里得算法在$\mathbb{Z}[\sqrt{-3}]$上不成立，算术基本定理了不成立，分解不一定唯一。这就解释了$4 = 2 \times 2 = (1 + i\sqrt{3})(1 - i\sqrt{3})$。这真是太遗憾了！如果$\alpha$落在矩形中心以外的任何地方都能保证它到最近顶点的距离严格$< |\beta|$，只有中心是个例外。有没有办法补救呢？如\cref{fig:Z-omega}所示，这种情况下矩形的中心$\notin \mathbb{Z}[\sqrt{-3}]$。因而对所有的$\alpha$，都存在$\gamma$使得$N(\gamma) < N(\beta)$。这两种情况有什么区别呢?似乎不同的$\beta$导致不同的结果。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/z-omega}
 \caption{当$\beta = 2 + \sqrt{3}i$时，任何$\alpha$都不会落在$\rho \beta$网格的中心。此时可以找到$\gamma$使得$N(\gamma) < N(\beta)$。}
 \label{fig:Z-omega}
\end{figure}

让我们来分析一下，什么情况下矩形的中心不是二次整数。如\cref{fig:Z-sqrt-3c}所示，考虑任意$\rho \beta$构成的矩形，左下角$A$对应向量$\rho \beta$，根据复数加法的几何意义，右下角$C$对应向量$\rho \beta + \beta$，左上角$C'$对应$\rho \beta + i\sqrt{3}\beta$，即把向量$\beta$旋转90度后放大$\sqrt{3}$倍，再加到$C$上。矩形的中心就是对角线$CC'$的中心，对应向量：

\[
\frac{C + C'}{2} = \frac{\rho \beta + \beta + \rho \beta + i\sqrt{3}\beta}{2} = \rho \beta + \frac{1}{2}\beta + \frac{\sqrt{3}}{2}i\beta
\]

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/z-sqrt-3c}
 \caption{$\rho \beta$组成的某个矩形及其中心。}
 \label{fig:Z-sqrt-3c}
\end{figure}

由于$\rho \beta \in \mathbb{Z}[\sqrt{-3}]$，所以当$\dfrac{1}{2}\beta + \dfrac{\sqrt{3}}{2}i\beta \notin \mathbb{Z}[\sqrt{-3}]$时，矩形的中心不是二次整数。令$\beta = a + bi\sqrt{3}$带入：

\[
\frac{a + bi\sqrt{3}}{2} + \frac{(a + bi\sqrt{3})i\sqrt{3}}{2} = \frac{a - 3b}{2} + \frac{a + b}{2}i\sqrt{3}
\]

如果$a-3b$或$a + b$是奇数，则矩形中心不是二次整数，此时必有$a, b$的奇偶不同。反之，如果$a, b$奇偶相同，矩形中心就是二次整数，欧几里得算法就会失效。在反例$4 = 2 \times 2 = (1 + i\sqrt{3})(1 - i\sqrt{3})$中，$a = b = 1$都是奇数。而在\cref{fig:Z-omega}中，$\beta = 2 + i\sqrt{3}$，其中$a = 2, b=1$奇偶不同，$\alpha$不可能是矩形中心，因此存在欧几里得算法，存在唯一分解。欧拉在证明费马大定理$n=3$时，的的确确要求$a, b$奇偶不同，这样就保证了唯一分解。所以当$a^2 + 3b^2$是立方数时，互素的$(a + bi\sqrt{3})(a - bi\sqrt{3})$每个都是立方数（\cref{qn:coprime-of-conjugates}要求证明$a \pm bi\sqrt{3}$互素）。

\index{爱森斯坦整数}
这样我们就给费马大定理$n=3$划上了句号。关于$\mathbb{Z}[\sqrt{-3}]$还有后继的故事。高斯整数是分布在正方形格子上的复数，爱森斯坦（见\cref{fig:Eisenstein}）在1844年研究了分布在正三角形格子上的复数。今天我们把这样的复数叫做爱森斯坦整数。爱森斯坦发现很简单的首一二次方程$x^2 + x + 1 = 0$有两个解$\omega = \dfrac{-1}{2} \pm \dfrac{i\sqrt{3}}{2}$。根据代数整数的定义，尽管带有$\dfrac{1}{2}$，它们都是代数整数！更一般地，首一二次代数方程$x^2 - (2a - b)x + (a^2 - ab + b^2)$的解为$a + b \omega$。它们构成了爱森斯坦整数$\mathbb{Z}[\omega]$。爱森斯坦进一步定义范数为$N(a + b\omega) = a^2 -ab + b^2$（见\cref{qn:norm-of-z-omega}），并证明了欧几里得算法在$\mathbb{Z}[\omega]$上存在，从而唯一分解定理成立。而$\mathbb{Z}[\sqrt{-3}]$只不过是$\mathbb{Z}[\omega]$的一个子集。

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.4]{img/Eisenstein}
  \caption{爱森斯坦，1823～1852}
 \label{fig:Eisenstein}
\end{figure}

\index{数学家!爱森斯坦}
\begin{mdframed}
以下是大数学家韦依为爱森斯坦论文集写的书评\cite{Weil-2024}的开头部分，涵盖了爱森斯坦的一生。这里略作修改。

1823年4月16日，数学智慧之神伽内什（Ganesha, 印度教神祇）召集了许多仙女，聚集在柏林的婴儿摇篮里，给予恩惠和祝福。这是一个于去年六月结婚的不太富有的商人的长子，父母都是犹太人，但一直信仰福音派。遗憾的是, 就像所有的童话故事一样, 一个老女巫悄悄地到来, 并尝试破坏仙女们所做的努力。

一个仙女说，“他会拥有天赋并且成为高斯、狄利克雷、雅可比称职的继承者。”女巫说，“他的生命短暂并且不快乐。下一个仙女说，“他会有许多兄弟姐妹，并且温柔地依赖他们，同时他也是母亲的最爱。” 女巫说，“他将失去所有人，17年后，他会看见自己最小的妹妹在7岁去世。”“他会在中学遇见非常优秀的老师, 并且在数学研究上获得巨大的进步。”女巫说，“但是首先，他的父母会误送他到一个私立学校学习四年，这个学校严格的纪律几乎摧毁了他几近脆弱的身体，并且使他精神紧张地度过余生。”“他在柏林大学读一年级时，会引起德国科学界的元老洪堡（Humboldt）和那个时代顶级数学期刊的编辑克莱尔的注意。同年，他还会有20多篇论文被克莱尔接受。”女巫说，“也许会这样，但是首先，为了他念大学的资费，他的母亲将不得不接受一笔来自皇家‘贫困基金’的微不足道的钱。”一个带着浓重美国口音的仙女说，“那又怎样？不久洪堡大学将为他争取到一笔来自皇家科学基金会的每年250美元的拨款，并且会按需续期。”女巫反驳道，“好，但是这笔津贴的支付和续期的不确定性将会折磨和羞辱他的余生。”下一位仙女说，“没关系，数学界的顶尖人物之一，高斯, 将会邀请仍是大学一年级学生的他去参观哥廷根大学，自此，他不仅将对自己所做的工作产生浓厚兴趣，而且生活幸福。雅可比决心让他成为一名‘私人讲师’并且急于减少官僚主义的繁文缛节，安排他去布莱斯劳地区的库默尔手中接受荣誉博士学位：这对一个大学二年级学生来说肯定是前所未有的恩惠！当高斯为狄利克雷提名一个人人梦寐以求的荣誉时，让人们知道他在狄利克雷和年轻的爱森斯坦之间‘差点犹豫不决’。”女巫冷笑着惊呼道，“这对他有很大的好处！这会让雅可比非常愤怒，以至于他会在克莱尔杂志上一个完全没有根据的脚注中指责你们的挚爱剽窃。”另一个善良的仙女说: “如果冲动的雅可比被激怒了，谁知道他会做些什么呢？这件事会使这个年轻人痛苦一阵子，但是不会对他造成进一步伤害。不久他将成为一名私人讲师，伟大的黎曼将成为他的学生。”“很快, 黎曼将移居到哥廷根并且忘记老师教给他的所有数论。同时, 克罗内克和爱德华·海涅（Eduard Heine）将离开柏林大学, 自此这个年轻人将没有任何志趣相投的朋友或同伴而孤身一人。”有一个仙女认为高斯的名字有一种可以让恶毒生物安静下来的属性，“1847年，伟大的高斯会为自己学生的论文写一篇非常令人赞叹的前言。”女巫轻蔑地回答道：“几乎没有人会读到它。接着，在1848年的革命动乱中他会被普鲁士士兵毒打得很惨，以至于他将不得不卧床休养一个星期；在接下来的两年里，他什么也不会发表。
%% '红色'的名声将成为标签一直伴随他，并且威胁到他的薪水和职业生涯。
”

“那两年里他不会一直愚蠢，尽管面临种种沮丧和疾病，在1850年出版的作品将展示他实力的巅峰。而狄利克雷将征得雅可比的同意，提议他成为柏林科学院院士，1852年，这个未满29岁的年轻人将最终被选为雅可比的继承人。”女巫得意地说，“然后他会去世。”一个小仙女说，“但是他的名字会流传下来。”女巫说，“几乎不可能。按照学术惯例，狄利克雷将向科学院朗读雅可比所作的优美动人的悼词，库默尔将为狄利克雷做同样的事情。但是科学院里没有人会为于1852年去世的年轻人而悲伤。他们也不太愿意为出版他的作品提供经费，因为需要为雅可比、狄利克雷、施泰纳的著作出版投人充足的经费，之后是资助魏尔斯特拉斯和克罗内克的作品。他将会被永远遗忘。”最后一个仙女小声说，“这很幸运，你让我想起了克罗内克。你的诅咒使他忘记自己幼年的同伴数年，但是我会使他在为时已晚之前，重新发现他朋友的作品，并且他会将此作为德国数学学会开幕式的主要演讲主题。”女巫大笑道：“太迟了！我会杀掉克罗内克的妻子，他会取消演讲。”“他会主动写下来。” “在他这么做之前，我也会杀了他。然后那个我甚至不想说出来的名字，也将被彻底遗忘。”再也没有仙女了，但是伽内什有最后的发言权：“你忘了，他说过，你的所有诅咒都是暂时的, 一百五十年后, 它们的力量将被耗尽。”
\end{mdframed}

算术基本定理在高斯整数、$\mathbb{Z}[\sqrt{-2}]$、$\mathbb{Z}[\omega]$上成立是幸运的。一般来说它是不成立的。例如$\mathbb{Z}[\sqrt{-5}]$上的反例$6 = 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})$。我们可以证明$2, 3, 1 \pm i\sqrt{5}$都是不可分的。否则假设2可以分解为$(a + bi\sqrt{5})(c + di\sqrt{5})$，两边取范数：

\[
4 = N(2) = N(a + bi\sqrt{5})N(c + di\sqrt{5}) = (a^2 + 5b^2)(c^2 + 5d^2）
\]

首先可以排除$a^2 + 5b^2 = c^2 + 5d^2 = 2$的情况，因为此时$a, b, c, d$没有整数解。只能是$a^2 + 5b^2 = 1$或$c^2 + 5d^2 = 1$。范数为1对应单位元，另一个和2相伴。因此2不可分解。同样可证3不可分解。\cref{qn:1-n-delta-irreducible}要求用同样的方法证明$1 \pm i\sqrt{5}$不可分解。因此$6 = 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})$的确有两种分解方式。库默尔为此引入了理想数来挽救唯一分解，这在戴德金手中发展成了抽象武器——理想。

\section{理想}
\index{理想}
这是北京市东城区高中一年级数学第一课《集合》的一道习题。

\begin{mdframed}
若非空数集$I, P$满足：

\begin{enumerate}[(i)]
\item 对任意的$x \in I$，有$x \in P$；
\item 对任意的$x, y \in I$，有$x + y \in I$；
\item 对任意的$x \in I$且对任意的$y \in P$，有$xy \in I$；
\end{enumerate}

则称$I$是$P$的“理想子集”。给出下列四个结论：

\begin{enumerate}[(a)]
%%   \renewcommand{\labelenumi}{\textcircled{\theenumi}}
\item 若$I = \{2k | k \in \mathbb{Z} \}$，则$I$是$\mathbb{Z}$的“理想子集”；
\item 若$I$是$\mathbb{R}$的“理想子集”，且存在非零实数$a \in I$，则$I = \mathbb{R}$；
\item 若$I_1, I_2$是$P$的“理想子集”，则$I_1 \cup I_2$也是$P$的“理想子集”；
\item 若$I_1, I_2$是$P$的“理想子集”，则$I_1 \cap I_2$也是$P$的“理想子集”。
\end{enumerate}

其中正确结论的序号是$\underline{\qquad \qquad}$

\end{mdframed}

这道题目只用最基本的集合论知识就能解答。其中第(i)条性质说$I$是$P$的子集；第(ii)条性质说$I$中的加法是封闭的，即$I$中的任何两个数的和还在$I$中；第(iii)条最抽象，它说用$P$中的任何$y$去缩放$I$中的任何$x$，结果$xy$还在$I$中。形象地说就是$I$对于缩放$P$封闭。我们接下来看4个选项。选项(a)中的$I$是全体偶数，任何偶数都是整数，所以(i)成立；偶数加偶数还是偶数，所以(ii)成立；偶数乘以任何整数还是偶数，所以(iii)成立。这样偶数的确是整数的“理想子集”，(a)正确。选项(b)抽象不好理解。这里的关键问题是1是否在$I$中？因为$a \ne 0$，所以倒数$\dfrac{1}{a} \in \mathbb{R}$存在。现在$a \in I, \dfrac{1}{a} \in \mathbb{R}$，根据性质(iii)，$a\dfrac{1}{a} = 1 \in I$。一旦1在$I$中，任何实数$x \in \mathbb{R}$根据性质(iii)都有$1 \cdot x = x \in I$。因此$\mathbb{R}$就是$I$的子集，但性质(i)又说$I$是$\mathbb{R}$的子集，所以只能是$I = \mathbb{R}$，(b)正确。我们不妨用具体的例子来判断选项(c)，仿照(a)中偶数的例子，令$I_1 = \{2k | k \in \mathbb{Z} \}, I_2 = \{5k | k \in \mathbb{Z} \}$，不难验证$I_2$，也就是5的倍数也是“理想子集”。它们的并集包含偶数或5的倍数，即$\{ \dotsc, 0, 2, 4, 5, 6, \dotsc\}$。我们立即发现$2 + 5 = 7$不在这个集合中。加法不封闭了，这违反了性质(ii)，(c)错误。选项(d)把并集换成了交集。用同样的例子，$I_1$是偶数$I_2$是5的倍数，交集包含所有偶的5的倍数，即$\{\dotsc, -10, 0, 10, 20, \dotsc\}$。不难验证它是理想子集。但光验证还不够，我们需要严格证明它是对的。

\begin{proof}
任何$x \in I_1 \cap I_2$有$x \in I_1 \subseteq P$，所以(i)满足。任何$x, y \in I_1 \cap I_2$有$x, y \in I_1$，因$I_1$是“理想子集”，所以$x + y \in I_1$。另一方面也有$x, y \in I_2$，因$I_2$也是“理想子集”，所以$x + y \in I_2$。这样$x + y$既在$I_1$中也在$I_2$中，所以$x + y \in I_1 \cap I_2$。这样就证明了$I_1 \cap I_2$对加法封闭，满足(ii)。最后，任何$x \in I_1 \cap I_2, y \in P$有$x \in I_1$，因$I_1$是“理想子集”，所以$xy \in I_1$。另一方面也有$x \in I_2$，因$I_2$也是“理想子集”，所以$xy \in I_2$。这样$xy$既在$I_1$中也在$I_2$中，所以$xy \in I_1 \cap I_2$。这样就证明了性质(iii)。综上$I_1 \cap I_2$是“理想子集”。
\end{proof}

最后正确结论的序号是：$\underline{(a), (b), (d)}$。

\index{环} \index{主理想}
这道题目意义非凡。它正是戴德金对理想的定义！唯一额外要求是戴德金需要父集合$P$是一个“环”（ring），简单来说，就是定义了加法和乘法，并且含有0、1、正、负元素的集合\footnote{具体来说，要求满足加法、乘法的结合律、交换律，分配律，包含0、1、正、负元素。普通整数、高斯整数、二次整数都是环。由于包含负数，理想对加减法都封闭。}。我们以后用英文字母$R$来表示这个父集合。面对不唯一的分解$6 = 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})$，库默尔提出存在一种“理想数”，能够继续对$2, 3, 1 \pm i\sqrt{5}$分解。并且最终理想数的分解是唯一的。但究竟什么是理想数？戴德金的回答令人吃惊，理想(ideal)不再是具体的一个数，而是数的集合，并且是无穷集合！比如上面例子中的所有偶数，它们都是2的倍数，记为$(2)$，所有5的倍数记为$(5)$。如果一个理想$I$是某个$a$的倍数的集合，就叫做\underdot{主理想}（principle ideal），记作$(a)$。这和我们此前定义数的方式大相径庭。历史上第一个用集合来定义数的人是逻辑学家弗雷格。我们知道数具有抽象的含义。3可以代表3个人、三个鸡蛋、图形中的三角等等，这些类\footnote{弗雷格的工作在康托尔之前，他当时使用了“类”（class）一词。康托尔后来使用了德语中的“集合”。}都有三个元素，用哪一个来代表自然数3呢？弗雷格的意见是：全部。即所有能和上述类一一对应的类所组成的、无穷的、抽象的类来定义自然数3。弗雷格的这一定义看起来有些复杂，但是很了不起。它突破了文化背景的限制。不管你是使用何种语言，何种符号，按照弗雷格的方法，对数字3的理解都不会有歧义。

\index{弗雷格}
\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.9]{img/Frege}
 \caption{戈特洛布·弗雷格(1848-1925)}
 \label{fig:Frege}
\end{figure}

理想究竟是怎样挽救唯一分解的呢？戴德金首先使用理想的语言重新定义了除法和最大公约数等概念。在普通整数中，我们说2整除6，3整除6，2和3的最大公约数是$(2, 3) = 1$。我们看一看理想$(2), (3), (6)$的关系：(2)包括所有偶数，(6)包括所有6的倍数，偶数包含所有6的倍数，即(2)包含(6)；理想(3)包含所有3的倍数，自然也包含所有6的倍数，所以(3)包含(6)。

\btab{c||c}
2整除6 & 3整除6 \\
(2)包含(6) & (3)包含(6)
\etab

这样理想的包含对应着整数的整除，用一句话概括就是\underdot{整除即包含}。我们可以证明这一结论：

\begin{proposition}
如果$a$整除$b$，则理想$(a)$包含理想$(b)$。
\end{proposition}

\begin{proof}
由整除的定义，存在$c$使得$ac = b$。任何$x \in (b)$可表示为：
\begin{align*}
x &= bk  &&\text{其中}k \in R \\
  &= ack &&\text{整除的定义} \\
  &= ak' \in (a) &&\text{令}k' = ck \in R \qedhere
\end{align*}
\end{proof}

\index{理想!和}
接下来考虑最大公约数。定义理想间的加法为：$I_1 + I_2 = \{a + b | a \in I_1, b \in I_2\}$（\ref{qn:sum-of-ideals}要求证明理想的和仍是理想）。这样在上面的例子中，理想的和为：

\[
(2) + (3) = \{a + b| a \in (2), b \in (3)\} = \{2x + 3y | x, y \in \mathbb{Z} \}
\]

这是由2和3产生出来的数构成的集合，我们也用符号$(2, 3)$表示理想的和。你也许联想到了最大公约数的符号。如果2和3的最大公约数是$d = (2, 3) = 1$，根据定义$d$整除2也整除3，所以$d$整除任何$2x + 3y$。这样理想的和就是$(d)$，也就是(1)。

\[
(2) + (3) = \{2x + 3y\} = \{dk | k \in \mathbb{Z}\} = (d) = (1)
\]

我们把这条结论归纳如下。
\begin{proposition}
如果$a, b$的最大公约数为$d = (a, b)$，则$(a) + (b) = (d)$。
\end{proposition}

\begin{proof}
根据定义：
\begin{align*}
(a) + (b) &= \{ax + by | x, y \in R\} \\
  &= \{dmx + dny | m, n, x, y \in R\} && d\text{是最大公约数，令}a = dm, b = dn \\
  &= \{d(mx + ny) | m, n, x, y \in R\} && \text{令}k = mx + ny \\
  &= \{dk | k \in R \} = (d) && \qedhere
\end{align*}
\end{proof}

显然任何整数$a$都可生成主理想$(a)$，也就是$a$的倍数的集合（\cref{qn:trivial-ideals}要求思考(0)和(1)）。但整数中的任何理想都是主理想么？这个问题相当于任何理想都等价于某个整数$a$的倍数集合么？

\begin{proposition}
整数中的任何理想都是主理想。
\end{proposition}

\begin{proof}
对整数中的任何理想$I$，找出其中绝对值最小的非零元素$b$。整数绝对值的性质保证了若$I \ne (0)$则$b$存在。我们声称$I = (b)$。否则若存在某个元素$a \in I$，但$a \notin (b)$，由欧几里得算法$r = a - bq$，并且$|r| < |b|$。根据理想的定义$a \in I, bq \in I$，所以$r = a - bq \in I$。但$r$的绝对值小于$b$的绝对值，由于我们选择的$b$是绝对值\underdot{最小}的非零元素，因此只能有$r = 0$，即$b$整除$a$。
\end{proof}

我们看到绝对值和存在欧几里得算法在证明中的关键作用。用类似的办法，我们也可以证明高斯整数中的任何理想都是主理想。

\begin{proposition}
高斯整数中的任何理想都是主理想。
\end{proposition}

\begin{proof}
对高斯整数中的任何理想$I$，找出其中范数最小的非零元素$\beta$。高斯整数范数的性质保证了若$I \ne (0)$则$\beta$存在。我们声称$I = (\beta)$。否则若存在某个元素$\alpha \in I$，但$a \notin (\beta)$，由欧几里得算法$\gamma = \alpha - \beta \rho$，并且范数$N(\gamma) < N(\beta)$。根据理想的定义$\alpha \in I, \beta \rho \in I$，所以$\gamma = \alpha - \beta \rho \in I$。但$\gamma$的范数小于$\beta$的范数，由于我们选择的$\beta$是范数\underdot{最小}的非零元，因此只能有$\gamma = 0$，即$\beta$整除$\alpha$。
\end{proof}

这个结论还有对应的几何意义。任何高斯整数$\beta$的倍数$\rho \beta$是边长为$|\beta|$正方形网格。而$\beta$的倍数恰恰是理想$(\beta)$。特别地，理想$(1)$是边长为1的正方形网格。高斯整数中所有理想对应的网格都是正方形，都和(1)相似，如\cref{fig:zi}所示。同样的结论对$\mathbb{Z}[\sqrt{-2}]$也成立。任何$\beta$的倍数都是长$\sqrt{2}|\beta|$宽$|\beta|$的矩形。$\mathbb{Z}[\sqrt{-2}]$中所有理想都是主理想，都对应着相似的矩形网格（长宽比为$\sqrt{2}$，如\cref{fig:Z-sqrt-2}所示）。

但$\mathbb{Z}[\sqrt{-5}]$就不同了，它包含着不相似的网格。唯一分解在$\mathbb{Z}[\sqrt{-5}]$上失效，存在反例$6 = 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})$。我们考虑理想的和：

\begin{align*}
A &= (2) + (1 + i\sqrt{5}) = \{2\alpha + (1 + i\sqrt{5})\beta | \alpha, \beta \in \mathbb{Z}[\sqrt{-5}]\} \\
  &= \{2(a + bi\sqrt{5}) + (1 + i\sqrt{5})(c + di\sqrt{5}) | a, b, c, d \in \mathbb{Z}\} \\
  &= \{(2a + c - 5d) + (2b + c + d)i\sqrt{5} | a, b, c, d \in \mathbb{Z} \} \\
  &= \{2(a - b - 3d) + (2b + c + d)(1 + i\sqrt{5}) | a, b, c, d \in \mathbb{Z} \} \\
  &= \{2m + (1 + i\sqrt{5})n | m, n \in \mathbb{Z} \} \\
  &= (2, 1 + i\sqrt{5}) && \text{由}2, 1+ i\sqrt{5}\text{产生的数}
\end{align*}

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.3]{img/ideal-sum}
 \caption{灰色矩形网格为$\mathbb{Z}{\sqrt{-5}}$中的整数，黑色三角形网格为$(2, 1 + i\sqrt{5})$。}
 \label{fig:ideal-sum}
\end{figure}

在整数和高斯整数中，任何理想都是主理想，所以理想的和也是主理想。但$A = (2, 1 + i\sqrt{5})$却不是主理想。否则假设它是$(\gamma)$，因为2在这个理想中，所以$\gamma$整除2。但我们之前分析过2是不可分解的，因此$\gamma$只能是单位元或2的相伴元。另一方面$1 + i\sqrt{5}$也在这个理想中，所以$\gamma$整除$1 + i\sqrt{5}$。但$1 + i\sqrt{5}$也不可分解（见\cref{qn:1-n-delta-irreducible}），因此$\gamma$只能是单位元或$1 + i\sqrt{5}$的相伴元。这样综合下来$\gamma$只能是单位元。但是$\pm 1$却不在$(2, 1 + i\sqrt{5})$中，否则假设：

\begin{align*}
\pm 1 &= 2m + (1 + i\sqrt{5})n &&m, n\text{是整数} \\
  &= 2m + n + ni\sqrt{5}
\end{align*}

由实部虚部分别相等有：

\begin{align*}
\pm 1 &= 2m + n & n = 0
\end{align*}

得$m = \pm\dfrac{1}{2}$，与$m$是整数矛盾。因此$A = (2, 1 + i\sqrt{5})$不是主理想。它的网格形状不是矩形而是三角形，如\cref{fig:ideal-sum}所示。尽管不是主理想，但是$A$表现得像“最大公约数”。根据“整除即包含”，$A$包含(2)，它表现得像2的因子，同时$A$包含$(1 + i\sqrt{5})$，它也表现得像$1 + i\sqrt{5}$的因子，因此$A$表现得像2与$1 + i\sqrt{5}$的最大公因子（类比整数和高斯整数，若$a, b$的最大公约数为$d = (a, b)$，则$(a) + (b) = (d)$）。

不仅如此，$A$还表现得像素数。为此我们先观察一下普通素数$p$在整数中的主理想$(p)$有什么特点。首先$p \ne 1$。而(1)实际上是全体整数（见\cref{qn:trivial-ideals}），理想$(p)$的确不是全体整数，因为1不在其中。其次$p$只能被1和它自己整除，根据“整除即包含”，只有代表全体整数的(1)包含$(p)$，再没有其它理想包含$(p)$了。$A$也是如此，首先它不是(1)，我们此前证明了$1 \notin A$。其次除了(1)外没有任何理想包含$A$，否则假设存在一个理想$I$包含$A$且$I$中还有不在$A$中的元素，形如$\alpha = 2m + 1 + n(1 + i\sqrt{5})$。但是$\alpha - 1 = 2m + n(1 + i\sqrt{5})$就属于$A$了。取相反数$1 - \alpha$也属于$A$（见\cref{qn:zero-in-ideal}）。现在$\alpha \in I, 1 - \alpha \in A \subset I$，根据理想的定义$\alpha + (1 - \alpha) = 1 \in I$。于是$I = (1)$。

用同样的方法，我们也可以证明$\overline{A} = (2, 1 - i\sqrt{5})$表现得像素数。我们特意选用了共轭复数的符号，因为$\overline{A}$中的数恰好是$A$中的共轭复数。我们还可以利用$6 = 2 \times 3 = (1 + i\sqrt{5})(1 - i\sqrt{5})$的四个因子构造出四个类似的理想：

\begin{align*}
A &= (2, 1 - i\sqrt{5})  & \overline{A} &= (2, 1 - i\sqrt{5}) &
B &= (3, 1 - i\sqrt{5})  & \overline{B} &= (3, 1 - i\sqrt{5})
\end{align*}

\index{理想!积}
戴德金在1871年定义了理想间的乘积。如果$A, B$是理想，则：

\[
AB = \{a_1b_1 + a_2b_2 + \dotsb + a_kb_k\}
\]

其中$a_1, a_2, \dotsc, a_k \in A, b_1, b_2, \dotsc, b_k \in B$是各自理想中的元素。这样如果理想$C = AB$，则理想$A$整除理想$C$。根据戴德金的这个定义，主理想的乘积也是主理想，即$(a)(b) = (ab)$。因此$(a)$整除$(ab)$。例如$(2)(3) = (6)$，理想$(2)$整除$(6)$与整数的整除对应。如果理想$A$由$(a, b)$产生，理想$B$由$(c, d)$产生，则$AB = (ac, ad, bc, bd)$（见\cref{qn:ideal-product}）。我们接下来计算一下$A\overline{A}$的结果：

\index{理想分解}
\[
A\overline{A} = (2, 1 + i\sqrt{5})(2, 1 - i\sqrt{5}) = (4, 2 + 2i\sqrt{5}, 2 - 2i\sqrt{5}, 6)
\]

其中$4, 6, 2 \pm 2i\sqrt{5}$都能被2整除。根据“整除即包含”，主理想$(2)$包含$A\overline{A}$。另一方面，$4 \in A\overline{A}, 6 \in A\overline{A}$，所以$6 - 4 = 2 \in A\overline{A}$。这样$(2)$又被$A\overline{A}$包含。因此只能是$A\overline{A} = (2)$。用同样的方法我们可以证明$B\overline{B} = (3)$。我们再计算乘积$AB$的结果：

\[
AB = (2, 1 + i\sqrt{5})(3, 1 + i\sqrt{5}) = (6, 2 + 2i\sqrt{5}, 3 + 3i\sqrt{5}, (1 + i\sqrt{5})^2)
\]

其中$6, 2 + 2i\sqrt{5}, 3 + 3i\sqrt{5}, (1 + i\sqrt{5})^2$每个都能被$(1 + i\sqrt{5})$整除。根据“整除即包含”，主理想$(1 + i\sqrt{5})$包含$AB$。另一方面，$3 + 3i\sqrt{5} \in AB, 2 + 2i\sqrt{5} \in AB$，所以差$1 + i\sqrt{5} \in AB$。这样$(1 + i\sqrt{5})$又被$AB$包含。因此只能是$AB = (1 + i\sqrt{5})$。用同样的方法我们可以证明$\overline{AB} = (1 - i\sqrt{5})$。把这些结果放到一起就得到：

\[
(6) = (2)(3) = (A\overline{A})(B\overline{B}) = (AB)(\overline{AB}) = (1 + i\sqrt{5})(1 - i\sqrt{5})
\]

这样戴德金就用理想挽救了唯一分解。$(6)$被唯一分解为$A\overline{A}B\overline{B}$。

\section{谁更多？}

\index{伽利略悖论}
我们数的旅程逐渐接近尾声。我们一路走来，探寻了自然数、零、整数、有理数、无理数、实数、复数、代数数。这些数有的彼此包含，例如自然数是整数的一部分；也有的是彼此独立，例如有理数和无理数。那么谁更多呢？在数的大家庭中，是否我们生活中常见的数更多，而罕见的数较少？也许生活会欺骗我们，也许直觉靠不住。这个问题的困难之处在于，除了零以外，每种数都有无穷多。无穷有多大？自然是要多大有多大，但这样一来怎样比较呢？举例来说，有人认为偶数只有整数的一半，所以整数更多。但是任何整数乘以2，就得到一个偶数，反之，任何偶数除以2，也对应一个整数。这样看来整数和偶数间一一对应，这两个集合似乎又同样多。究竟是整数多还是偶数多呢？现代科学之父伽利略在1636年提出一个类似的悖论。如果将每个自然数平方，得到的新序列$1, 4, 9, 16, 25, \dotsc$和自然数一一对应。这样看来完全平方数和自然数一样多。可是平方数很稀疏，自然数似乎比平方数多得多。这一矛盾被称为“伽利略悖论”。在几何上人们同样发现了类似的悖论。如\cref{fig:circles-paradox}所示，大圆似乎比小圆包含更多的点。但每条半径把两个同心圆上的点连接起来。大圆上任意一点都一一对应到小圆上的一点。这样看来两个圆上的点似乎同样多。伽利略发现无法解释自然数和平方数孰多孰少后说：因此我们不能说自然数构成一个集合。人们拒绝“全体自然数”这类说法。

\begin{figure}[htbp]
 \centering
   \begin{tikzpicture}[
       scale=0.5,
       circle_style/.style={draw, black, thick}, % 圆的样式：黑色、粗线条
       radius_style/.style={draw, red, thick, ->} % 半径的样式：红色、粗线条、带箭头
   ]

   % 1. 绘制内圆（圆心在坐标原点(0,0)，半径2cm）
   \draw[circle_style] (0,0) circle (2cm);

   % 2. 绘制外圆（同一圆心(0,0)，半径4cm，与内圆同心）
   \draw[circle_style] (0,0) circle (4cm);

   % 3. 绘制半径（从圆心(0,0)指向外圆上的点(4,0)，沿x轴正方向）
   % 注：箭头指向外圆，因此终点坐标需与外圆半径匹配（x=4cm, y=0，即(4,0)）
   \draw[radius_style] (0,0) -- (4,0);

   \fill[black] (0,0) circle (2pt);
   \node[below right] at (0,0) {$O$};
   \node[below right] at (2,0) {$A$};
   \node[above right] at (4,0) {$B$};

   \end{tikzpicture}

 \caption{同心大圆上任意一点都可通过半径对应到小圆上的唯一点}
 \label{fig:circles-paradox}
\end{figure}

\index{集合的势} \index{一一对应}
两百年后，数学家康托尔重新思考了陷入矛盾的一系列悖论，问题的关键在于根深蒂固的常识——整体大于部分，并不适用于抽象的无限概念。康托尔认为，如果接受“部分能够等于整体”的观点，解决问题的大门就打开了。他提出了用一一对应来比较集合大小的方法。康托尔定义：如果能够建立集合$A$和$B$中元素的一一对应关系，那么两个集合具有相同的基数（cardinal number），或者说它们是“等势”的。对于有限集，这一结论显然正确；推广到无限集，根据此定义，偶数和整数同样多，完全平方数和自然数同样多，小圆和大圆上的点也同样多……戴德金干脆这样定义无穷集合：如果一个集合的部分和整体可以具有相同的基数，那么这个集合是无穷集合\cite{Dedekind-1858}。

\index{希尔伯特无穷旅馆}
乔治・伽莫夫1947年在科普著作《从一到无穷大》中讲了一个脍炙人口的故事。这则故事来自数学家希尔伯特在1924年冬季的一次演讲\footnote{希尔伯特的讲稿直到2013年才出版。}。有一个神奇的旅馆，拥有无穷多的房间。在旅游旺季的时候，旅馆住满了客人。这一天晚上，又来了一名客人。要是一般的旅馆，就只能拒绝他入住了。旅店经理希尔伯特说：“没问题，住得下。”他于是指挥客人，让1号房间的客人搬到2号房间去，2号房间的客人搬到3号房间去，3号房间的客人搬到4号房间去……每个房间的客人都搬到下一个房间去。这样就空出了1号房间给新来的客人。

故事没有结束。第二天，旅店迎来了一个神奇的旅游团，它有无穷多的游客。经理希尔伯特又说：“没问题，住得下。”他指挥房间里的客人。让1号房间的客人搬到2号房间去，2号房间的客人搬到4号房间去，3号房间的客人搬到6号房间去……每个房间的客人都搬到房间号2倍的那个房间去。由于酒店有无穷多的房间，所以这样一搬，2, 4, 6, ...偶数房间住着原来的客人；而1, 3, 5, ...奇数房间空出来，有无穷多间。刚好可以让旅游团的人住下。故事更加有趣了。到了第三天，旅馆门前车水马龙，来了无穷多的神奇旅游团，每个旅游团都有无穷多位游客。希尔伯特的无穷旅馆还能住下么？

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.4]{img/Hilbert-hotel-1}
 \caption{希尔伯特无穷旅馆的第一天}
 \label{fig:Hilbert-hotel-1}
\end{figure}

如\cref{fig:Hilbert-hotel-1}所示，在第一天的故事中，每个客人搬到下一个房间去，从而空出1号房间。这建立了图中上下两行灰色圆形之间的一种对应关系$n \leftrightarrow n+1$。不仅如此，即使来了$k$位新客人，我们可以重复这一“腾笼换鸟”的过程$k$次，仍然能够让他们入住。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.4]{img/Hilbert-hotel-2}
 \caption{希尔伯特无穷旅馆的第二天}
 \label{fig:Hilbert-hotel-2}
\end{figure}

第二天的故事如\cref{fig:Hilbert-hotel-2}所示，我们实际上建立了自然数到偶数间的一一映射，从而空出了无穷多奇数房间，而这些空房间又和旅游团的无穷多位客人建立了一一映射，这恰好是奇数到自然数间的一一映射。要想解决希尔伯特旅馆第三天的问题，我们需要在无穷个无穷旅游团和无穷个房间之间建立一一对应。有人说，可以先让第一个旅游团依次入住1, 2, ...号房间，然后让第二个旅游团的第一个客人住在$\infty + 1$号房间，第二个客人住$\infty + 2$号房间……以此类推。但这样的思路行不通。考虑安排客人的过程，第二个旅游团的第一名客人永远不知道第一个旅游团何时入住完，因而无法确定自己应该搬入哪间房。反之，在第一天的故事中，一旦1号房间的客人搬入2号房间，新客人就可以立即入住。尽管每位客人依次搬入下一个房间是一个无穷无尽的过程。第二天的故事也是如此，原1号房间的客人一旦搬到2号房间，旅游团中的第一名客人可以立即搬入空出来的1号房间了，接下来原2号房间的客人搬到4号房间，原3号房间的客人搬到6号房间，此时旅游团中的第2名客人可以立即搬入3号房间了……

\begin{figure}[htbp]
\centering
\begin{tikzpicture}
  \draw[step=1, very thin, gray] (0, 0) grid (5, 5);
  \draw[->] (-0.25, 0) -- (6, 0) coordinate (x axis);
  \draw[->] (0, -0.25) -- (0, 6) coordinate (y axis);
  \foreach \x in {0, 1, 2, 3, 4, 5}
    \path (\x, -0.25) node[left] {\x};
  \foreach \y in {1, 2, 3, 4, 5}
    \path (-0.25, \y) node[below] {\y};
  \foreach \i / \x / \y in {0/0/0, 1/1/0, 2/0/1, 3/0/2, 4/1/1, 5/2/0, 6/3/0, 7/2/1, 8/1/2, 9/0/3, 10/0/4}{
    \path (\x, \y) coordinate (N\i);
    \fill (N\i) circle (1pt) node[above right=3pt of N\i] {\i};
  }
  \foreach \i in {0,...,9} {
    \pgfmathsetmacro{\j}{\i+1}
    \draw[-latex, thick] (N\i) to (N\j);
  }
\end{tikzpicture}
\caption{对无穷个无穷的一种编号方案}
\label{fig:NNtoN}
\end{figure}

\cref{fig:NNtoN}给出了一种编号方案。为了方便，我们让每个旅游团的第一个客人编号为0，第二个客人编号为1，第三个客人编号为2……，我们把已经在旅馆中入住的客人编号为0号旅游团，新来的第一个旅游团编号为1号团，第二个旅游团编号为2号团……在这个图中，每个客人就对应无穷伸展的方格子中的一个点。同样我们让旅馆的房间号也从0开始。现在我们按照这个顺序安排入住：第0号团的第0号客人入住0号房间，第0号团的第1号客人入住1号房间，第1号团的第0号客人入住第2号房间，第2号团的第0号客人入住3号房间，第1号团的第1号客人入住4号房间……这样按照图中往返画“之”字形，就可以逐一、并且毫无遗漏地安排每个客人入住。我们在无穷个旅游团的每个客人和无穷个房间之间建立了一一映射。希尔伯特的旅馆神奇地容纳了“二维”的无穷\footnote{还有一种解法使用了欧几里得证明的素数有无穷多的结论。将酒店中每个奇数房间$i$的客人安排到$2^i$房间去。然后将第一个旅游团的每个客人安排到$3^n$房间去，将第二个旅游团的每个客人安排到$5^n$的房间，...第$k$个旅游观的每个客人安排到$p^n$房间去，其中$p$是第$k$个素数。这一解法的缺点是有空房间。例如15号，没有客人入住。}。

\subsection{一一对应与无穷集合}

希尔伯特神奇旅馆的故事让人感到吃惊。自然数不仅和它的子集奇数和偶数同样多，并且一维的自然数$n$和二维的自然数对$(m, n)$也同样多。我们可以从自然数开始，利用一一对应，扩展出一系列的无穷集合。

\begin{enumerate}[(1)]
\item \textbf{整数}。如果建立一一对应：

\begin{tabular}{ccccccccc}
0 & 1 & -1 & 2 & -2 & ... & $n$ & $-n$ & ... \\
$\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & & $\updownarrow$ & $\updownarrow$ & \\
0 & 1 &  2 & 3 &  4 & ... & $2n - 1$ & $2n$ & ... \\
\end{tabular}

这样就把整数和自然数对应起来。换一种角度，我们实际上用奇自然数对应了全部正整数，用偶自然数对应了零和全部负整数。这说明整数和自然数一样多。换言之，我们可以用自然数构造整数。

\item \textbf{有理数}。有理数可以写成$p/q$的形式，其中$q \ne 0$。仿照希尔伯特旅馆第三天的故事，可以在数偶$(p, q)$和自然数之间建立一一对应。我们只要稍作修改就可以建立有理数$p/q$和自然数间的一一对应。先不考虑负数，每当遇到第二个数$q = 0$就跳过，如果$p/q$不是既约分数（含有公因子）就跳过。然后复用(1)中的方法，再把负有理数包含进来，这样就从自然数构造出了有理数。下表给出了前几个自然数到有理数的对应关系：

\begin{tabular}{cccccccccc}
0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & ... \\
$\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & $\updownarrow$ & \\
0 & 1 & $\dfrac{1}{2}$ & $-\dfrac{1}{2}$ & -1 & -2 & $-\dfrac{2}{3}$ & $-\dfrac{1}{3}$ & $\dfrac{1}{3}$ & ... \\
\end{tabular}

这说明自然数和有理数同样多。

\index{代数数}
\item \textbf{代数数}是代数方程的解。对代数方程：

\[
a_0 x^n + a_1 x^{n-1} + \dotsb + a_n = 0
\]

其中$a_0 \ne 0, a_1, \dotsc, a_n$都是整数，构造正整数：

\[
h = n + |a_0| + |a_1| + ... + |a_n|
\]

它是次数和方程系数绝对值的和。称$h$为方程的高，它总是一个确定的自然数。反之，任给自然数$h$，对应的方程却不止一个。例如$x - 3 = 0, x^3 + 1 = 0, x^3 - 1 = 0, x^2 \pm x + 1 = 0$的高都是4。但对于固定的$h$，以它为高的代数方程只有有限多个。因此我们可以把所有的代数方程枚举出来，先枚举$h=1$的代数方程，再枚举$h=2$的代数方程……如此下去。当然，高同样的方程可以按任意顺序排列。根据代数基本定理，方程复数根的个数等于次数$n$。若考虑重根，则不同的根不超过$n$个。为了枚举代数数，首先把高$h=1$的代数方程（只有一个$x = 0$）的根枚举出，就是0，再把高为2的方程的所有根枚举出。不同方程的根可能是相等的，如果遇到已经枚举过的根就跳过。这样就把代数数同自然数一一对应起来了。因此自然数和代数数同样多，我们可以通过自然数扩展出代数数。
\end{enumerate}

\subsection{可数无穷与不可数无穷}
\index{可数集}
接下来我们遇到了难题：能否从自然数扩展出实数？包括无理数以及$\pi$，$e$这样的超越数？通过一一对应，可以从自然数扩展出整数、有理数、包含部分无理数的代数数。它们都和自然数间存在一一映射，和自然数一样多。我们把和自然数等势的无穷集合叫作\underdot{可数}无穷。是不是所有的无穷集合都是可数的呢？是否存在更大的无穷呢？1873年11月29日康托尔给戴德金的一封信中提到了这个问题：“取所有的自然数集合，记为$\mathbb{N}$，然后考虑所有实数的集合，记为$\mathbb{R}$。简单来说，问题就是两者是否能够对应起来，使得一个集中的每一个体只对应另一集中一个唯一的个体？乍一看，我们可以说答案是否定的，这种对应不可能，因为前者由离散的部分组成，而后者则构成一个连续统。但从这种说法里我们什么也得不到。虽然我非常倾向认为这两者不能有这样的一个一一对应，但是我找不出理由，我对这事极为关注，也许这理由非常简单。”

\index{对角线证明}
一个星期后的12月7日，在写给戴德金的信中，康托尔自己回答了这个问题，他发现实数集合不能和自然数集合构成一一对应。这一天可以看作是集合论的诞生日。康托尔曾经给出过两个证明，其中第二个证明最为脍炙人口，称为“对角线证明”。使用反证法，假设区间$(0, 1)$上的全部实数是可数的，可以和自然数一一对应。那么就可以把这个区间里的全部实数列出来$a_0, a_1, a_2, \dotsc, a_n, \dotsc$。将序列中的每个实数表示成小数形式。如果是无理数，它的小数形式是无限不循环的；如果是除不尽的分数，则其小数形式是无限循环的，例如$\dfrac{1}{3} = 0.333\dotsm$；如果能够除尽，利用引理\ref{th:cycle-of-9}，把它变成无限循环小数，例如$\dfrac{1}{2} = 0.5 = 0.4999\dotsm$。于是区间$(0, 1)$中的所有实数可以排成下面的序列：

\begin{align*}
a_0 &= 0.a_{00}a_{01}a_{02}a_{03}\dotsm\\
a_1 &= 0.a_{10}a_{11}a_{12}a_{13}\dotsm\\
a_2 &= 0.a_{20}a_{21}a_{22}a_{23}\dotsm\\
a_3 &= 0.a_{30}a_{31}a_{32}a_{33}\dotsm\\
    &\dotso \\
a_n &= 0.a_{n0}a_{n1}a_{n2}a_{n3}\dotsm\\
    &\dotso
\end{align*}

注意$a_0, a_1, a_2, \dotsc$并不一定是按照大小次序排列的。接下来康托尔构造一个数$b = 0.b_0b_1b_2b_3 \dotsm b_n \dotsm$，它的第$n$位数字$b_n \neq a_{nn}$。为了做到这一点，可以规定：若$a_{nn} \neq 5$，就让$b_n = 5$，否则就让$b_n = 6$。这样构造出的$b$一定不等于上述序列中的任何一个数，因为它和第$n$个数的第$n$位数字不相同，也就是对角线上的数字不同。如下方的黑体字所示：

\begin{align*}
a_0 &= 0.\pmb{a_{00}}a_{01}a_{02}a_{03}\dotsm \\
a_1 &= 0.a_{10}\pmb{a_{11}}a_{12}a_{13}\dotsm \\
a_2 &= 0.a_{20}a_{21}\pmb{a_{22}}a_{23}\dotsm \\
a_3 &= 0.a_{30}a_{31}a_{32}\pmb{a_{33}}\dotsm \\
    &\dotso \\
a_n &= 0.a_{n0}a_{n1}a_{n2}a_{n3} \dotsm \pmb{a_{nn}}\dotsm \\
    &\dotso
\end{align*}

此前假设$(0, 1)$间的所有实数都被列出了，无一遗漏。但$b$显然属于这一区间，却被遗漏了，它不等于任何一个$a_i$，导致了矛盾。因此假设不成立，我们无法把$(0, 1)$间的所有实数和自然数之间构造一一映射。有人说，把$b$加进$a_0, a_1, a_2, \dotsc$中不就可以了么？假设$b$加进去后，处于第$m$个位置，我们仍然可以再次构造一个新数$c$，只要让它的第$m$位不等于$b_m$就又出现了一个没有被包含的数。

\index{不可数集}
康托尔的证明简单直观，揭示了一个惊人的事实：$(0, 1)$间的实数集是不可数的！它是比自然数集更大的无穷集合。柯朗和罗宾在《什么是数学》中给出了另一个直观的几何证明。假设单位线段$(0, 1)$之间的点能排成可数的序列$a_1, a_2, a_3, \dotsc$用一个长1/10的区间盖住$a_1$点，用长1/100的区间盖住$a_2$点……用长$1/10^n$的区间盖住$a_n$点，如此下去，则单位线段$(0, 1)$将完全被长为1/10, 1/100, 1/1000……的子区间（可能相互重叠）盖住。但这些子区间的长度总和为等比数列$1/10 + 1/100 + 1/1000 + \dotsb = 1/9 < 1$，让总长度为1/9的区间覆盖长度为1的线段是不可能的。所以假设错误，线段上的点是不可数的\cite{Courant1969}。

接下来，我们构造一一映射：$y = \pi x - \dfrac{\pi}{2}$。它把区间$(0, 1)$中的每个实数映射到区间$(-\dfrac{\pi}{2}, \dfrac{\pi}{2})$中，无一遗漏。因此这一区间内的实数集也是不可数的。我们压上最后一根稻草，再构造一一映射：$y = \tan(x)$。它把区间$-\dfrac{\pi}{2}$到$\dfrac{\pi}{2}$中的每一个实数，无一遗漏地映射到了全体实数集上。还有一种几何方法可以将单位线段一一映射到全体实数上：将单位线段弄弯成为长度为1的半圆弧，然后在圆外画一条无限长的直线$L$。从圆心到$L$上任意一点$P$的连线必然与圆弧相交于一点$Q$。这样就形成了一一映射，如\cref{fig:seg-to-line}所示。据此，康托尔得到了结论：实数集不是可数集，它是比可数集更高等级的无穷。康托尔称之为不可数集。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.6]{img/seg-to-line}
 \caption{将长度为1的半圆弧映射到实数轴}
 \label{fig:seg-to-line}
\end{figure}

\index{连续统假设}
这自然让人联想到线段上的点。在欧几里得《原本》中，点被定义为没有大小的部分，而线被认为由点组成。直线上存在无理数，或者说有理数不能够填充直线，但实数是可以填充直线的。根据上面的证明，单位线段上的点和任何长度线段上的点，以及无限长的直线上的点，也就是和数轴上稠密的点是一样多的，都是不可数集。同心圆上的点也同样多，也都是不可数集。同样令人吃惊的是无理数与有理数的比较。直观上任何两个有理数之间，存在着无穷多的无理数；任何两个无理数之间，也存在着无穷多的有理数，它们似乎一样多。然而康托尔的证明揭示出有理数是可数的，而无理数是不可数的。这说明无理数远远多于有理数。再进一步，由于代数数是可数的，这说明像$\pi, e$这样的超越数是不可数的，它们要远远多于代数数。故事到此并没有划上句号，康托尔思考在自然数的可数无穷与连续统的不可数无穷之间是否存在着其它等级的无穷？这导致了连续统假设的提出。康托尔终其一生屡次努力也没能证明或推翻这一假设。大数学家希尔伯特在1900年的国际数学家大会上把连续统假设列在最重大的23个问题之首。此后经过哥德尔和保罗·寇恩的努力于1968年证明了连续假设和公理集合论系统是彼此独立的。这意味着人们无法在集合论内证明连续统假设的正确性与否。

\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.5]{img/Cantor}
 \caption{格奥尔格·康托尔（1845-1918）}
 \label{fig:Cantor}
\end{figure}

\begin{mdframed}
\index{数学家!康托尔}
康托尔（见\ref{fig:Cantor}）是德国数学家，集合论的创始人。1845年3月3日生于俄罗斯圣彼得堡，他一生的大部分时间是在德国度过的。康托尔的父亲是具有犹太血统的丹麦商人，母亲出身艺术世家。1856年举家迁居德国的法兰克福。尽管康托尔较早就显示出了数学才能，他的父亲却希望他成为一名工程师，因为这样更容易求职和谋生。直到17岁时，康托尔的父亲才逐渐意识到不应该把自己的意见强加给儿子。他得到父亲的允许，进入大学学习数学。康托尔给父亲回信道：“你自己也能体会到你的信使我多么高兴。这封信确定了我的未来……现在我很幸福，因为我看到如果我按照自己的感情选择，不会使你不高兴。我希望你能活到在我身上找到乐趣，亲爱的父亲；从此以后我的灵魂，我整个人，都为我的天职活着；一个人渴望做什么，凡是他的内心强制他去做的，他都会成功！”\cite{HanXueTao16}

1862年，康托尔进入苏黎世大学，1863年转入柏林大学攻读数学和神学，受教于数学家库默尔、魏尔斯特拉斯、克罗内克。1866年曾去哥廷根学习一个学期。1867年他在库默尔的指导下以解决整系数不定方程的论文获得博士学位。当时的数学界正在魏尔斯特拉斯的领导下进行着重建微积分严密基础的运动，康托尔也很快转入这一研究方向。在工作中，他意识到必须研究作为微积分基础的实数点集，这成为了集合论研究的开端。

1872年康托尔在瑞士旅游中偶遇了数学家戴德金。两人后来成为亲密的朋友，常年保持通信。1874年29岁的康托尔发表了关于集合论的第一篇革命性论文。康托尔开始显示他非凡的独创力。在随后的十几年中，他几乎独自一人把集合论推向深入，引领了数学中无穷的革命。在他最伟大的、最具创见的时期，康托尔却没有能得到应有的认可。他没能取得柏林大学的教授职位。他的大部分研究时光是在哈雷大学度过的。这是一所不大出名、薪金微薄的学院。他的成果在当时很难被理解。由于太过颠覆传统，加之无穷集合引发了罗素悖论，人们对集合论的基础和可靠性产生了怀疑（后来策梅罗、弗兰克尔、冯·诺伊曼等人通过公理集合论来避免罗素悖论，今天人们把康托尔的集合论叫做朴素集合论）。康托尔遭到了许多人的反对，其中反对最激烈的是他的老师，柏林学派的代表人物克罗内克。克罗内克有一句名言：“上帝创造了自然数，其余都是人的工作。”他批判康托尔的无穷集合和超限数理论不是数学而是神秘主义，是一类危险的数学疯狂。他认为数学在康托尔的领导下正在走向疯人院。除了克罗内克之外，还有一些著名的数学家也对集合论发表了反对意见，包括法国数学家庞加莱，他说：“我个人，而且还不只我一个人，认为重点在于，切勿引进一些不能用有限个文字去完全定义好的东西。”他把集合论当作一个有趣的“病理学的情形”来谈，并且预测说：“后一代将把集合论当作一种疾病，而人们已经从中恢复过来了”。德国数学家赫尔曼·外尔认为，康托尔关于基数的等级观点是“雾上之雾”。施瓦兹原来是康托尔的好友，但他由于反对集合论而同康托尔断交。

于是悲剧的结局不是集合论进入了疯人院，而是康托尔进入了疯人院。1884年5月，他第一次精神崩溃。在他一生的随后岁月中，这种崩溃以不同强度反复发生，把他从社会上赶进精神病院这个避难所。1904年在两个女儿的陪同下，他出席了第三届国际数学家大会。会上他的精神受到严重刺激，立即被送进医院。在他生命的最后十年，他大都处于严重的抑郁状态中，并在哈雷大学的精神病诊所度过了漫长的岁月。他最后一次住进精神病院是1917年5月，直至1918年1月去世。

在瑞士苏黎世召开的第一届国际数学家大会上，康托尔的集合论得到了公开的承认和称赞。苏黎世理工大学教授胡尔维茨（Hurwitz，Adolf，1859－1919）在综合报告中，明确地阐述康托尔集合论对函数论的进展所起的巨大推动作用，这破天荒第一次向国际数学界显示康托尔的集合论不是可有可无的哲学，而是真正对数学发展起作用的理论工具。在分组会上，法国数学家阿达玛也报告康托尔对他的工作的重要作用。随着时间的推移，人们逐渐认识到集合论的重要性。希尔伯特高度赞誉康托尔的集合论“是数学天才最优秀的作品”，“是人类纯粹智力活动的最高成就之一”，“是这个时代所能夸耀的最巨大的工作”。
\end{mdframed}

\begin{Exercise}[label={ex:algebraic}]
\Question{假设$x^n + y^n = z^n$，证明若$x, y, z$任何两个含有公约数$d$，则第三个也有这个因子。\label{qn:xyz-coprime}}

\Question{证明若首一代数方程$x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0 = 0$存在有理解，则这个解必定是整数。 \label{qn:rational-solution-is-integral}}

\Question{证明范数是可乘的。\label{qn:norm-is-multiplicative}}

\Question{说明二次整数的范数是对应二次方程的常数项。\label{qn:quadratic-norm}}

\Question{如果$a, b$互素，证明共轭的二次整数$a \pm bi\sqrt{m}$互素。\label{qn:coprime-of-conjugates}}

\Question{从范数的共轭定义说明爱森斯坦整数的范数为$a^2 - ab + b^2$。\label{qn:norm-of-z-omega}}

\Question{证明爱森斯坦整数的范数非负。}

\Question{爱森斯坦整数中的单位元是什么？}

\Question{试画出爱森斯坦整数$\rho \beta$的格点。}

\Question{根据爱森斯坦整数的格点，证明欧几里得算法存在。}

\Question{证明$1 \pm i\sqrt{5}$是不可分解的。\label{qn:1-n-delta-irreducible}}

\Question{证明理想的和仍是理想。\label{qn:sum-of-ideals}}

\Question{理想的父集合$R$中包含0和1，并且任何元素$y$的相反数$-y$也在$R$中。证明 (1) 任何理想中都包含0；(2) 如果$a$在理想中，则$-a$也在理想中。\label{qn:zero-in-ideal}}

\Question{(0)叫做零理想，(1)叫做单位理想。它们各自包含了什么元素？\label{qn:trivial-ideals}}

\Question{验证如果理想$A = (a, b) = \{ax + by | x, y \in R\}$，理想$B = (c, d)$，则$AB = (ac, ad, bc, bd)$。\label{qn:ideal-product}}

\Question{我们用\cref{fig:NNtoN}建立了房间和任意旅游团的客人间的一一映射。第$i$号旅游团的第$j$号客人应该入住几号房间？第$k$个房间里住了哪号旅游团的哪位客人？}

\Question{希尔伯特旅馆第三天的故事的解法并不唯一，\cref{fig:PWW-NNtoN}是《无需语言的证明》一书的封面。试根据此图给出另一种编号方案？
\begin{figure}[htbp]
 \centering
 \includegraphics[scale=0.18]{img/PWW}
 \caption{《无需语言的证明》封面局部}
 \label{fig:PWW-NNtoN}
\end{figure}
}

\end{Exercise}

\begin{Answer}[ref={ex:algebraic}]
\Question{假设$x^n + y^n = z^n$，证明若$x, y, z$任何两个含有公约数$d$，则第三个也有这个因子。

\begin{proof}
先证明一个引理：若$a^n$整除$b^n$则$a$整除$b$。由算数基本定理，把$a, b$写成素因子幂的积：

\begin{align*}
a &= p_1^{a_1}p_2^{a_2}\dotsm p_k^{a_k} & b &= p_1^{b_1}p_2^{b_2}\dotsm p_k^{b_k} q_1^{c_1}q_2^{c_2} \dotsm q_m^{c_m}
\end{align*}

其中$p_i$是$a$的所有素因子，$a_i > 0$。这些素因子有的出现在$b$中，有的不在，所以$b_j \geq 0$（等于0则不在）。$q_j$是$b$中独有的素因子，所以$c_j > 0$。对$a, b$取$n$次方。

\begin{align*}
a^n &= p_1^{a_1n}p_2^{a_2n}\dotsm p_k^{a_kn} & b^n &= p_1^{b_1n}p_2^{b_2n}\dotsm p_k^{b_kn} q_1^{c_1n}q_2^{c_2n} \dotsm q_m^{c_mn}
\end{align*}

因为$a^n$整除$b^n$，所以$a_in \leq b_in$，除以$n$有$a_i \leq b_i$。因此$a$整除$b$。

若$d$整除$x$也整除$y$。令$x = da, y = db$，有$z^n = (da)^n + (db)^n = d^n(a^n + b^n)$。这说明$d^n$整除$z^n$。由上面的引理得$d$整除$z$。类似也可以证明若$d$整除$x$和$z$，则$d$也整除$y$。
\end{proof}
}

\Question{证明若首一代数方程$x^n + a_{n-1} x^{n-1} + \dotsb + a_1 x + a_0 = 0$存在有理解，则这个解必定是整数。

\begin{proof}
用反证法，若$x = \dfrac{p}{q}$是有理解，其中$p, q \ne 0$互素，即：
\begin{align*}
0 &= (\frac{p}{q})^n + a_{n-1} (\frac{p}{q})^{n-1} + \dotsb + a_1 (\frac{p}{q}) + a_0 \\
0 &= p^n + a_{n-1}qp^{n-1} + \dotsb + a_1q^{n-1}p + a_0q^n && \text{两边乘以}q^n \\
-p^n &= a_{n-1}qp^{n-1} + \dotsb + a_1q^{n-1}p + a_0q^n && \text{移项}
\end{align*}

$q$整除右侧，因此$q$整除$p^n$。但$p, q$互素，所以$q$不整除$p$，矛盾。
\end{proof}
}

\Question{证明范数是可乘的。

\begin{proof}
利用共轭复数
\begin{align*}
N(\alpha\beta) &= (\alpha\beta)\overline{\alpha\beta} = (\alpha\overline{\alpha})(\beta\overline{\beta}) = N(\alpha)N(\beta) && \qedhere
\end{align*}
\end{proof}
}

\Question{说明二次整数的范数是对应二次方程的常数项。

\begin{proof}
本题可以直接用达朗贝尔定理（见\cref{qn:conjugated-root}）和韦达定理证明复数二次整数的情形。这里给出的证明可以覆盖实二次整数。先证明若$x_1 = a + b\sqrt{m}$是首一二次方程$x^2 + px + q = 0$的解，则$x_2 = a - b\sqrt{m}$也是解，其中$m$可以大于也可以小于0，不含有任何完全平方因子。

\begin{align*}
0 &= (a + b\sqrt{m})^2 + p(a + b\sqrt{m}) + q \\
  &= a^2 + mb^2 + 2ab\sqrt{m} + pa + pb\sqrt{m} + q \\
  &= a^2 + mb^2 + pa + q + b(2a + p)\sqrt{m}  && (*)
\end{align*}

因$m \ne 0$且不含完全平方因子，所以有$b(2a + p) = 0$，取相反数得$-b(2a + p) = 0$。将$-b$带入(*)有：

\begin{align*}
a^2 + m(-b)^2 + pa + q - b(2a + p)\sqrt{m} &= 0  \\
(a - b\sqrt{m})^2 + p(a - b\sqrt{m}) + q &= 0
\end{align*}

因此$x_{1, 2} = a \pm b\sqrt{m}$是方程的两个解。根据韦达定理有：

\begin{align*}
q = x_1x_2 = (a + b\sqrt{m})(a - b\sqrt{m}) = a^2 - mb^2
\end{align*}

当$m < 0$时，$a^2 + |m|b^2$就是复数二次整数的范数；当$m > 0$时，$a^2 - mb^2$是实二次整数的范数。
\end{proof}
}

\Question{如果$a, b$互素，证明共轭的二次整数$a \pm bi\sqrt{m}$互素。

\begin{proof}
令$d$整除复数$z = a + bi\sqrt{m}$和其共轭，则$d$整除$z \pm \overline{z}$，即$d$整除$2a$并且$d$整除$2bi\sqrt{m}$。但$d$不可能是2，否则$a, b$都是偶数。因此$d$整除$a$和$b$，但$a, b$互素，所以$d$只能是1。这就证明了$z$和其共轭互素。
\end{proof}
}

\Question{从范数的共轭定义说明爱森斯坦整数的范数为$a^2 - ab + b^2$。

\vspace{2mm}
令$z = a + b\omega$，由范数定义：

\begin{align*}
N(z) &= z\overline{z} = (a + b\omega)\overline{a + b\omega} \\
  &= (a + b(-\frac{1}{2} + i\frac{\sqrt{3}}{2}))(a + b(-\frac{1}{2} - i\frac{\sqrt{3}}{2})) \\
  &= (a - \frac{b}{2})^2 + (b\frac{\sqrt{3}}{2})^2 \\
  &= a^2 + \frac{b^2}{4} - ab + \frac{3b^2}{4} = a^2 -ab + b^2
\end{align*}
}

\Question{证明爱森斯坦整数的范数非负。

\begin{proof}
\begin{align*}
a^2 - ab + b^2 &= a^2 -ab + \frac{b^2}{4} + \frac{3b^2}{4} = (a - \frac{b}{2})^2 + \frac{3b^2}{4} \geq 0 && \qedhere
\end{align*}
\end{proof}
}

\Question{爱森斯坦整数中的单位元是什么？

\vspace{2mm}
注意到$\omega$的范数$N(\omega) = (-\dfrac{1}{2})^2 + (\dfrac{\sqrt{3}}{2})^2 = 1$，所以其共轭$\overline{\omega}$的范数也是1。此外$\pm 1$是单位元，因此$\pm \omega, \pm \overline{\omega}$也是单位元。这样爱森斯坦整数共有6个单位元：$\pm 1, \pm \frac{1}{2} \pm i\frac{\sqrt{3}}{2}$。它们是分圆方程$x^6 = 1$的6个根$1 = e^0, e^{i\frac{\pi}{3}}, \dotsc, e^{i\frac{5\pi}{3}}$，如\cref{fig:units-of-z-omega}所示。

\begin{center}
  \begin{tikzpicture}[
      scale=2.0,
      axis_style/.style={draw, gray!60, thick},
      unit_circle_style/.style={draw, black, thick, dashed},
      hexagon_style/.style={draw, black, thick}
  ]

  \def\omega{1.732/2} % sqrt(3)/2, workaround the issue with sqrt() function
  \draw[axis_style, ->] (-1.5, 0) -- (1.5, 0) node[below right, font=\small] {$\text{Re}(z)$};
  \draw[axis_style, ->] (0, -1.5) -- (0, 1.5) node[above left, font=\small] {$\text{Im}(z)$};
  \draw[unit_circle_style] (0,0) circle (1);

  \draw[hexagon_style]
      (1, 0) node[right] {$1$} --
      (0.5, \omega) node[above right] {$\frac{1}{2} + i\frac{\sqrt{3}}{2}$} --
      (-0.5, \omega) node[above left] {$-\frac{1}{2} + i\frac{\sqrt{3}}{2}$} --
      (-1, 0) node[left] {$-1$} --
      (-0.5, -\omega) node[below left] {$-\frac{1}{2} - i\frac{\sqrt{3}}{2}$} --
      (0.5, -\omega) node[below right] {$\frac{1}{2} - i\frac{\sqrt{3}}{2}$} -- cycle;

  \draw[unit_circle_style] (-0.5, -\omega) -- (0.5, \omega);
  \draw[unit_circle_style] (0.5, -\omega) -- (-0.5, \omega);
  \end{tikzpicture}
  \captionof{figure}{爱森斯坦整数的单位元}
  \label{fig:units-of-z-omega}
\end{center}
}

\Question{试画出爱森斯坦整数$\rho \beta$的格点。

\vspace{2mm}
上题中的单位元可以张成爱森斯坦整数的网格。如\cref{fig:integers-of-z-omega}所示，爱森斯坦整数分布在灰色的正三角形网格上。令$\rho = m + n\omega$，其中$m, n$为整数。$\rho \beta = m\beta + n\omega\beta$。由欧拉定理$\omega = e^{i\frac{2\pi}{3}}$，乘以$\omega$相当于向左旋转120度。因此$\rho \beta$是由$\beta$和其旋转120度后的向量张成的正三角形网格。

\begin{center}
  \includegraphics[scale=0.2]{img/z-omega1}
  \captionof{figure}{爱森斯坦整数为灰色正三角形网格，$\rho \beta$为相似的黑色正三角形网格。}
  \label{fig:integers-of-z-omega}
\end{center}
}

\Question{根据爱森斯坦整数的格点，证明欧几里得算法存在。

\begin{center}
  \begin{tikzpicture}[
      scale=2.0,
      triangle_style/.style={draw, black, thick},       % 内接正三角形样式
      reuleaux_style/.style={draw, blue, thick},        % 莱洛三角形样式
      vertex_style/.style={fill, red, circle, inner sep=2pt}, % 顶点样式
      label_style/.style={font=\small, fill=white, inner sep=1pt} % 标签样式
  ]

      \def\A{(1,0)}
      \def\B{(-0.5,{1.732/2})}
      \def\C{(-0.5,{-1.732/2})}

      \draw[triangle_style] \A -- \B -- \C -- cycle;
      \draw[reuleaux_style] \A arc[start angle=30, end angle=90, radius=1.732];
      \draw[reuleaux_style] \B arc[start angle=150, end angle=210, radius=1.732];
      \draw[reuleaux_style] \C arc[start angle=-90, end angle=-30, radius=1.732];
      \fill[vertex_style] \A node[label_style, right] {A};
      \fill[vertex_style] \B node[label_style, above] {B};
      \fill[vertex_style] \C node[label_style, below] {C};
  \end{tikzpicture}

  \captionof{figure}{莱洛三角形及其内接正三角形}
  \label{fig:reuleaux}
\end{center}

\begin{proof}
存在一个简单直观的几何证法。如\cref{fig:reuleaux}所示，以正三角形每个顶点为圆心，边为半径作弧。三条弧围成的图形叫做莱洛三角形。莱洛三角形内任一点到最近顶点的距离都小于边长。任意爱森斯坦整数$\alpha$落在边长为$|\beta|$的正三角形网格内。距离最近的顶点的距离小于边长$|\beta|$。令$\gamma = \alpha - \rho \beta$，有$N(\gamma) < N(\beta)$。故欧几里得算法存在。
\end{proof}
}

\Question{证明$1 \pm i\sqrt{5}$是不可分解的。

\begin{proof}
假设它可以分解为$(a + bi\sqrt{5})(c + di\sqrt{5})$，两边取范数：

\[
6 = 1^2 + 5^2 = N(1 \pm i\sqrt{5}) = N(a + bi\sqrt{5})N(c + di\sqrt{5}) = (a^2 + 5b^2)(c^2 + 5d^2）
\]

可以排除掉$a^2 + 5b^2 = 2, c^2 + 5d^2 = 3$的情况，此时$a, b, c, d$没有整数解。只能是$a^2 + 5b^2 = 1$或$c^2 + 5d^2 = 1$。范数为1对应单位元，另一个是相伴元。因此$1 \pm i\sqrt{5}$不可分解。
\end{proof}
}

\Question{证明理想的和仍是理想。

\begin{proof}
令$I = I_1 + I_2 = \{a + b | a \in I_1, b \in I_2\}$，我们要证明$I$满足加法封闭性和缩放封闭性。任意$I$中的$c_1 = a_1 + b_1, c_2 = a_2 + b_2$，其中$a_1, a_2 \in I_1, b_1, b_2 \in I_2$。因$I_1$是理想，故$a_1 + a_2$在$I_1$中，令$a_3 = a_1 + a_2 \in I_1$。同理$b_1 + b_2$在$I_2$中，令$b_3 = b_1 + b_2 \in I_2$。

\begin{align*}
c_1 + c_2 &= a_1 + b_1 + a_2 + b_2 = (a_1 + a_2) + (b_1 + b_2) \\
  &= a_3 + b_3 \in I && \text{其中} a_3 \in I_1, b_3 \in I_2
\end{align*}

满足加法封闭性。对任意父集合$R$中的$r$，任意$I$中的$c = a + b$，其中$a \in I_1, b \in I_2$，由理想性质$ar \in I_1, br \in I_2$，因此:

\begin{align*}
cr &= (a + b)r = ar + br \in I  && \text{其中} ar \in I_1, br \in I_2
\end{align*}
满足缩放封闭性。
\end{proof}
}

\Question{理想的父集合$R$中包含0和1，并且任何元素$y$的相反数$-y$也在$R$中。证明 (1) 任何理想中都包含0；(2) 如果$a$在理想中，则$-a$也在理想中。

\begin{proof}
任选$a \in I, 0 \in R$，根据理想的定义$a \cdot 0 = 0 \in I$。所以任何理想都包含0。进一步$a \in I$, 因为1在$R$中，所以$-1$也在$R$中。据理想定义$a \cdot (-1) = -a \in I$。
\end{proof}
}

\Question{(0)叫做零理想，(1)叫做单位理想。它们各自包含了什么元素？

\vspace{2mm}
(0)只包含一个元素0，因为0的任何倍都是0。(1)等于父集合$R$，任何$y \in R$，$1y = y \in (1)$。
}

\Question{验证如果理想$A$由$(a, b)$产生，理想$B$由$(c, d)$产生，则$AB = (ac, ad, bc, bd)$。

\vspace{2mm}
$A = \{\alpha = ar_1 + br_2\}, B = \{\beta = cs_1 + ds_2\}$，其中$r_1, r_2, s_1, s_2$是父集合$R$中的元素。戴德金对理想积的定义可以概括为有限的$\alpha\beta$的和。

\begin{align*}
AB &= \{ \sum \alpha\beta \} = \{ \sum (ar_1 + br_2)(cs_1 + ds_2) \} \\
  &= \{ \sum (acr_1s_1 + adr_1s_2 + bcr_2s_1 + bdr_2s_2) \} \\
  &= \{ ac\sum (r_1s_1) + ad\sum (r_1s_2) + bc\sum (r_2s_1) + bd\sum (r_2s_2) \} \\
  &= \{ ac S_1 + ad S_2 + bc S_3 + bd S_4 \} && \text{其中}S_i = \sum (r_js_k) \\
  &= (ac, ad, bc, bd)
\end{align*}
}

%% 下面的问题本质是因为Z[\sqrt{-3}]不是Dedekind domain。所以不存在理想的唯一分解。参考：
%% https://math.stackexchange.com/questions/958030/ideals-dedekind-domain-and-mathbbz-sqrt-3
%%
%% \Question{*无法用理想解决$4 = 2 \times 2 = (1 + i\sqrt{3})(1 - i\sqrt{3})$的唯一分解。

%% \vspace{2mm}
%% 构造理想$I = (2, 1 + i\sqrt{3})$。首先$I \ne (2)$, 因为$I$中的$1 + i\sqrt{-3} \notin (2)$。但是：

%% \begin{align*}
%% A = I^2 &= (4, 2 + 2i\sqrt{3}, (1 + i\sqrt{3})^2) \\
%%         &= (4, 2 + 2i\sqrt{3}, -2 + 2i\sqrt{3}) && \text{其中} (1 + i\sqrt{3})^2 = -2 + 2i\sqrt{3}
%%         &= (2)(2, 1 + i\sqrt{-3}) = (a)I
%% \end{align*}

%% 这说明$A = I^2 = (2)I$有两种分解：(1) 素理想I^2；(2) 非素理想(2)和素理想I的积。
%% }

\Question{我们用\cref{fig:NNtoN}建立了房间和任意旅游团的客人间的一一映射。第$i$号旅游团的第$j$号客人应该入住几号房间？第$k$个房间里住了哪号旅游团的哪位客人？

\vspace{2mm}
我们约定从0开始计数。用数偶$(i, j)$表示第$i$号旅游图的第$j$号客人。我们列出前面的几个客人和房间的对应关系

\vspace{3mm}
\begin{adjustbox}{max width=\linewidth}
\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c}
$(i, j)$ & (0, 0) & (0, 1) & (1, 0) & (2, 0) & (1, 1) & (0, 2) & (0, 3) & (1, 2) & (2, 1) & (3, 0) & ... \\
\hline
$k$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & ... \\
\hline
$i + j$ & 0 & 1 & 1 & 2 & 2 & 2 & 3 & 3 & 3 & 3 & ... \\
\end{tabular}
\end{adjustbox}
\vspace{3mm}

如果同时写下$i+j$的值，我们发现规律是很明显的。共有1个0，2个1，3个2，4个3……这些恰恰是毕达哥拉斯发现的三角形数。记$m = i + j$，对于图中任意格点，它表明在这个点的左下方所有斜线上格点的数目为：$\dfrac{m(m + 1)}{2}$。

在这个点所在的斜线上，如果$m$是奇数则向左上前进，$i$增加、$j$减小；如果是偶数则向右下前进。综合起来，我们得到结果：

\[
k = \dfrac{m(m + 1)}{2} + \begin{cases} m - j: \text{$m$是奇数} \\
j: \text{$m$是偶数} \\
\end{cases}
\]

进一步，我们可以通过$(-1)^m$来简化这个结果：

\[
k = \dfrac{m(m + 2) + (-1)^m (2j - m)}{2}
\]
}

\Question{希尔伯特旅馆第三天的故事的解法并不唯一，\cref{fig:PWW-NNtoN}是《无需语言的证明》一书的封面。试根据此图给出另一种编号方案？
\begin{center}
 \includegraphics[scale=0.18]{img/PWW}
 \captionof{figure}{《无需语言的证明》封面局部}
\end{center}

\begin{center}
\begin{tikzpicture}
  \draw[step=1, very thin, gray] (0, 0) grid (5, 5);
  \draw[->] (-0.25, 0) -- (6, 0) coordinate (x axis);
  \draw[->] (0, -0.25) -- (0, 6) coordinate (y axis);
  \foreach \x in {0, 1, 2, 3, 4, 5}
    \path (\x, -0.25) node[left] {\x};
  \foreach \y in {1, 2, 3, 4, 5}
    \path (-0.25, \y) node[below] {\y};
  \foreach \i / \x / \y in {0/0/0, 1/1/0, 2/1/1, 3/0/1, 4/0/2, 5/1/2, 6/2/2, 7/2/1, 8/2/0, 9/3/0, 10/3/1}{
    \path (\x, \y) coordinate (N\i);
    \fill (N\i) circle (1pt) node[above right=3pt of N\i] {\i};
  }
  \foreach \i in {0,...,9} {
    \pgfmathsetmacro{\j}{\i+1}
    \draw[-latex, thick] (N\i) to (N\j);
  }
\end{tikzpicture}
\captionof{figure}{对无穷个无穷的另一种编号方案}
\label{fig:NNtoN2}
\end{center}

如\cref{fig:NNtoN2}所示，每次沿着折尺形前进，每个折尺上有奇数个点。
}
\end{Answer}

\ifx\wholebook\relax \else
\section{参考答案}
\shipoutAnswer

\subimport{inc/}{fibonacci-zh-cn}
\subimport{inc/}{wilson-zh-cn}

\begin{thebibliography}{99}
\subimport{inc/}{bib-zh-cn}
\end{thebibliography}

\expandafter\enddocument
\fi
